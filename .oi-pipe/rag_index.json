{
  "chunks": [
    {
      "source": "JOURNEY.md",
      "heading": "Source of Truth",
      "content": "## Source of Truth\n\n- **Thesis**: [thesis.md](thesis.md) - The 5 core theses and vision\n- **Slices**: [slices/README.md](slices/README.md) - Implementation roadmap\n- **Technical**: [PROJECT.md](PROJECT.md) - Current architecture and code structure\n\nRead those first. This doc tracks **implementation progress and pivots**.\n\n---"
    },
    {
      "source": "JOURNEY.md",
      "heading": "Current Status: Slice 1a (Partial)",
      "content": "## Current Status: Slice 1a (Partial)\n\nWe're implementing [Slice 1a: Minimal Conclusion Tracking](slices/slice-1a-minimal.md)."
    },
    {
      "source": "JOURNEY.md",
      "heading": "What's Built",
      "content": "### What's Built\n\n| Component | Status | Notes |\n|-----------|--------|-------|\n| Raw chatlog | \u2705 Done | Append-only JSONL, permanent archive |\n| Artifact model | \u2705 Done | effort/fact/event with status/resolution |\n| Agentic interpretation | \u2705 Done | LLM decides what artifacts to create |\n| Configurable schemas | \u2705 Done | YAML-based, user can override |\n| External prompts | \u2705 Done | Markdown files, editable |\n| Context building | \u26a0\ufe0f Partial | Loads ALL artifacts + last 5 raw exchanges |"
    },
    {
      "source": "JOURNEY.md",
      "heading": "What's Missing (to complete 1a)",
      "content": "### What's Missing (to complete 1a)\n\n- **Relevance-based retrieval** - Currently loads all artifacts, should load only relevant\n- **Remove \"last 5 exchanges\" crutch** - Artifacts should carry continuity, not raw chat\n- **Mark exchanges as processed** - So they don't load into context\n\n---"
    },
    {
      "source": "JOURNEY.md",
      "heading": "Pivot 1: Effort\u2192Conclusion to Flexible Artifacts",
      "content": "### Pivot 1: Effort\u2192Conclusion to Flexible Artifacts\n\n**Original**: Thread model with effort\u2192conclusion pairs, triggered by explicit conclusions.\n\n**Pivot**: Single `Artifact` type with dynamic `artifact_type` field. Types: effort (with status/resolution), fact, event. More flexible, captures more patterns.\n\n**Why**: Not everything is an effort\u2192conclusion. Facts (\"What's the capital of France?\") and events (\"I'm tired\") don't fit the effort model."
    },
    {
      "source": "JOURNEY.md",
      "heading": "Pivot 2: Static Context File to Dynamic Assembly",
      "content": "### Pivot 2: Static Context File to Dynamic Assembly\n\n**Original mental model**: A hybrid file with compressed artifacts + unprocessed raw chat.\n\n**Pivot**: Keep raw chatlog and artifacts separate, dynamically assemble context JIT based on the query.\n\n**Why**: Cleaner architecture. Different queries need different context. Scales better.\n\n---"
    },
    {
      "source": "JOURNEY.md",
      "heading": "Architectural Insight: Context Builder as Core",
      "content": "## Architectural Insight: Context Builder as Core\n\nThe context builder is the heart of the system:\n\n```\nUser query \u2192 Context Builder \u2192 Assembled context \u2192 LLM \u2192 Response \u2192 Interpreter \u2192 Artifact\n                   \u2191\n         Retrieval (programmatic) + Selection (agentic)\n```\n\nEverything should be a user-extensible primitive:\n- `~/.oi/schemas/*.yaml` - artifact types \u2705\n- `~/.oi/prompts/*.md` - prompts\n- `~/.oi/tools/*.py` - custom retrieval/assembly (future)\n\n---"
    },
    {
      "source": "JOURNEY.md",
      "heading": "For Agents",
      "content": "## For Agents\n\n1. **Read [thesis.md](thesis.md)** - understand the vision\n2. **Read [slices/README.md](slices/README.md)** - see the roadmap\n3. **Read [PROJECT.md](PROJECT.md)** - current technical state\n4. **Current work**: Completing Slice 1a - relevance-based retrieval, removing raw chat crutch\n5. **Key gap**: Context builder loads everything, should load only relevant artifacts\n\n---"
    },
    {
      "source": "JOURNEY.md",
      "heading": "Open Decisions",
      "content": "## Open Decisions\n\n- How to determine artifact relevance? (embeddings? keywords? recency? LLM selection?)\n- When to fall back to raw chatlog for detail?\n- How to handle multi-session efforts? (user returns days later)"
    },
    {
      "source": "pipeline.md",
      "heading": "The Pipeline",
      "content": "## The Pipeline\n\n```\nThesis \u2192 Slice Spec \u2192 Scenario \u2192 User Stories \u2192 Implementation\n```\n\n| Stage | What It Is | Who/What Creates It |\n|-------|------------|---------------------|\n| **Thesis** | Overall vision, the \"why\" | Human brainstorming |\n| **Slice Spec** | Scope, features, architecture for one slice | Human + Claude |\n| **Scenario** | Narrative walkthrough of user experience | scenario-agent |\n| **User Stories** | Testable pieces with acceptance criteria | story-agent |\n| **Implementation** | Code | dev work |\n\n---"
    },
    {
      "source": "pipeline.md",
      "heading": "Why This Order",
      "content": "## Why This Order\n\n1. **Thesis** grounds everything in the vision\n2. **Slice Spec** carves off a minimal, buildable piece\n3. **Scenario** locks in the experience before fragmenting it\n4. **User Stories** break the scenario into testable pieces\n5. **Implementation** builds what the stories describe\n\nWithout the scenario step, stories become fragmented and leak implementation details. The scenario absorbs the \"context\" so stories stay clean.\n\n---"
    },
    {
      "source": "pipeline.md",
      "heading": "Agents",
      "content": "## Agents\n\n| Agent | Input | Output |\n|-------|-------|--------|\n| **scenario-agent** | thesis + slice spec | `docs/scenarios/{slice}.md` |\n| **story-agent** | thesis + slice + scenario | `docs/stories/{slice}.md` |\n\n---"
    },
    {
      "source": "pipeline.md",
      "heading": "File Naming Convention",
      "content": "## File Naming Convention\n\n**Rule: Include the step name in the filename to avoid confusion.**\n\nFiles for the same slice exist in different folders. Without step names in filenames,\nthey all look identical and cause confusion.\n\n| Step | Naming Pattern | Example |\n|------|----------------|---------|\n| Slice Spec | `{slice-id}.md` | `1a-minimal.md` |\n| Scenario | `{slice-id}-scenario.md` | `1a-minimal-scenario.md` |\n| Stories | `{slice-id}-stories.md` | `1a-minimal-stories.md` |"
    },
    {
      "source": "pipeline.md",
      "heading": "Document Locations",
      "content": "## Document Locations\n\n```\ndocs/\n\u251c\u2500\u2500 thesis.md              # Overall vision\n\u251c\u2500\u2500 tech-stack.md          # Technology decisions\n\u251c\u2500\u2500 pipeline.md            # This document\n\u251c\u2500\u2500 slices/\n\u2502   \u251c\u2500\u2500 README.md          # Slice overview\n\u2502   \u251c\u2500\u2500 1a-minimal.md      # Slice spec\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 scenarios/\n\u2502   \u2514\u2500\u2500 1a-minimal-scenario.md   # Narrative walkthrough\n\u251c\u2500\u2500 stories/\n\u2502   \u251c\u2500\u2500 INDEX.md           # Story index\n\u2502   \u2514\u2500\u2500 1a-minimal-stories.md    # User stories\n\u2514\u2500\u2500 decisions/\n    \u2514\u2500\u2500 001-*.md           # Architecture decisions\n```\n\n---"
    },
    {
      "source": "pipeline.md",
      "heading": "Adding a New Slice",
      "content": "## Adding a New Slice\n\n1. **Write the slice spec** in `docs/slices/{N}-{name}.md`\n2. **Run scenario-agent** \u2192 generates `docs/scenarios/{N}-{name}-scenario.md`\n3. **Run story-agent** \u2192 generates `docs/stories/{N}-{name}-stories.md`\n4. **Review and refine** all artifacts\n5. **Implement** based on stories"
    },
    {
      "source": "PROJECT.md",
      "heading": "Related Docs",
      "content": "## Related Docs\n\n- **Vision**: [thesis.md](thesis.md) - The 5 theses driving this project\n- **Roadmap**: [slices/README.md](slices/README.md) - Implementation phases\n- **Progress**: [JOURNEY.md](JOURNEY.md) - Where we are, pivots made\n\n---"
    },
    {
      "source": "PROJECT.md",
      "heading": "Data Model",
      "content": "## Data Model\n\n```\nArtifact\n\u251c\u2500\u2500 artifact_type: str     # Dynamic - loaded from schemas/artifact_types.yaml\n\u251c\u2500\u2500 summary: str           # What this is about\n\u251c\u2500\u2500 status: \"open\" | \"resolved\" (for types with has_status)\n\u251c\u2500\u2500 resolution: str        # What was decided (for resolved items)\n\u251c\u2500\u2500 tags: list[str]        # For searchability\n\u251c\u2500\u2500 expires: bool          # From schema - whether this type can expire\n\u2514\u2500\u2500 ref_count: int         # For future: expiration based on references\n```"
    },
    {
      "source": "PROJECT.md",
      "heading": "Configurable Schemas",
      "content": "## Configurable Schemas\n\nArtifact types defined in YAML (user can override):\n\n```yaml\n# src/oi/schemas/artifact_types.yaml (defaults)\n# ~/.oi/schemas/artifact_types.yaml (user overrides)\ntypes:\n  effort:\n    description: \"Goal-oriented work\"\n    has_status: true\n    has_resolution: true\n    expires: false\n  fact:\n    description: \"Simple Q&A, specific knowledge\"\n    expires: true\n  event:\n    description: \"Casual exchange, context\"\n    expires: true\n```"
    },
    {
      "source": "PROJECT.md",
      "heading": "Flow",
      "content": "## Flow\n\n```\nUser message\n    \u2193\nbuild_context()  \u2192  [system prompt + artifacts + last 5 exchanges]\n    \u2193\nLLM responds\n    \u2193\nappend_exchange()  \u2192  chatlog.jsonl (permanent raw archive)\n    \u2193\ninterpret_exchange()  \u2192  LLM decides: create artifact? what type?\n    \u2193\nstate.json  \u2192  artifacts only (compressed knowledge)\n```"
    },
    {
      "source": "PROJECT.md",
      "heading": "Key Files",
      "content": "## Key Files\n\n```\nsrc/oi/\n\u251c\u2500\u2500 models.py        # Artifact, ConversationState\n\u251c\u2500\u2500 conversation.py  # build_context(), process_turn()\n\u251c\u2500\u2500 interpret.py     # Agentic interpretation (LLM decides artifacts)\n\u251c\u2500\u2500 chatlog.py       # Raw chat log (append-only JSONL)\n\u251c\u2500\u2500 storage.py       # JSON persistence\n\u251c\u2500\u2500 cli.py           # Command-line interface\n\u251c\u2500\u2500 llm.py           # LiteLLM wrapper\n\u251c\u2500\u2500 prompts/\n\u2502   \u251c\u2500\u2500 system.md    # Main AI system prompt\n\u2502   \u2514\u2500\u2500 interpret.md # Artifact interpretation rules\n\u2514\u2500\u2500 schemas/\n    \u251c\u2500\u2500 __init__.py        # Schema loader utilities\n    \u2514\u2500\u2500 artifact_types.yaml # Default type definitions\n```"
    },
    {
      "source": "PROJECT.md",
      "heading": "Storage",
      "content": "## Storage\n\n```\n~/.oi/\n\u251c\u2500\u2500 state.json      # Artifacts (compressed knowledge)\n\u2514\u2500\u2500 chatlog.jsonl   # Raw exchanges (permanent archive)\n```"
    },
    {
      "source": "PROJECT.md",
      "heading": "Key Decisions",
      "content": "## Key Decisions\n\nSee `docs/decisions/` for detailed records.\n\n| Decision | Outcome |\n|----------|---------|\n| 007-sqlite-storage.md | REVERTED - premature optimization |\n| Data model | Artifact-only (not Thread/Conclusion split) |\n| Prompts | External markdown files |\n| Schemas | Configurable YAML, user can override |"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Artifacts Created",
      "content": "## Artifacts Created\n\n| File | Type | One-liner |\n|------|------|-----------|\n| [effort-scoped-context.md](brainstorm/effort-scoped-context.md) | Brainstorm | **Core model**: lazy compaction, effort weight, focus constraint, escalation |\n| [director-agent-scenario.md](scenarios/director-agent-scenario.md) | Scenario | Director model: 24/7 orchestrator spawning workers |\n| [peer-agent-scenario.md](scenarios/peer-agent-scenario.md) | Scenario | **Peer model**: stateless agents, kanban as coordinator |\n| [agent-communication.md](brainstorm/agent-communication.md) | Brainstorm | Disputes, escalation, stateless coordination |\n| [human-context-management.md](brainstorm/human-context-management.md) | Brainstorm | Human needs artifact dashboard, visual mapping |\n| [context-and-cognition.md](brainstorm/context-and-cognition.md) | Brainstorm | Two-log model, context strategies, human cognitive needs, continuous capture |\n| [008-dev-first-pivot.md](decisions/008-dev-first-pivot.md) | Decision | **Pivot**: Generic AI \u2192 Dev-first roadmap |\n| [TODO.md](TODO.md) | Tracking | 10 open design threads with links |\n| SESSION-MAP.md | Meta | This file - session overview |"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Artifacts Updated",
      "content": "## Artifacts Updated\n\n| File | Type | Changes |\n|------|------|---------|\n| [tech-stack.md](tech-stack.md) | Decision | Full rewrite: philosophy, layers, hackable primitives, applications |\n| [thesis.md](thesis.md) | Vision | Added \"Primitives and Applications\" framing section |\n\n---"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Architecture",
      "content": "### Architecture\n1. **Python** for CLI/tools - hackable, AI ecosystem native\n2. **Anti-monolith** - small composable pieces, everything is files\n3. **Hackable primitives** - users modify tools, instructions, schemas directly\n4. **Primitives vs Applications** - primitives are the product, applications are configurations"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Context Model",
      "content": "### Context Model\n5. **Lazy compaction** - stay large as long as possible, compact at meaningful boundaries\n6. **Effort weight** - quality/cost dial (high=max context, low=cheap)\n7. **Focus constraint tied to weight** - high=locked, low=flexible\n8. **One chat = one effort** - constraint as feature, not limitation"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Agent Coordination",
      "content": "### Agent Coordination\n9. **Peer model over director** - stateless agents, kanban as coordinator\n10. **Disputes via comments** - artifact comments + kanban backflow\n11. **Stateless escalation** - failure_count in item metadata + model ladder\n12. **No process dependencies** - agent dies after each attempt, item persists"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Cost Management",
      "content": "### Cost Management\n13. **Model escalation** - start free/cheap, escalate after 2 failures\n14. **Effort weight influences starting tier** - critical starts at Sonnet/Opus\n15. **Configurable model ladder** - per-agent-type escalation rules"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Human Interface",
      "content": "### Human Interface\n16. **Human has context limit too** - needs dashboard, artifact inventory\n17. **Visual mapping** - graphs, trees, timelines built on primitives (future)"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Context & Storage",
      "content": "### Context & Storage\n18. **Two-log model** - raw log (verbatim) + summary log (manifest with artifact refs)\n19. **Chats compact to artifact refs** - artifacts are primary, chats are process\n20. **Context strategies** - chat-only, RAG-only, or hybrid based on use case\n21. **Effort weight controls context budget** - one dial for budget, compaction, focus, model"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Human Cognition",
      "content": "### Human Cognition\n22. **Conclusion as cognitive relief** - closed loops release mental resources\n23. **Temporal grounding** - always show past/present/future state\n24. **Progress visibility** - artifacts are progress bar for knowledge work\n25. **Continuous capture** - summarize every response, don't wait for end-of-session\n\n---"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Mental Model",
      "content": "## Mental Model\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                    EFFORT-SCOPED CONTEXT                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502  EFFORT WEIGHT \u2500\u2500\u25ba CONTEXT BUDGET \u2500\u2500\u25ba COMPACTION THRESHOLD  \u2502\n\u2502       \u2502                                                     \u2502\n\u2502       \u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba FOCUS CONSTRAINT (locked/flexible)       \u2502\n\u2502       \u2502                                                     \u2502\n\u2502       \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba MODEL TIER (free/standard/expensive)     \u2502\n\u2502                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502  PEER AGENT MODEL                                           \u2502\n\u2502  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500                                          \u2502\n\u2502                                                             \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502  \u2502  story  \u2502\u2500\u2500\u2500\u25ba\u2502  arch   \u2502\u2500\u2500\u2500\u25ba\u2502  dev    \u2502\u2500\u2500\u2500\u25ba ...         \u2502\n\u2502  \u2502  agent  \u2502    \u2502  agent  \u2502    \u2502  agent  \u2502                 \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502       \u2502              \u2502              \u2502                       \u2502\n\u2502       \u25bc              \u25bc              \u25bc                       \u2502\n\u2502   watches        watches        watches                     \u2502\n\u2502   column         column         column                      \u2502\n\u2502                                                             \u2502\n\u2502  \u2022 Stateless agents (die after each effort)                \u2502\n\u2502  \u2022 Kanban is the coordinator                                \u2502\n\u2502  \u2022 Artifacts are the only communication                     \u2502\n\u2502  \u2022 failure_count in item \u2192 model selection                  \u2502\n\u2502                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502  HACKABLE LOCATIONS (~/.oi/)                                \u2502\n\u2502                                                             \u2502\n\u2502  instructions/*.md    \u2500\u2500\u2500 just edit text                    \u2502\n\u2502  tools/*.py           \u2500\u2500\u2500 drop in functions                 \u2502\n\u2502  schemas/*.py         \u2500\u2500\u2500 Pydantic models                   \u2502\n\u2502  config.yaml          \u2500\u2500\u2500 settings                          \u2502\n\u2502  applications/        \u2500\u2500\u2500 domain configurations             \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n---"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Open Threads (from TODO.md)",
      "content": "## Open Threads (from TODO.md)\n\n| # | Thread | Status | Priority |\n|---|--------|--------|----------|\n| 1 | Child efforts design | Open | High |\n| 2 | Chat log format | Open | High |\n| 3 | Slice 1 redesign | Open | High |\n| 4 | Fork mechanics | Open | Medium |\n| 5 | Vector filtering | Open | Medium |\n| 6 | AI chat retrieval | Open | Medium |\n| 7 | Agents revisited | Open | Lower |\n| 8 | Effort weight inference | Partial | Lower |\n| 9 | Human context dashboard | Open | Medium |\n| 10 | Model escalation | Captured | Lower |\n\n---"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Slice Progression (Proposed)",
      "content": "## Slice Progression (Proposed)\n\n| Slice | Focus | Builds Toward |\n|-------|-------|---------------|\n| **1** | Single effort lifecycle | Worker agents |\n| **2** | Effort weight | Cost control |\n| **3** | Focus constraint + topic detection | Clean boundaries |\n| **4** | Context building with artifacts | Director context |\n| **5** | Child efforts | Sub-task orchestration |\n| **6** | RAG retrieval | On-demand details |\n| **7** | Spawn/return pattern | Worker model |\n| **8** | Director orchestration | Full scenario |\n\n---"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Tech Stack Summary",
      "content": "## Tech Stack Summary\n\n```\nPython 3.11+ (core)\n\u251c\u2500\u2500 litellm      (LLM calls, any provider)\n\u251c\u2500\u2500 typer        (CLI)\n\u251c\u2500\u2500 pydantic     (schemas)\n\u251c\u2500\u2500 chromadb     (vectors)\n\u251c\u2500\u2500 sentence-transformers (embeddings)\n\u2514\u2500\u2500 rich         (terminal UI)\n\nFuture: TypeScript/React (dashboard), Rust (hot paths)\n```\n\n---"
    },
    {
      "source": "SESSION-MAP.md",
      "heading": "Related Docs",
      "content": "## Related Docs\n\n| Doc | Relevance |\n|-----|-----------|\n| [refined-chat-model.md](brainstorm/refined-chat-model.md) | Earlier chat model thinking |\n| [thesis.md](thesis.md) | Original vision (5 theses) |\n| [1a-minimal.md](slices/1a-minimal.md) | Slice 1 spec (needs revision) |\n| [pipeline.md](pipeline.md) | TDD pipeline structure |\n| [PROJECT.md](PROJECT.md) | Technical architecture |"
    },
    {
      "source": "tech-stack.md",
      "heading": "Philosophy",
      "content": "## Philosophy\n\n**Anti-monolith**: Small, composable pieces over large frameworks.\n\n**Open source**: Community accessible, forkable, modifiable.\n\n**Hackable primitives**: Users can modify tools, instructions, schemas without rebuilding.\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Decision",
      "content": "## Decision\n\n**Language**: Python 3.11+\n\n**Rationale**:\n- Lowest barrier to modify (most devs can hack Python)\n- AI ecosystem native (transformers, embeddings, RAG all Python-first)\n- Pydantic schemas are readable/editable\n- Fast iteration for prototyping\n- Can optimize hot paths later if needed\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Architecture Layers",
      "content": "## Architecture Layers\n\n```\nLAYER           IMPLEMENTATION      HACKABLE?\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nInstructions    Markdown files      \u2713 Just edit text\nSchemas         Pydantic models     \u2713 Readable Python\nTools           Python functions    \u2713 Drop in new tools\nCLI             Python (typer)      \u2713 Extend commands\nEmbeddings      sentence-transform  \u2713 Swap models\nStorage         SQLite + JSON       \u2713 Inspectable\nConfig          YAML                \u2713 Edit settings\n```\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Dependencies",
      "content": "## Dependencies\n\n| Package | Purpose | Why |\n|---------|---------|-----|\n| `litellm` | Multi-provider LLM calls | 100+ providers, one interface |\n| `typer` | CLI framework | Modern, type-hinted, auto-docs |\n| `pydantic` | Data structures | Validation, serialization |\n| `sentence-transformers` | Embeddings | Local, no API cost |\n| `chromadb` | Vector storage | Simple, local, good enough |\n| `rich` | Terminal UI | Pretty output, tables, trees |\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Model Escalation Tiers",
      "content": "## Model Escalation Tiers\n\nStart cheap, escalate on failure:\n\n| Tier | Models | Cost | Use When |\n|------|--------|------|----------|\n| **Free** | GLM-4, DeepSeek | $0 | Default starting point |\n| **Standard** | Sonnet, GPT-4o | $$ | After 2 failures at free |\n| **Expensive** | Opus, o1 | $$$$ | Complex reasoning, last resort |\n\n```python\nimport litellm\n\n# Same interface, just change the string\nresponse = litellm.completion(\n    model=\"glm-4\",  # or \"claude-sonnet-4-20250514\" or \"claude-opus-4-20250514\"\n    messages=[{\"role\": \"user\", \"content\": \"Hello\"}]\n)\n```\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "User-Hackable Locations",
      "content": "## User-Hackable Locations\n\n```\n~/.oi/\n\u251c\u2500\u2500 config.yaml           # Global settings, model preferences\n\u251c\u2500\u2500 instructions/         # System prompts, agent instructions\n\u2502   \u251c\u2500\u2500 system.md\n\u2502   \u2514\u2500\u2500 agents/\n\u2502       \u251c\u2500\u2500 dev-agent.md\n\u2502       \u2514\u2500\u2500 qa-agent.md\n\u251c\u2500\u2500 schemas/              # Pydantic models (if overriding)\n\u251c\u2500\u2500 tools/                # Custom tools (drop-in Python)\n\u2502   \u2514\u2500\u2500 my_tool.py\n\u2514\u2500\u2500 state/                # Artifacts, chat logs (inspectable)\n    \u251c\u2500\u2500 artifacts.db\n    \u2514\u2500\u2500 logs/\n```\n\n**Everything is files**. No hidden databases, no binary blobs, no cloud lock-in.\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "What We're NOT Using",
      "content": "## What We're NOT Using\n\n| Option | Reason Rejected |\n|--------|-----------------|\n| `openai` SDK | Implies lock-in, litellm is provider-agnostic |\n| LangChain | Too heavy, too much abstraction, hard to debug |\n| Raw `httpx` | Reinventing the wheel |\n| Rust | Harder to modify for average user |\n| TypeScript | Another runtime, no advantage for CLI |\n| Cloud vector DBs | Cost, lock-in, complexity |\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Future Considerations",
      "content": "## Future Considerations\n\n| Need | Solution | When |\n|------|----------|------|\n| Web dashboard | TypeScript/React | After core CLI stable |\n| Performance hotspots | Rust/PyO3 | If profiling shows need |\n| 3D visualization | Three.js/WebGL | Much later |\n| Mobile | React Native or PWA | Maybe never |\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Example: Adding a Custom Tool",
      "content": "## Example: Adding a Custom Tool\n\n```python\n# ~/.oi/tools/my_search.py\n\ndef search_jira(query: str) -> list[dict]:\n    \"\"\"Search JIRA for issues matching query.\"\"\"\n    # Your implementation\n    return results\n\n# Auto-discovered, available to agents\n```\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Example: Modifying Agent Instructions",
      "content": "## Example: Modifying Agent Instructions\n\n```markdown\n<!-- ~/.oi/instructions/agents/dev-agent.md -->\n\n# Dev Agent\n\nYou are a development agent focused on writing code."
    },
    {
      "source": "tech-stack.md",
      "heading": "Rules",
      "content": "## Rules\n- Never modify tests\n- Always run tests after changes\n- Escalate after 2 failures"
    },
    {
      "source": "tech-stack.md",
      "heading": "Tools Available",
      "content": "## Tools Available\n- read_file\n- write_file\n- run_tests\n- my_search  <!-- custom tool auto-loaded -->\n```\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Storage Strategy",
      "content": "## Storage Strategy\n\n| Data | Format | Location | Why |\n|------|--------|----------|-----|\n| Artifacts | SQLite | `~/.oi/state/artifacts.db` | Queryable, single file |\n| Chat logs | JSONL | `~/.oi/state/logs/*.jsonl` | Appendable, streamable |\n| Embeddings | ChromaDB | `~/.oi/state/vectors/` | Local, no API |\n| Config | YAML | `~/.oi/config.yaml` | Human-editable |\n| Instructions | Markdown | `~/.oi/instructions/` | Just text |\n\n---"
    },
    {
      "source": "tech-stack.md",
      "heading": "Applications: Configurations of Primitives",
      "content": "## Applications: Configurations of Primitives\n\nThe primitives are domain-agnostic. Applications are configurations for specific use cases.\n\n```\n~/.oi/\n\u251c\u2500\u2500 applications/\n\u2502   \u251c\u2500\u2500 coding/                    # TDD pipeline for development\n\u2502   \u2502   \u251c\u2500\u2500 agents/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 dev-agent.md\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 test-architect.md\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 qa-agent.md\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 director-agent.md\n\u2502   \u2502   \u251c\u2500\u2500 tools/\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 run_tests.py\n\u2502   \u2502   \u2514\u2500\u2500 config.yaml            # coding-specific settings\n\u2502   \u2502\n\u2502   \u251c\u2500\u2500 research/                  # Different agents, same primitives\n\u2502   \u2502   \u251c\u2500\u2500 agents/\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 search-agent.md\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 summarize-agent.md\n\u2502   \u2502   \u2514\u2500\u2500 config.yaml\n\u2502   \u2502\n\u2502   \u2514\u2500\u2500 writing/                   # Yet another configuration\n\u2502       \u251c\u2500\u2500 agents/\n\u2502       \u2502   \u251c\u2500\u2500 outline-agent.md\n\u2502       \u2502   \u2514\u2500\u2500 editor-agent.md\n\u2502       \u2514\u2500\u2500 config.yaml\n```\n\n**First target**: Coding assistant with TDD pipeline (dev-agent, test-architect, QA, director).\n\n**Key insight**: The primitives ARE the product. Applications are just configurations.\n\nSee [thesis.md](thesis.md) for the full vision."
    },
    {
      "source": "thesis.md",
      "heading": "The Bigger Picture: Primitives and Applications",
      "content": "## The Bigger Picture: Primitives and Applications\n\nThis project builds a **customizable AI system from composable primitives**. The primitives are domain-agnostic; applications are configurations of those primitives for specific use cases.\n\n```\nPRIMITIVES (the building blocks)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u251c\u2500\u2500 Efforts        - Units of focused work\n\u251c\u2500\u2500 Artifacts      - Compacted knowledge (conclusions, facts, events)\n\u251c\u2500\u2500 Tools          - Extensible Python functions\n\u251c\u2500\u2500 Instructions   - Markdown prompts (system, agent)\n\u251c\u2500\u2500 Schemas        - Pydantic data models\n\u251c\u2500\u2500 Context Mgmt   - Lazy compaction, effort weight, focus constraint\n\u251c\u2500\u2500 Model Ladder   - Escalation from cheap \u2192 expensive models\n\u2514\u2500\u2500 Persistence    - Files, SQLite, everything inspectable\n\n         \u2193 composed into \u2193\n\nAPPLICATIONS (configurations)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u251c\u2500\u2500 Coding Assistant    \u2190 First target (TDD pipeline)\n\u251c\u2500\u2500 Research Assistant\n\u251c\u2500\u2500 Writing Assistant\n\u251c\u2500\u2500 Knowledge Base\n\u2514\u2500\u2500 [any domain]\n```\n\n**Key insight**: The primitives ARE the product. Applications are just configurations stored in `~/.oi/applications/<name>/`.\n\nThe five theses below describe the **knowledge layer** - how conversations become persistent, growing, connected knowledge. This is one set of primitives. Other primitives (tools, agents, escalation) handle execution.\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "Abstract",
      "content": "## Abstract\n\nCurrent AI systems compact conversations arbitrarily\u2014when context windows fill, tokens get summarized or discarded. This treats knowledge as a storage problem rather than a reasoning problem.\n\nThis document proposes a fundamentally different approach: **conclusion-triggered compaction**. Instead of compressing when we run out of space, we compress when we reach understanding. Each conclusion becomes a node in a growing knowledge network, with confidence emerging from network topology rather than explicit assignment.\n\nThe framework addresses four interconnected problems:\n1. **Context efficiency** - How to maintain reasoning chains without token explosion\n2. **Knowledge accumulation** - How conversations across time contribute to shared understanding\n3. **Privacy preservation** - How personal details can yield generalizable lessons\n4. **Knowledge integrity** - How to update beliefs without catastrophic forgetting\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "The Problem",
      "content": "### The Problem\n\nCurrent conversation systems compact based on capacity:\n- Context window fills \u2192 summarize oldest messages\n- Token limit reached \u2192 truncate or abstract\n- Memory pressure \u2192 discard \"less important\" content\n\nThis is backwards. It treats the symptom (running out of space) rather than the cause (unresolved reasoning)."
    },
    {
      "source": "thesis.md",
      "heading": "The Insight",
      "content": "### The Insight\n\n**Conversations stay open until there is resolution.**\n\nThis mirrors human cognition. We ruminate on:\n- Problems we haven't solved\n- Relationships with unresolved tension\n- Ideas we don't fully understand\n\nThe Zeigarnik effect demonstrates this: incomplete tasks occupy mental resources until closed. Our system should work the same way."
    },
    {
      "source": "thesis.md",
      "heading": "The Mechanism",
      "content": "### The Mechanism\n\nInstead of waiting for memory pressure, perform **continuous mini-compactions** as conclusions are reached:\n\n```\nInvestigation Thread (2000 tokens)\n\u251c\u2500\u2500 Hypothesis A explored\n\u2502   \u2514\u2500\u2500 CONCLUSION: Not A, because Z\n\u2502       \u2192 Compact to: \"A ruled out (reason: Z)\" [link to full thread]\n\u2502       \u2192 2000 tokens \u2192 15 tokens + link\n\u251c\u2500\u2500 Hypothesis B explored\n\u2502   \u2514\u2500\u2500 CONCLUSION: Not B, because Y\n\u2502       \u2192 Compact to: \"B ruled out (reason: Y)\" [link to full thread]\n\u2514\u2500\u2500 Hypothesis C explored\n    \u2514\u2500\u2500 CONCLUSION: C confirmed, bug fixed\n        \u2192 Compact to: \"Root cause: C. Fix: [description]\" [link to full thread]\n```\n\n**Result**: A 12,000 token debugging session becomes ~400 tokens of linked conclusions. The full reasoning is preserved and accessible, but doesn't consume active context."
    },
    {
      "source": "thesis.md",
      "heading": "What Triggers a Conclusion?",
      "content": "### What Triggers a Conclusion?\n\nThis is the key design question. Potential triggers:\n\n| Trigger Type | Example | Confidence |\n|--------------|---------|------------|\n| Explicit declaration | \"I conclude X\" | High |\n| Resolution pattern | Problem stated \u2192 solution verified | High |\n| Negation confirmed | \"Option A doesn't work because...\" | Medium-High |\n| User confirmation | \"Yes, that's the issue\" | High |\n| Evidence convergence | Multiple paths point to same answer | High |\n\nThe system should recognize these patterns and offer to compact, or compact automatically for high-confidence conclusions."
    },
    {
      "source": "thesis.md",
      "heading": "Properties",
      "content": "### Properties\n\n1. **No arbitrary cutoffs** - Compaction is semantic, not capacity-based\n2. **Lossless in principle** - Full threads preserved via links\n3. **Progressive summarization** - Each level more abstract than the last\n4. **Reversible** - Can always expand a conclusion back to its source thread\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "The Problem",
      "content": "### The Problem\n\nEach conversation exists in isolation. Lessons learned in one session don't inform another. Users repeat the same debugging patterns, rediscover the same solutions, re-explain the same context."
    },
    {
      "source": "thesis.md",
      "heading": "The Insight",
      "content": "### The Insight\n\n**Every conversation extends a shared web of knowledge.**\n\nConclusions from Thesis 1 don't just save tokens\u2014they become nodes in a growing graph:\n\n```\nconversation_1 \u2192 conclusions_1 \u2192\n                                 \u2198\nconversation_2 \u2192 conclusions_2 \u2192  \u2192 knowledge_graph\n                                 \u2197\nconversation_3 \u2192 conclusions_3 \u2192\n```"
    },
    {
      "source": "thesis.md",
      "heading": "The Structure",
      "content": "### The Structure\n\nEach conclusion node contains:\n- **Content**: The conclusion itself\n- **Source**: Link to originating conversation/thread\n- **Connections**: Links to supporting/related conclusions\n- **Confidence**: Emergent score (see Thesis 5)\n- **Abstraction level**: How general vs specific\n\nConnections form through:\n- **Support**: Conclusion A provides evidence for Conclusion B\n- **Contradiction**: Conclusion A conflicts with Conclusion B (triggers resolution)\n- **Generalization**: Conclusion A is a specific instance of Conclusion B\n- **Derivation**: Conclusion A was reasoned from Conclusion B"
    },
    {
      "source": "thesis.md",
      "heading": "Example",
      "content": "### Example\n\n```\nSession 1: Debugging auth in Project X\n\u2514\u2500\u2500 Conclusion: \"Validate tokens before database queries\"\n    \u2514\u2500\u2500 Abstraction: \"Validate inputs at trust boundaries\"\n\nSession 2: Debugging different auth issue in Project Y\n\u2514\u2500\u2500 Conclusion: \"Check token expiry before API calls\"\n    \u2514\u2500\u2500 Links to: \"Validate inputs at trust boundaries\" (same principle)\n    \u2514\u2500\u2500 Reinforces confidence in that abstraction\n\nSession 3: Reviewing security architecture\n\u2514\u2500\u2500 Queries network: \"What do I know about input validation?\"\n\u2514\u2500\u2500 Retrieves: Both specific instances + abstract principle\n\u2514\u2500\u2500 Confidence score reflects: 2 independent confirmations\n```"
    },
    {
      "source": "thesis.md",
      "heading": "Properties",
      "content": "### Properties\n\n1. **Grows with use** - Every conversation potentially adds nodes\n2. **Self-organizing** - Connections emerge from content similarity and explicit links\n3. **Queryable** - Can ask \"what do I know about X?\"\n4. **Multi-scale** - Contains both specific instances and general principles\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "Thesis 3: Abstraction Hierarchy & Privacy Gradient",
      "content": "## Thesis 3: Abstraction Hierarchy & Privacy Gradient"
    },
    {
      "source": "thesis.md",
      "heading": "The Problem",
      "content": "### The Problem\n\nPersonal conversations contain sensitive details\u2014project names, company information, private code. But the *lessons* from those conversations are often universally applicable. How do we extract shareable knowledge from private contexts?"
    },
    {
      "source": "thesis.md",
      "heading": "The Insight",
      "content": "### The Insight\n\n**Abstraction naturally strips identifying details.**\n\nAs conclusions generalize, they lose specificity:\n\n```\nLayer 0 (Private):   \"Fixed auth bug in my-company's user.rs line 47 by adding token validation\"\nLayer 1 (Semi):      \"Auth tokens should be validated before database queries in Rust services\"\nLayer 2 (General):   \"Validate inputs at trust boundaries\"\nLayer 3 (Universal): \"Defense in depth\"\n```\n\nEach layer:\n- More abstract\n- Less personally identifying\n- More widely applicable\n- More shareable"
    },
    {
      "source": "thesis.md",
      "heading": "The Privacy Gradient",
      "content": "### The Privacy Gradient\n\n| Layer | Contains | Shareable With |\n|-------|----------|----------------|\n| 0 - Raw | File paths, company names, specific code | Only self |\n| 1 - Contextual | Technology stack, pattern used, domain | Team/org |\n| 2 - Principle | General programming principle | Community |\n| 3 - Universal | Fundamental concept | Everyone |"
    },
    {
      "source": "thesis.md",
      "heading": "Emergence of Shared Knowledge",
      "content": "### Emergence of Shared Knowledge\n\nThis creates a natural path from private experience to public wisdom:\n\n1. **Individual learns** from specific debugging session (Layer 0)\n2. **Conclusion extracted** with some generalization (Layer 1)\n3. **Multiple individuals** reach similar Layer 1 conclusions\n4. **Convergence detected** \u2192 Layer 2 principle crystallizes\n5. **Community validates** through independent confirmation\n6. **Universal principle** emerges at Layer 3\n\nNo central authority decides what's \"true.\" Knowledge bubbles up through independent convergence."
    },
    {
      "source": "thesis.md",
      "heading": "Properties",
      "content": "### Properties\n\n1. **Privacy by design** - Sensitive details stay at low layers\n2. **Value extraction** - Lessons can be shared without exposing source\n3. **Community knowledge** - Emerges from individual experiences\n4. **Organic curation** - Popular/confirmed ideas rise, unsupported ones don't\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "The Problem",
      "content": "### The Problem\n\nNew knowledge sometimes contradicts existing knowledge. Traditional neural networks suffer **catastrophic forgetting**\u2014training on new data can corrupt previously learned patterns. Knowledge systems need a principled way to handle conflicts."
    },
    {
      "source": "thesis.md",
      "heading": "The Insight",
      "content": "### The Insight\n\n**Not all conflicts are equal. Truth conflicts and preference conflicts require different resolution.**"
    },
    {
      "source": "thesis.md",
      "heading": "Two Types of Conflict",
      "content": "### Two Types of Conflict\n\n**Truth Conflicts**: Factual disagreements where one side is correct\n- \"The bug is in module A\" vs \"The bug is in module B\"\n- Resolution: Evidence determines winner\n- Loser gets demoted/removed, winner gains confidence\n\n**Preference Conflicts**: Subjective choices where both are valid\n- \"Use tabs\" vs \"Use spaces\"\n- \"Prefer composition\" vs \"Prefer inheritance\"\n- Resolution: Context-dependent, explicit choice, or coexistence"
    },
    {
      "source": "thesis.md",
      "heading": "Resolution Mechanism",
      "content": "### Resolution Mechanism\n\n```\nConflict Detected\n       \u2502\n       \u25bc\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Classify Type    \u2502\n\u2502 Truth or Pref?   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510\n    \u25bc         \u25bc\n TRUTH     PREFERENCE\n    \u2502         \u2502\n    \u25bc         \u25bc\nEvidence   Explicit\nWeighing   Declaration?\n    \u2502         \u2502\n    \u2502    \u250c\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2510\n    \u2502    \u25bc         \u25bc\n    \u2502   YES        NO\n    \u2502    \u2502         \u2502\n    \u25bc    \u25bc         \u25bc\nWinner  New       Roundtable/\nTakes   Replaces  User Decides\nAll     Old\n```"
    },
    {
      "source": "thesis.md",
      "heading": "For Truth Conflicts",
      "content": "### For Truth Conflicts\n\nEvaluate supporting evidence:\n1. Count independent confirmations for each side\n2. Weight by source reliability (if known)\n3. Consider recency (newer evidence may reflect updated understanding)\n4. Check for superseding conclusions\n\nThe better-supported conclusion wins. The loser is:\n- Marked as superseded (not deleted\u2014history preserved)\n- Linked to the winner as \"disproven by\"\n- Confidence transferred to winner"
    },
    {
      "source": "thesis.md",
      "heading": "For Preference Conflicts",
      "content": "### For Preference Conflicts\n\nIf explicit new preference declared:\n- Old preference marked as \"superseded by explicit choice\"\n- New preference takes precedence\n- Both remain in network (preferences can revert)\n\nIf no explicit declaration:\n- Flag for user/roundtable resolution\n- Present both options with context\n- Require explicit choice to resolve"
    },
    {
      "source": "thesis.md",
      "heading": "Properties",
      "content": "### Properties\n\n1. **No silent overwrites** - All conflicts are explicit\n2. **History preserved** - Superseded conclusions remain accessible\n3. **Evidence-based** - Truth conflicts resolved by support, not authority\n4. **User agency** - Preferences require explicit human choice\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "The Problem",
      "content": "### The Problem\n\nHow confident should we be in any given conclusion? Explicit confidence scores are:\n- Arbitrary (who decides \"0.8 confident\"?)\n- Static (don't update as evidence accumulates)\n- Gaming-prone (can be inflated)"
    },
    {
      "source": "thesis.md",
      "heading": "The Insight",
      "content": "### The Insight\n\n**Confidence emerges from network topology.**\n\nA conclusion's confidence isn't assigned\u2014it's computed from:\n1. **Inbound support**: How many other conclusions point to this one?\n2. **Failed disproofs**: How many attempts to contradict it have failed?\n3. **Independent convergence**: Did multiple paths reach the same conclusion?\n4. **Derivation depth**: Is this derived from other high-confidence nodes?"
    },
    {
      "source": "thesis.md",
      "heading": "The Mechanism",
      "content": "### The Mechanism\n\n```\nConfidence(node) = f(\n    supporters,           // Nodes that reference this as support\n    failed_contradictions, // Nodes that tried and failed to disprove\n    independent_paths,    // Distinct reasoning chains reaching same conclusion\n    supporter_confidence  // Recursive: confidence of supporting nodes\n)\n```\n\nThis creates **propagating confidence updates**:\n- If A supports B, and B gains confidence, A gains confidence (validated supporter)\n- If A contradicts B, and B gains confidence, A loses confidence\n- Cascades through network in real-time"
    },
    {
      "source": "thesis.md",
      "heading": "Example",
      "content": "### Example\n\n```\nConclusion: \"Validate inputs at trust boundaries\"\n\nInitial confidence: Low (single source)\n\nEvent 1: Second project confirms same principle\n\u2192 Independent path detected\n\u2192 Confidence increases\n\nEvent 2: Someone argues \"validation is unnecessary overhead\"\n\u2192 Counter-argument fails (multiple bugs traced to missing validation)\n\u2192 Failed contradiction\n\u2192 Confidence increases\n\nEvent 3: Three more projects cite this principle\n\u2192 Inbound support count: 5\n\u2192 Confidence now high\n\nEvent 4: Downstream conclusion (\"sanitize SQL inputs\") gains confidence\n\u2192 Derived from \"validate inputs at trust boundaries\"\n\u2192 Parent confidence increases (validated as useful foundation)\n```"
    },
    {
      "source": "thesis.md",
      "heading": "Properties",
      "content": "### Properties\n\n1. **No manual scoring** - Confidence emerges from structure\n2. **Self-correcting** - Bad conclusions naturally lose support\n3. **Resistant to gaming** - Can't inflate without real support\n4. **Dynamic** - Updates as network evolves\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "The Parallel",
      "content": "### The Parallel\n\nTraditional neural networks:\n- Store knowledge in **weights** (distributed, opaque)\n- Learn through **gradient descent** (adjust weights to minimize error)\n- Suffer **catastrophic forgetting** (new training corrupts old patterns)\n- Require **freezing** to preserve learned knowledge\n\nThis knowledge network:\n- Stores knowledge in **nodes and edges** (explicit, inspectable)\n- Learns through **conclusion accumulation** (add nodes as understanding grows)\n- Handles forgetting through **conflict resolution** (explicit, not catastrophic)\n- Preserves knowledge through **graph structure** (old nodes remain, confidence adjusts)"
    },
    {
      "source": "thesis.md",
      "heading": "What This Enables",
      "content": "### What This Enables\n\n**The network IS the model.**\n\nNo separate training phase. No weight matrices. The graph structure itself encodes:\n- What is known (nodes)\n- How knowledge relates (edges)\n- How confident we are (topology-derived scores)\n- How knowledge evolved (history links)"
    },
    {
      "source": "thesis.md",
      "heading": "The Vision",
      "content": "### The Vision\n\nCurrent LLMs are the **bootstrap layer**. They can:\n1. Process natural language conversations\n2. Recognize conclusion patterns\n3. Extract generalizations\n4. Detect conflicts\n\nBut they don't accumulate knowledge across sessions. This framework uses LLMs as the **reasoning engine** while the knowledge network provides **persistent, growing, shared memory**.\n\nEventually: The knowledge network itself could become a new form of distributed intelligence\u2014not replacing neural networks, but complementing them with explicit, auditable, community-built knowledge.\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "Phase 1: Single-Session Conclusion Tracking",
      "content": "### Phase 1: Single-Session Conclusion Tracking\n\nImplement Thesis 1 in isolation:\n- Detect conclusion patterns in conversation\n- Create conclusion nodes with source links\n- Replace verbose threads with conclusion summaries\n- Demonstrate token savings\n\n**Deliverable**: A conversation wrapper that automatically compacts resolved threads"
    },
    {
      "source": "thesis.md",
      "heading": "Phase 2: Cross-Session Knowledge Graph",
      "content": "### Phase 2: Cross-Session Knowledge Graph\n\nBuild on Phase 1 to implement Thesis 2:\n- Persist conclusions across sessions\n- Detect connections between conclusions\n- Enable knowledge queries (\"what do I know about X?\")\n- Visualize growing network\n\n**Deliverable**: A knowledge base that grows with each conversation"
    },
    {
      "source": "thesis.md",
      "heading": "Phase 3: Abstraction & Privacy Layers",
      "content": "### Phase 3: Abstraction & Privacy Layers\n\nAdd Thesis 3:\n- Automatic generalization of conclusions\n- Privacy classification by abstraction level\n- Shareable knowledge extraction\n\n**Deliverable**: Ability to export \"lessons learned\" without private details"
    },
    {
      "source": "thesis.md",
      "heading": "Phase 4: Conflict Resolution",
      "content": "### Phase 4: Conflict Resolution\n\nImplement Thesis 4:\n- Conflict detection between conclusions\n- Classification (truth vs preference)\n- Resolution workflows\n- Roundtable integration for ambiguous cases\n\n**Deliverable**: Knowledge base that handles contradictions gracefully"
    },
    {
      "source": "thesis.md",
      "heading": "Phase 5: Emergent Confidence",
      "content": "### Phase 5: Emergent Confidence\n\nComplete the system with Thesis 5:\n- Confidence scoring from topology\n- Propagation algorithms\n- Visualization of confidence flows\n\n**Deliverable**: Full living knowledge network with emergent trust\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "Open Systems Project",
      "content": "### Open Systems Project\n\nThis framework directly relates to the governance system in [Open Systems](D:\\Dev\\Open Systems\\Open Systems\\):\n\n| Knowledge Network Concept | Open Systems Equivalent |\n|---------------------------|------------------------|\n| Conclusion nodes | Audit decisions / precedents |\n| Confidence from support | Experience from upvotes |\n| Conflict resolution | CONFLICTS.md process |\n| Abstraction hierarchy | Spec \u2192 Design Journal \u2192 Implementation |\n| Community knowledge | Emergent case law from precedents |\n\nThe [DESIGN-JOURNAL.md](D:\\Dev\\Open Systems\\Open Systems\\SPECS\\DESIGN-JOURNAL.md) already implements conclusion-triggered documentation\u2014each entry is a resolved insight with links to related decisions."
    },
    {
      "source": "thesis.md",
      "heading": "Potential Unification",
      "content": "### Potential Unification\n\nOpen Systems' voting-experience system could BE the confidence mechanism for a public knowledge network:\n- Upvotes = inbound support edges\n- Auditor consensus = conflict resolution\n- Experience accumulation = confidence propagation\n- Subject tags = abstraction domains\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n\n1. **Conclusion detection**: What NLP/heuristics reliably identify \"this thread has concluded\"?\n\n2. **Link inference**: How do we detect that two conclusions support each other without explicit declaration?\n\n3. **Abstraction automation**: Can we automatically generalize \"fixed bug in user.rs\" \u2192 \"validate at trust boundaries\"?\n\n4. **Confidence propagation**: What's the right algorithm? PageRank-like? Bayesian? Custom?\n\n5. **Storage format**: Graph database? JSON-LD? Custom format? Must support versioning and links.\n\n6. **Privacy boundaries**: How do users control what abstraction level is shareable?\n\n7. **Bootstrap problem**: How does the network start? Seed with existing knowledge bases?\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "References",
      "content": "## References\n\n- [Open Systems - DESIGN-JOURNAL.md](D:\\Dev\\Open Systems\\Open Systems\\SPECS\\DESIGN-JOURNAL.md) - Example of conclusion-based documentation\n- [Open Systems - CONFLICTS.md](D:\\Dev\\Open Systems\\Open Systems\\SPECS\\CONFLICTS.md) - Conflict resolution implementation\n- [Open Systems - voting-experience-system-v1.md](D:\\Dev\\Open Systems\\Open Systems\\SPECS\\voting-experience-system-v1.md) - Confidence through community validation\n- Zeigarnik Effect - Psychological basis for \"open threads occupy attention\"\n- Catastrophic Forgetting in Neural Networks - The problem this framework addresses differently\n\n---"
    },
    {
      "source": "thesis.md",
      "heading": "Document History",
      "content": "## Document History\n\n- **2025-01-10**: Initial draft from brainstorming session\n- Captures Theses 1-4 plus confidence mechanics\n- Outlines implementation phases\n- Links to existing Open Systems work\n\n---\n\n*This document is itself a node in the knowledge network it describes. Its confidence will grow as implementations validate or refine these ideas.*"
    },
    {
      "source": "TODO.md",
      "heading": "1. Child Efforts Design",
      "content": "### 1. Child Efforts Design\n**Status**: Mentioned, not designed\n**Question**: How does effort hierarchy work? When is something a child effort vs a new chat?\n\nSupporting docs:\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - \"Constraint as Feature\" section\n\nOpen questions:\n- [ ] What makes something a \"child\" vs \"sibling\" effort?\n- [ ] How deep can nesting go?\n- [ ] How do child efforts roll up to parent?\n- [ ] Can a child effort become its own chat (promotion)?\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "2. Chat Log Format",
      "content": "### 2. Chat Log Format\n**Status**: Designed\n**Question**: What does the summarized chat log artifact look like?\n\nSupporting docs:\n- [context-and-cognition.md](brainstorm/context-and-cognition.md) - **Two-log model fully designed**\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - \"Two files per chat\" concept\n- [refined-chat-model.md](brainstorm/refined-chat-model.md) - Chat + artifacts model\n\nDecisions made:\n- [x] Two logs: raw (verbatim JSONL) + summary (manifest YAML)\n- [x] Manifest contains segments with type, summary, raw_ref, artifact links\n- [x] Segment types: effort, fact, event, greeting, calculation, clarification, meta\n- [x] Storage: `~/.oi/chats/chat-123/{manifest.yaml, raw.jsonl}`\n\nOpen questions:\n- [ ] How to detect segment boundaries automatically?\n- [ ] Exact manifest schema (needs implementation)\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "3. Slice 1 Redesign",
      "content": "### 3. Slice 1 Redesign\n**Status**: Likely needed\n**Question**: Apply new \"one chat = one effort\" model to concrete implementation\n\nSupporting docs:\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - New model\n- [1a-minimal.md](slices/1a-minimal.md) - Original slice spec\n- [1a-minimal-scenario.md](scenarios/1a-minimal-scenario.md) - Original scenario\n- [1a-minimal-stories.md](stories/1a-minimal-stories.md) - Original stories\n\nOpen questions:\n- [ ] Does \"open/resolved\" artifact state still make sense?\n- [ ] How does the bug we found get resolved in new model?\n- [ ] What's the new minimal scenario?\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "4. Fork Mechanics",
      "content": "### 4. Fork Mechanics\n**Status**: Mentioned, not designed\n**Question**: What gets copied when forking? How does context transfer?\n\nSupporting docs:\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - Topic change handling\n- [refined-chat-model.md](brainstorm/refined-chat-model.md) - Fork concept\n\nOpen questions:\n- [ ] Fork = full copy or selective copy?\n- [ ] Does forked chat link back to parent?\n- [ ] How is fork different from \"new chat with artifacts\"?\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "5. Vector Filtering Design",
      "content": "### 5. Vector Filtering Design\n**Status**: Mentioned, not designed\n**Question**: How do we calculate relevance for filtering low-value turns?\n\nSupporting docs:\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - Lazy compaction section\n- [refined-chat-model.md](brainstorm/refined-chat-model.md) - RAG strategy\n\nOpen questions:\n- [ ] How to calculate \"chat vector\" (overall topic)?\n- [ ] What similarity threshold for filtering?\n- [ ] Filter on every prompt or only during compaction?\n- [ ] What about turns that are low relevance but important (corrections)?\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "6. AI Chat Retrieval & Context Strategies",
      "content": "### 6. AI Chat Retrieval & Context Strategies\n**Status**: Designed\n**Question**: How does AI find relevant old context for new chats?\n\nSupporting docs:\n- [context-and-cognition.md](brainstorm/context-and-cognition.md) - **Context strategies fully designed**\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - Chat management section\n- [refined-chat-model.md](brainstorm/refined-chat-model.md) - RAG strategy\n\nDecisions made:\n- [x] Three strategies: chat-only, RAG-only, hybrid\n- [x] Effort weight controls which strategy / how much context\n- [x] Chat merging via `/merge @chat1 @chat2` or auto-suggestion\n- [x] Chats compact to artifact refs, so \"merging\" is just combining refs\n\nOpen questions:\n- [ ] When does RAG retrieval happen (every prompt vs on-demand)?\n- [ ] How to present merge suggestions without being annoying?\n- [ ] Should merged chats maintain link to originals?\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "9. Human Context Dashboard",
      "content": "### 9. Human Context Dashboard\n**Status**: New, brainstormed\n**Question**: How do we help humans manage their cognitive load alongside AI context?\n\nSupporting docs:\n- [human-context-management.md](brainstorm/human-context-management.md) - Full brainstorm\n\nCore insight: The human has a context limit too. They lose track of artifacts created, decisions made, relationships between things.\n\nNeeds:\n- [ ] Session summary generation (what was created/decided)\n- [ ] Artifact inventory view (grouped by type, project, effort)\n- [ ] Relationship visualization (how artifacts connect)\n- [ ] Search/filter across artifacts\n- [ ] Effort-artifact linking (what artifacts belong to which effort)\n\nOpen questions:\n- [ ] TUI vs web dashboard vs both?\n- [ ] Auto-generate summaries or manual?\n- [ ] Integration with existing tools (Obsidian, Notion)?\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "7. Agents Architecture",
      "content": "### 7. Agents Architecture\n**Status**: Significantly designed\n**Question**: How do agents coordinate without a central director?\n\nSupporting docs:\n- [peer-agent-scenario.md](scenarios/peer-agent-scenario.md) - Full peer model scenario\n- [director-agent-scenario.md](scenarios/director-agent-scenario.md) - Director model for comparison\n- [agent-communication.md](brainstorm/agent-communication.md) - Disputes, escalation, coordination\n\nDecisions made:\n- [x] Peer model preferred (stateless agents, kanban as coordinator)\n- [x] Disputes via artifact comments + kanban backflow\n- [x] Escalation via failure_count in item metadata + model ladder\n- [x] Specialist columns for domain-specific help (future)\n\nOpen questions:\n- [ ] Custom kanban system vs GitHub Projects?\n- [ ] Comment storage format (inline vs separate files)?\n- [ ] Specialist agent definitions (future slice)\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "8. Effort Weight Inference",
      "content": "### 8. Effort Weight Inference\n**Status**: Partially designed\n**Question**: How is effort weight automatically inferred?\n\nSupporting docs:\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - Effort weight section + Focus constraint section\n\nDecisions made:\n- [x] Default weights per effort type (dev=high, learning=low, etc.)\n- [x] Weight controls focus constraint (high=locked, low=flexible)\n- [x] User overrides via `/lock`, `/unlock`, `/weight`\n\nOpen questions:\n- [ ] What keywords/signals trigger what weight?\n- [ ] Can weight change mid-effort?\n- [ ] How to detect effort type reliably?\n\n---"
    },
    {
      "source": "TODO.md",
      "heading": "10. Model Escalation Strategy",
      "content": "### 10. Model Escalation Strategy\n**Status**: Captured, not detailed\n**Question**: How do we minimize cost by defaulting to cheap models and escalating only on failure?\n\nSupporting docs:\n- [effort-scoped-context.md](brainstorm/effort-scoped-context.md) - Model escalation section\n- Open Colony pipeline had this (GLM \u2192 Sonnet \u2192 Opus)\n\nCore concept:\n- Start with free/cheap tier (GLM, Haiku)\n- Escalate after 2 failures at current tier\n- Effort weight influences starting tier and escalation speed\n- Track cost per effort, show user breakdown\n\nOpen questions:\n- [ ] How to detect \"failure\" vs \"needs user input\"?\n- [ ] De-escalation logic (when to go back to cheap)?\n- [ ] Task\u2192model mapping learned from usage?\n- [ ] Fine-tuning cheap models on expensive successes?\n\n---"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Core Principle: Stateless Agents, Stateful Items",
      "content": "## Core Principle: Stateless Agents, Stateful Items\n\nAgents are ephemeral. They:\n- Pick up work\n- Do the work (one effort = one chat)\n- Update the item\n- Die\n\nAll state lives in the **kanban item**, not the agent.\n\n---"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Communication Mechanisms",
      "content": "## Communication Mechanisms\n\nAgents don't talk to each other. They communicate via:\n\n| Mechanism | Purpose |\n|-----------|---------|\n| **Kanban columns** | Workflow state (ready, in-progress, blocked) |\n| **Artifact comments** | Detailed feedback, questions, disputes |\n| **Item metadata** | failure_count, escalation_tier, tags |\n| **Column moves** | Trigger next agent, backflow for issues |\n\n---"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Example: Dev thinks test is wrong",
      "content": "### Example: Dev thinks test is wrong\n\n```\nDEV-AGENT                              TEST-ARCHITECT\n    \u2502                                        \u2502\n    \u2502 1. Comments on test artifact:          \u2502\n    \u2502    \"Test assumes sync, but arch        \u2502\n    \u2502     specifies async. Test is wrong.\"   \u2502\n    \u2502                                        \u2502\n    \u2502 2. Moves issue to \"Ready for Tests\"    \u2502\n    \u2502                                        \u2502\n    \u2502 3. Dies (effort complete)              \u2502\n    \u2502                                        \u2502\n    \u2502                          4. Picks up issue\n    \u2502                          5. Reads comment\n    \u2502                          6. Either:\n    \u2502                             a) Agrees \u2192 fixes test\n    \u2502                             b) Disagrees \u2192 replies\n    \u2502                                        \u2502\n    \u2502 7. If disagreed:                       \u2502\n    \u2502    - Reply comment added               \u2502\n    \u2502    - Issue moves to \"Ready for Dev\"    \u2502\n    \u2502    - Test-architect dies               \u2502\n    \u2502                                        \u2502\n    \u2502 8. Dev-agent picks up                  \u2502\n    \u2502    Reads reply, continues or accepts   \u2502\n```"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Comment Structure",
      "content": "### Comment Structure\n\n```yaml\n# Artifact: tests/247-trading-tests.md\n# Metadata: tests/247-trading-tests.meta.yaml\n\ncomments:\n  - id: c001\n    author: dev-agent\n    timestamp: 2024-01-17T14:30:00\n    target: \"test_trade_cancellation\"  # specific test/section\n    content: |\n      This test assumes synchronous cancellation, but the\n      architecture doc specifies async event-driven cancellation.\n      Test will always fail with correct implementation.\n    status: open\n\n  - id: c002\n    author: test-architect\n    timestamp: 2024-01-17T15:45:00\n    parent: c001  # reply to\n    content: |\n      You're right. Architecture says async. Updating test\n      to use async/await pattern with proper event mocking.\n    status: resolved\n    resolution: accepted\n```"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Dispute Resolution Flow",
      "content": "### Dispute Resolution Flow\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  DISPUTE PROTOCOL                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                         \u2502\n\u2502  1. Agent comments with specific concern                \u2502\n\u2502  2. Agent moves issue backward to previous stage        \u2502\n\u2502  3. Previous-stage agent picks up, reads comment        \u2502\n\u2502  4. Previous agent either:                              \u2502\n\u2502     \u251c\u2500\u25ba AGREES: fixes, marks resolved, moves forward    \u2502\n\u2502     \u2514\u2500\u25ba DISAGREES: replies, moves back to disputer      \u2502\n\u2502  5. Repeat until resolution                             \u2502\n\u2502  6. After N rounds (3?): auto-flag for human            \u2502\n\u2502                                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Circuit Breaker",
      "content": "### Circuit Breaker\n\nPrevent infinite ping-pong:\n\n```yaml\nissue: 247\ndispute_rounds: 3\ndispute_agents: [dev-agent, test-architect, dev-agent, test-architect]\nstatus: needs-human-review\nflag: \"Agents disagree after 3 rounds - human decision needed\"\n```\n\n---"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Escalation: When Agents Can't Solve",
      "content": "## Escalation: When Agents Can't Solve\n\nDifferent from disputes. Escalation = \"I can't do this\" not \"I disagree with you\"."
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "The Problem",
      "content": "### The Problem\n\nIf agent A spawns agent B for escalation:\n- Does A need to stay alive?\n- A's context is wasted waiting\n- Process dependency = fragile"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "The Solution: Stateless Escalation",
      "content": "### The Solution: Stateless Escalation\n\n**The kanban item carries escalation state, not the agent.**\n\n```yaml\n# Issue 247 in kanban\nissue: 247\nstatus: ready-for-dev\nfailure_count: 3\nfailure_history:\n  - attempt: 1\n    model: glm-4\n    reason: \"Test expects 42, got 41\"\n  - attempt: 2\n    model: glm-4\n    reason: \"Same issue, tried different approach\"\n  - attempt: 3\n    model: sonnet\n    reason: \"Still failing, suspect loop boundary\"\n```"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Model Ladder",
      "content": "### Model Ladder\n\nAgent reads `failure_count`, configures itself:\n\n```python\n# Agent startup\nissue = claim_next_issue(\"ready-for-dev\")\n\nMODEL_LADDER = {\n    0: \"glm-4\",      # First try: free\n    1: \"glm-4\",      # Second try: free\n    2: \"sonnet\",     # Third try: standard\n    3: \"sonnet\",     # Fourth try: standard\n    4: \"opus\",       # Fifth try: expensive\n    5: \"opus\",       # Sixth try: expensive\n    6: None,         # Give up \u2192 escalate column\n}\n\nmodel = MODEL_LADDER.get(issue.failure_count)\n\nif model is None:\n    issue.comment(\"Failed 6 attempts across all model tiers\")\n    issue.move_to(\"needs-senior-dev\")\n    exit()\n\nself.configure(model=model)\nself.run(issue)\n```"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Escalation Flow",
      "content": "### Escalation Flow\n\n```\nISSUE 247\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nfailure_count: 0 \u2192 dev-agent (GLM) \u2192 FAIL\nfailure_count: 1 \u2192 dev-agent (GLM) \u2192 FAIL\nfailure_count: 2 \u2192 dev-agent (Sonnet) \u2192 FAIL\nfailure_count: 3 \u2192 dev-agent (Sonnet) \u2192 FAIL\nfailure_count: 4 \u2192 dev-agent (Opus) \u2192 FAIL\nfailure_count: 5 \u2192 dev-agent (Opus) \u2192 FAIL\nfailure_count: 6 \u2192 moves to \"needs-senior-dev\"\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\nSenior-dev-agent picks up (starts with Sonnet/Opus)\nIf still fails \u2192 moves to \"needs-human\"\n```"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Key Properties",
      "content": "### Key Properties\n\n| Property | How |\n|----------|-----|\n| **No process dependency** | Agent dies after each attempt |\n| **Stateless agents** | All state in kanban item |\n| **Configurable ladder** | YAML config per agent type |\n| **Audit trail** | failure_history shows all attempts |\n| **No director** | Item self-describes escalation state |"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Config: Model Ladder per Agent Type",
      "content": "### Config: Model Ladder per Agent Type\n\n```yaml\n# ~/.oi/config/escalation.yaml\n\nmodel_ladder:\n  dev-agent:\n    0-1: glm-4       # Simple stuff might work\n    2-3: sonnet      # Medium complexity\n    4-5: opus        # Hard problems\n    6+: escalate     # Give up, need help\n\n  test-architect:\n    0-1: sonnet      # Tests need reasoning\n    2-3: opus\n    4+: escalate\n\n  story-agent:\n    0-2: haiku       # Stories are simpler\n    3-4: sonnet\n    5+: escalate\n\n  qa-agent:\n    0-1: sonnet      # QA needs attention\n    2-3: opus\n    4+: escalate\n```\n\n---"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Specialist Columns (Future)",
      "content": "## Specialist Columns (Future)\n\nWhen escalating, agent can specify WHY it's stuck:\n\n```yaml\n# Issue metadata\nescalation_reason: concurrency\n# or: security, performance, architecture, unknown\n```\n\nMaps to specialist columns:\n\n| Reason | Column | Watched By |\n|--------|--------|------------|\n| concurrency | needs-concurrency-expert | concurrency-specialist |\n| security | needs-security-review | security-specialist |\n| performance | needs-perf-tuning | performance-specialist |\n| architecture | needs-arch-clarification | architect-agent (senior) |\n| unknown | needs-senior-dev | senior-dev-agent |\n\nSpecialists are just agents with:\n- Specific column watches\n- Higher default model tiers\n- Domain-specific instructions\n\n---"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Column Structure",
      "content": "## Column Structure\n\nFull kanban with escalation:\n\n```\nNORMAL FLOW:\nready \u2192 stories \u2192 arch \u2192 tests \u2192 dev \u2192 review \u2192 qa \u2192 done\n\nESCALATION COLUMNS:\nneeds-senior-dev\nneeds-concurrency-expert\nneeds-security-review\nneeds-human\n\nBACKFLOW COLUMNS:\nblocked-needs-story-clarification\nblocked-needs-arch-clarification\nblocked-needs-test-review\n\nDISPUTE COLUMNS:\ndispute-test-vs-dev\ndispute-story-vs-arch\n```\n\nOr simpler: just use tags + a single \"blocked\" column with tags indicating why.\n\n---"
    },
    {
      "source": "brainstorm\\agent-communication.md",
      "heading": "Summary",
      "content": "## Summary\n\n| Concept | Mechanism | State Location |\n|---------|-----------|----------------|\n| **Workflow** | Column moves | Kanban column |\n| **Disputes** | Comments + backflow | Artifact comments |\n| **Escalation** | failure_count + model ladder | Item metadata |\n| **Specialist help** | Escalation tags + columns | Item tags |\n| **Human escalation** | \"needs-human\" column | Kanban column |\n\nAll stateless. All via kanban + artifacts. No director needed."
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "The Performance Question",
      "content": "## The Performance Question\n\n**Initial Concern**: Are we making too many LLM calls?\n\nCurrent flow per turn:\n```\nUser Input\n    \u2193\nbuild_context() - algorithmic (assembles artifacts from JSON)\n    \u2193\nLLM Call #1 - Main conversation response\n    \u2193\nLLM Call #2 - interpret_exchange() (decides if/what artifact to create)\n    \u2193\nSave artifact, continue\n```\n\n**Observation**: 2 LLM calls per turn could seem expensive."
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "The Realization",
      "content": "### The Realization\n\n**Cost is NOT by request count - it's by token usage!**\n\n- Interpretation call is SMALL (~500 tokens)\n- But it SAVES thousands of tokens in future turns via compression\n- A 12,000 token debugging session \u2192 ~400 tokens of linked artifacts\n- The system is already cost-efficient through compression!\n\n**The interpretation call is an investment that pays for itself.**"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Current Benefits",
      "content": "### Current Benefits\n\n1. Interpretation happens AFTER showing user the response (non-blocking UX)\n2. Small token cost now\n3. Massive token savings later\n4. Maintains agentic/intelligent artifact creation"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "The Optimization Opportunity",
      "content": "## The Optimization Opportunity\n\nWhile the economics work, we can still optimize for:\n- **Speed**: Reduce latency when interpretation is obvious\n- **Cost**: Eliminate unnecessary LLM calls for clear-cut cases\n- **User control**: Let users explicitly signal intent"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Proposed Architecture: Cascading Inference",
      "content": "## Proposed Architecture: Cascading Inference\n\nFour levels of inference, escalating only when needed:\n\n```\nUser Input\n    \u2193\nLevel 1: Explicit Commands (confidence = 1.0)\n    \u2193 (if uncertain)\nLevel 2: Pattern Matching (confidence 0.7-0.95)\n    \u2193 (if uncertain)\nLevel 3: Local LLM (confidence 0.5-0.7)\n    \u2193 (if uncertain)\nLevel 4: Remote LLM (current behavior)\n    \u2193\nCreate artifact / skip\n```"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Level 1: Explicit Commands (Composable Commands)",
      "content": "### Level 1: Explicit Commands (Composable Commands)\n\n**User directly signals intent with slash commands:**\n\n```bash\n> /effort find best gaming mouse\n> /fact what's the capital of France?\n> /resolve I'll buy the Logitech G Pro\n> /event heading to lunch\n\n# Or inline\n> find best gaming mouse /effort\n> I'm tired today /event\n```\n\n**Characteristics:**\n- Confidence: 1.0 (certain)\n- Latency: ~0ms (instant)\n- Cost: $0 (no LLM call)\n- Accuracy: 100% (user explicitly declared)\n\n**Benefits:**\n- Power users get instant artifact creation\n- No ambiguity, no interpretation needed\n- Context builder knows EXACTLY what to do\n- Zero inference overhead"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Level 2: Algorithmic Pattern Matching",
      "content": "### Level 2: Algorithmic Pattern Matching\n\n**High-confidence heuristics for common patterns:**\n\n```python\n# Examples\nif re.match(r\"what('s| is)\", text, re.I):\n    \u2192 fact (confidence: 0.9)\n\nif \"find\" or \"looking for\" or \"need to\" in text:\n    \u2192 effort (confidence: 0.85)\n\nif \"I'll\" or \"I will\" or \"going to\" + has_open_effort():\n    \u2192 resolve current effort (confidence: 0.9)\n\nif casual_greeting() or social_noise():\n    \u2192 event or skip (confidence: 0.8)\n```\n\n**Characteristics:**\n- Confidence: 0.7-0.95 (high but not certain)\n- Latency: ~1ms (regex/pattern match)\n- Cost: $0 (no LLM call)\n- Accuracy: 85-95% (tunable over time)\n\n**Benefits:**\n- Catches 80%+ of common cases\n- Instant, free\n- Deterministic (no model variance)\n- Can be tuned based on telemetry"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Level 3: Local Small Model",
      "content": "### Level 3: Local Small Model\n\n**Gemma/Phi/Llama for nuanced cases:**\n\n```python\n# Run locally (CPU or GPU)\nlocal_model = load_model(\"gemma-2b-it\")\ninterpretation = local_model.infer(\n    user_msg=user_input,\n    assistant_msg=response,\n    prompt=interpret_template\n)\n```\n\n**Characteristics:**\n- Confidence: 0.5-0.7 (uncertain, needs intelligence)\n- Latency: ~100-500ms (local inference)\n- Cost: $0 (runs on user's machine)\n- Accuracy: 75-90% (small model trade-off)\n\n**Benefits:**\n- Still fast (sub-second)\n- Free (no API cost)\n- Handles nuanced cases patterns miss\n- Privacy-preserving (local inference)\n\n**Challenges:**\n- Setup complexity (model download)\n- Requires compute resources\n- Quality vs main model"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Level 4: Remote LLM (Current Behavior)",
      "content": "### Level 4: Remote LLM (Current Behavior)\n\n**Fall back to remote LLM for truly ambiguous cases:**\n\n- Confidence: <0.5 (very uncertain)\n- Latency: ~1-3s (API roundtrip)\n- Cost: ~500 tokens (~$0.001 with DeepSeek)\n- Accuracy: 95%+ (best model)\n\n**Benefits:**\n- Highest quality\n- Handles edge cases\n- Already implemented"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Phase 1: POC - Slash Commands Only",
      "content": "### Phase 1: POC - Slash Commands Only\n**Goal**: Prove composable commands work\n\n```python\n# Parse slash commands\ndef parse_command(user_input):\n    if \"/effort\" in user_input:\n        return Artifact(type=\"effort\", ...)\n    elif \"/fact\" in user_input:\n        return Artifact(type=\"fact\", ...)\n    elif \"/resolve\" in user_input:\n        return resolve_current_effort(...)\n    else:\n        return None  # Fall through to remote LLM\n```\n\n**Features:**\n- Simple string parsing\n- Standard slash command syntax (`/effort`, `/fact`, `/resolve`, `/event`)\n- Falls back to current remote LLM interpretation if no command\n- No pattern matching, no local model yet\n\n**Success Metrics:**\n- Commands work correctly\n- Users find them natural\n- Telemetry shows usage patterns"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Phase 2: Pattern Matching",
      "content": "### Phase 2: Pattern Matching\n**Goal**: Reduce remote LLM calls by 60-80%\n\n```python\ndef pattern_match(user_input, assistant_response):\n    confidence, artifact_type = apply_patterns(...)\n    if confidence >= 0.7:\n        return create_artifact(artifact_type, ...)\n    return None  # Escalate\n```\n\n**Features:**\n- Regex-based pattern detection\n- Tunable confidence thresholds\n- Telemetry to measure accuracy\n- Fallback to remote LLM"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Phase 3: Local Model",
      "content": "### Phase 3: Local Model\n**Goal**: Handle nuanced cases without API calls\n\n```python\nclass LocalInterpreter:\n    def __init__(self, model_name=\"gemma-2b-it\"):\n        self.model = load_local_model(model_name)\n\n    def infer(self, user_msg, assistant_msg):\n        # Local inference with interpret.md prompt\n        return self.model.generate(...)\n```\n\n**Features:**\n- Optional (flag-gated)\n- Multiple model options (Gemma, Phi, Llama)\n- Confidence scoring\n- Graceful fallback if model unavailable"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Phase 4: Telemetry & Tuning",
      "content": "### Phase 4: Telemetry & Tuning\n**Goal**: Optimize thresholds based on real usage\n\n```python\n# Track which level was used and accuracy\ntelemetry.log(\n    level_used=\"pattern_match\",\n    confidence=0.85,\n    artifact_created=True,\n    user_corrected=False\n)\n\n# Periodically tune thresholds\nanalyze_telemetry() \u2192 adjust_confidence_thresholds()\n```"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Cascade Decision Logic",
      "content": "## Cascade Decision Logic\n\n```python\nclass CascadingInference:\n    def interpret(self, user_input, assistant_response, state):\n        # Level 1: Explicit commands\n        if artifact := parse_command(user_input):\n            telemetry.log(\"level_1_command\")\n            return artifact\n\n        # Level 2: Pattern matching\n        confidence, artifact = pattern_match(user_input, assistant_response, state)\n        if confidence >= 0.7:\n            telemetry.log(\"level_2_pattern\", confidence=confidence)\n            return artifact\n\n        # Level 3: Local model (if available)\n        if self.local_model:\n            confidence, artifact = self.local_model.infer(user_input, assistant_response)\n            if confidence >= 0.5:\n                telemetry.log(\"level_3_local\", confidence=confidence)\n                return artifact\n\n        # Level 4: Remote LLM\n        telemetry.log(\"level_4_remote\")\n        return remote_llm_interpret(user_input, assistant_response)\n```"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Command Syntax Options Considered",
      "content": "## Command Syntax Options Considered\n\n| Syntax | Example | Pros | Cons |\n|--------|---------|------|------|\n| **Slash (chosen)** | `/effort find mouse` | Standard, familiar | Prefix-only |\n| Brackets | `find mouse [effort]` | Works anywhere | Less standard |\n| @ Symbol | `@effort find mouse` | Clean, mentions-like | Can conflict with usernames |\n| Natural | `remember this as fact` | Most natural | Ambiguous, needs parsing |\n\n**Decision**: Start with **slash commands** (standard, familiar from Discord/Slack/CLI)."
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Confidence Thresholds",
      "content": "## Confidence Thresholds\n\nInitial values (to be tuned):\n\n| Level | Min Confidence | Typical Latency | Cost |\n|-------|---------------|-----------------|------|\n| Command | 1.0 | ~0ms | $0 |\n| Pattern | 0.7 | ~1ms | $0 |\n| Local | 0.5 | ~200ms | $0 |\n| Remote | 0.0 | ~2s | ~$0.001 |"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Success Metrics",
      "content": "## Success Metrics\n\n**Efficiency:**\n- % of turns handled without remote LLM\n- Average latency per interpretation\n- Cost per 100 turns\n\n**Accuracy:**\n- Artifact creation accuracy by level\n- User correction rate (did they need to manually fix?)\n- False negative rate (missed artifacts)\n\n**Adoption:**\n- % of users using slash commands\n- Most common commands\n- Command usage over time"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "1. Command Discoverability",
      "content": "### 1. Command Discoverability\n- How do users learn about commands?\n- Auto-suggest when system detects intent?\n- Help text / command palette?"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "2. Command Conflicts",
      "content": "### 2. Command Conflicts\n- What if user types `/effort` in natural text?\n- Escape sequence for literal slash?\n- Only parse commands at start of message?"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "3. Partial Commands",
      "content": "### 3. Partial Commands\n- Allow `/e` for `/effort`?\n- Tab completion?\n- Fuzzy matching?"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "4. State-Aware Commands",
      "content": "### 4. State-Aware Commands\n- `/resolve` - should auto-resolve most recent open effort?\n- `/continue` - reopen last resolved effort?\n- `/tag debugging` - tag current or last artifact?"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "5. Confidence Calibration",
      "content": "### 5. Confidence Calibration\n- How to measure real accuracy?\n- User feedback mechanism?\n- A/B testing thresholds?"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "6. Local Model Selection",
      "content": "### 6. Local Model Selection\n- Which model is best trade-off? (Gemma 2B vs Phi-2 vs Llama 3B)\n- Quantization? (4-bit vs 8-bit vs full)\n- CPU vs GPU? (accessibility vs speed)"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Related Work",
      "content": "## Related Work\n\n- **Command-based systems**: Slack, Discord, IRC bots\n- **Intent classification**: Rasa, DialogFlow, LLM function calling\n- **Cascading inference**: LLM routing, model cascades in production\n- **Local-first AI**: Ollama, LM Studio, GPT4All"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Next Steps",
      "content": "## Next Steps\n\n1. **Implement Phase 1 (POC)**:\n   - Add command parsing to `interpret.py`\n   - Support `/effort`, `/fact`, `/resolve`, `/event`\n   - Wire into `conversation.py`\n\n2. **Document in slice**:\n   - Create slice spec for cascading inference\n   - User stories for command usage\n   - Scenarios for each level\n\n3. **Prototype pattern matching**:\n   - Research common patterns in test scenarios\n   - Build pattern library\n   - Measure baseline accuracy\n\n4. **Research local models**:\n   - Benchmark Gemma 2B, Phi-2, Llama 3B\n   - Test interpretation quality\n   - Measure latency on various hardware"
    },
    {
      "source": "brainstorm\\cascading-inference.md",
      "heading": "Key Insights",
      "content": "## Key Insights\n\n> **The system already optimizes for token economics through compression.**\n> The interpretation call is a small investment that pays massive dividends.\n\n> **Composable commands give users direct control over the knowledge network.**\n> Explicit intent eliminates ambiguity and interpretation overhead entirely.\n\n> **Cascading inference optimizes for the common case.**\n> Most interpretations are obvious - save the intelligence for when it's needed.\n\n> **Four levels balance speed, cost, accuracy, and user control.**\n> Each level handles what it's best at, escalating only when uncertain.\n\n---\n\n*Brainstormed: 2026-01-13*\n*Status: Phase 1 (POC) - Slash commands only*\n*Next: Implement command parsing, then document in slice spec*"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Core Realization: Chats Compact to Artifact References",
      "content": "## Core Realization: Chats Compact to Artifact References\n\nA chat, when compacted, is essentially:\n- **Pointers to artifacts** (the concluded knowledge)\n- **Recent raw turns** (the active working memory)\n\n```\nCHAT \u2500\u2500compaction\u2500\u2500\u25ba ARTIFACTS\n                         \u2502\n                         \u25bc\n              Artifacts are the real knowledge\n              Chat was just the process that created them\n```\n\nThis means:\n- **Artifacts** = first-class knowledge (persistent)\n- **Chat** = ephemeral process that produces artifacts\n- **Context** = relevant artifacts + current conversation\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "The Two-Log Model",
      "content": "## The Two-Log Model\n\nEvery chat maintains two logs:"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Raw Log",
      "content": "### Raw Log\n- Full verbatim conversation\n- Append-only, never modified\n- For audit, history, expand-on-demand"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Summary Log (Manifest)",
      "content": "### Summary Log (Manifest)\n- Structured overview of what happened\n- Links to artifacts produced\n- Links to raw log sections\n- What gets loaded into context\n\n```\nRAW LOG                          SUMMARY LOG (manifest)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nFull verbatim conversation       Structured overview\n\u2502                                \u2502\n\u251c\u2500 turn 1: \"Hi!\"                 \u251c\u2500 segment 1: greeting\n\u251c\u2500 turn 2: \"Hello...\"            \u2502   summary: \"Exchanged greetings\"\n\u251c\u2500 turn 3: \"Auth bug...\"         \u2502   raw_ref: lines 1-4\n\u251c\u2500 turn 4: \"Check token...\"      \u2502   artifacts: []\n\u251c\u2500 turn 5: \"That fixed it!\"      \u2502\n\u251c\u2500 ...                           \u251c\u2500 segment 2: effort\n\u2502                                \u2502   summary: \"Debugged auth bug\"\n\u2502                                \u2502   raw_ref: lines 5-42\n\u2502                                \u2502   artifacts: [effort:456]\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Storage Structure",
      "content": "### Storage Structure\n\n```\n~/.oi/chats/chat-123/\n\u251c\u2500\u2500 manifest.yaml      # Summary log\n\u2514\u2500\u2500 raw.jsonl          # Full verbatim\n\n~/.oi/artifacts/\n\u251c\u2500\u2500 effort-456.yaml    # Referenced by manifest\n\u2514\u2500\u2500 ...\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Manifest Format",
      "content": "### Manifest Format\n\n```yaml\nchat_id: \"123\"\nstarted: \"2024-01-17T10:00:00\"\neffort_weight: medium\nstatus: active\n\nsegments:\n  - id: seg_1\n    type: greeting\n    summary: \"User greeted, started session\"\n    raw_lines: [1, 4]\n    artifacts: []\n    tokens_raw: 45\n\n  - id: seg_2\n    type: effort\n    summary: \"Debugged 401 auth error - token was expired\"\n    raw_lines: [5, 42]\n    artifacts: [\"effort:456\"]\n    tokens_raw: 1247\n    tokens_summary: 23\n\n  - id: seg_3\n    type: calculation\n    summary: \"Calculated token savings\"\n    raw_lines: [43, 48]\n    artifacts: []\n    tokens_raw: 89\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Segment Types",
      "content": "### Segment Types\n\n| Type | Produces Artifact? | Example |\n|------|-------------------|---------|\n| **effort** | Yes - effort artifact | Debugging, problem-solving |\n| **fact** | Yes - fact artifact | \"I prefer dark mode\" |\n| **event** | Yes - event artifact | \"Meeting scheduled for Tuesday\" |\n| **greeting** | No | \"Hi\", \"Thanks\" |\n| **calculation** | No | \"What's 15% of 200?\" |\n| **clarification** | No | \"What did you mean by X?\" |\n| **meta** | No | \"Let's change topic\" |\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Option A: Chat Log as Context",
      "content": "### Option A: Chat Log as Context\n\n```\nPROMPT = system + chat_history (compacted) + user_message\n```\n\n| Pros | Cons |\n|------|------|\n| Conversational continuity | Context grows over time |\n| AI remembers everything said | Old irrelevant stuff lingers |\n| Natural flow | Can't pull from other chats |\n| Simple mental model | Siloed knowledge |\n\n**Best for**: Deep focused work, debugging sessions"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Option B: Build Context Per Prompt (RAG)",
      "content": "### Option B: Build Context Per Prompt (RAG)\n\n```\nPROMPT = system + RAG(user_message) + recent_messages + user_message\n```\n\n| Pros | Cons |\n|------|------|\n| Always relevant context | May lose conversational nuance |\n| Can pull from ANY chat/artifact | More processing per prompt |\n| Cross-chat knowledge | Less continuity |\n| Never grows stale | Harder to debug \"why did it know X?\" |\n\n**Best for**: Research, exploration, cross-topic work"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Option C: Hybrid",
      "content": "### Option C: Hybrid\n\n```\nPROMPT = system + chat_summary + RAG(user_message) + recent_messages + user_message\n```\n\n| Pros | Cons |\n|------|------|\n| Best of both worlds | More complex |\n| Continuity + cross-pollination | Larger prompts |\n| Natural merge suggestions | Need to balance sources |\n\n**Best for**: Long-running projects, general use\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Effort Weight Controls Context Budget",
      "content": "## Effort Weight Controls Context Budget\n\n**Effort Weight** is the master dial:\n\n```\nEFFORT WEIGHT (low/medium/high)\n       \u2502\n       \u251c\u2500\u2500\u25ba Context Budget (how much context to use)\n       \u2502\n       \u251c\u2500\u2500\u25ba Compact Threshold (when to start compacting)\n       \u2502\n       \u251c\u2500\u2500\u25ba Focus Constraint (locked vs flexible)\n       \u2502\n       \u2514\u2500\u2500\u25ba Starting Model Tier (cheap vs expensive)\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Context Building by Weight",
      "content": "### Context Building by Weight\n\n```\nLOW WEIGHT (cheap):\n  - Use summary log only\n  - Pull minimal artifact refs\n  - last 2-3 raw messages only\n\nMEDIUM WEIGHT (balanced):\n  - Use summaries + artifact content\n  - last 5-10 raw messages\n  - Some RAG retrieval\n\nHIGH WEIGHT (quality):\n  - Use summaries + expanded raw sections\n  - Full artifact content\n  - Extensive RAG retrieval\n  - Keep as much raw as possible until threshold\n```\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Chat Merging",
      "content": "## Chat Merging\n\nWhen separate chats converge on same topic:"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Manual Merge",
      "content": "### Manual Merge\n\n```\nUser: /merge @chat-auth-bug @chat-token-issues\n\nAI: Analyzing chats...\n    - chat-auth-bug: 3 conclusions about token handling\n    - chat-token-issues: 2 conclusions about refresh logic\n    - Overlap detected: Both discuss JWT expiration\n\n    Creating merged chat with combined context:\n    [effort:merged] Token authentication issues\n      Sources: chat-auth-bug, chat-token-issues\n      Combined artifacts: 5\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Auto-Suggested Merge",
      "content": "### Auto-Suggested Merge\n\nWith RAG, system notices overlap:\n\n```\n[RAG found related content]\nYour other chat \"chat-token-issues\" has conclusions about\nJWT refresh that seem relevant here.\n\n\u2192 Reference it: /include @chat-token-issues\n\u2192 Merge chats: /merge @chat-token-issues\n\u2192 Ignore: (continue without)\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Why Merging is Simpler Than Expected",
      "content": "### Why Merging is Simpler Than Expected\n\nSince chats compact to artifact references:\n- \"Merging\" = combining artifact refs + summaries\n- Not merging huge chat logs\n- Artifacts are already deduplicated in the pool\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "The Need for Conclusion",
      "content": "### The Need for Conclusion\n\n```\nOPEN LOOPS = COGNITIVE BURDEN\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nToo many open things \u2192 scattered focus \u2192 mistakes \u2192 less productive\n\nCLOSED LOOPS = PROGRESS\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nConclude \u2192 release mental resources \u2192 focus on next \u2192 productive\n```\n\nThis is the **Zeigarnik effect**: incomplete tasks occupy mental resources until closed."
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "The Three-Part Awareness",
      "content": "### The Three-Part Awareness\n\nHumans always want to know:\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                             \u2502\n\u2502   WHERE WE CAME FROM      WHERE WE ARE       WHERE WE'RE    \u2502\n\u2502   (concluded efforts)     (current focus)    GOING          \u2502\n\u2502                                              (next steps)   \u2502\n\u2502   \u2713 Fixed auth bug        \u2192 Optimizing DB    \u2192 Deploy       \u2502\n\u2502   \u2713 Wrote tests             queries          \u2192 QA           \u2502\n\u2502   \u2713 Designed schema                          \u2192 Docs         \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\nThis is **temporal grounding** - we need to locate ourselves in the flow of work."
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Artifacts as Cognitive Relief",
      "content": "### Artifacts as Cognitive Relief\n\nEach concluded artifact:\n- **Releases mental load** - it's done, move on\n- **Provides visible progress** - I accomplished something\n- **Creates a \"save point\"** - can return if needed\n- **Allows fresh focus** - clear space for next thing\n\n**Key insight**: Artifacts aren't just for AI context management - they're for human cognitive ergonomics."
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Visibility Requirements",
      "content": "### Visibility Requirements\n\nThe system should always show:\n\n| Past | Present | Future |\n|------|---------|--------|\n| Concluded efforts | Current effort | Suggested next |\n| \u2713 checkmarks | \u2192 arrow/highlight | ? or bullet |\n| Collapsed by default | Expanded | Optional |\n\n```\nSESSION STATE:\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\u2713 Debug auth bug \u2192 token refresh\n\u2713 Optimize DB \u2192 added index\n\u2192 [CURRENT] Deploy to staging\n  \u2022 Run smoke tests\n  \u2022 Update docs\n```\n\nThis is a **progress bar for knowledge work**.\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "The Problem with Current Systems",
      "content": "### The Problem with Current Systems\n\n```\nCURRENT (Claude Code, etc):\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nChat goes on... context fills...\n\nUser: \"Wait, did we capture everything important?\"\nAI: \"Let me summarize...\" (but context is almost full)\n\n[Session ends]\n\nNext session: Raw log exists but NEVER referenced\n             Knowledge effectively lost\n```\n\nRaw chat logs become orphaned files. Nothing points to them. Knowledge is lost unless manually extracted."
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "The Solution: Capture Continuously",
      "content": "### The Solution: Capture Continuously\n\nDon't wait until the end. Capture with every response:\n\n```\nEVERY RESPONSE:\n  1. Generate response\n  2. Append to raw log\n  3. Update manifest with summary of this exchange\n  4. If conclusion detected \u2192 create artifact, link in manifest\n\nRESULT:\n  - Raw log: full detail (audit/expand)\n  - Manifest: always current summary + artifact links\n  - Artifacts: concluded knowledge\n  - Nothing depends on \"remembering to capture\"\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Two Levels of Capture",
      "content": "### Two Levels of Capture\n\n| Level | When | What |\n|-------|------|------|\n| **Summary** | Every response (or every N turns) | Condensed version of exchange |\n| **Artifact** | On conclusion detection | Structured, cross-referenceable knowledge |\n\nSummaries are lightweight - just enough to reconstruct what happened.\nArtifacts are structured - queryable, linkable, first-class knowledge."
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "The Continuous Capture Loop",
      "content": "### The Continuous Capture Loop\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                     \u2502\n\u2502   User message                                      \u2502\n\u2502        \u2193                                            \u2502\n\u2502   AI response                                       \u2502\n\u2502        \u2193                                            \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510      \u2502\n\u2502   \u2502 CAPTURE STEP (automatic, every turn)    \u2502      \u2502\n\u2502   \u2502                                         \u2502      \u2502\n\u2502   \u2502 1. Append to raw log                    \u2502      \u2502\n\u2502   \u2502 2. Summarize this exchange              \u2502      \u2502\n\u2502   \u2502 3. Update manifest                      \u2502      \u2502\n\u2502   \u2502 4. Conclusion? \u2192 Create artifact        \u2502      \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518      \u2502\n\u2502        \u2193                                            \u2502\n\u2502   Ready for next turn                               \u2502\n\u2502   (manifest always reflects current state)          \u2502\n\u2502                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Comparison",
      "content": "### Comparison\n\n| Current Systems | Continuous Capture |\n|-----------------|-------------------|\n| Capture is manual/end-of-session | Capture every response |\n| Raw logs orphaned, never referenced | Raw logs linked via manifest |\n| \"Did we get everything?\" anxiety | Always captured |\n| Knowledge loss on session end | Knowledge preserved organically |\n| Context limit = panic point | Context limit = non-event |"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Key Insight",
      "content": "### Key Insight\n\nThe manifest is always up-to-date. At any point:\n- You can end the session - nothing lost\n- You can continue - full context available via manifest\n- Future sessions can reference - manifest links to artifacts and raw\n\n**No \"remember to save\" step. No end-of-session scramble. Continuous, automatic, organic.**\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Design Principles (from this analysis)",
      "content": "## Design Principles (from this analysis)\n\n1. **Artifacts are primary, chats are process** - Knowledge lives in artifacts, not chat logs\n\n2. **Two logs serve different needs** - Raw for audit/detail, summary for navigation/context\n\n3. **Effort weight controls everything** - One dial for budget, compaction, focus, model tier\n\n4. **Mirror human cognition** - Support natural conclusion cadence, provide temporal grounding\n\n5. **Visible progress always** - Show past/present/future, concluded/active/next\n\n6. **Merging is just combining refs** - Chats compact to artifact pointers, merging is trivial\n\n---"
    },
    {
      "source": "brainstorm\\context-and-cognition.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n\n- [ ] How to detect segment boundaries automatically?\n- [ ] When does RAG retrieval happen (every prompt vs on-demand)?\n- [ ] How to present \"suggested next\" without being annoying?\n- [ ] Should merged chats maintain link to originals?"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Started With",
      "content": "### Started With\n- **Threads** = conversations\n- **Conclusions** = extracted knowledge\n- **History** = chronological log of threads"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Problem Discovered",
      "content": "### Problem Discovered\nScenario 4: User says \"I'm thinking about adding multiplayer\", session ends without resolution. Next day: \"Okay I decided - let's do co-op\".\n\n**Problem**: No conclusion exists for open/unresolved work. The AI wouldn't know about the pending decision."
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "New Model: Efforts + Conclusions",
      "content": "### New Model: Efforts + Conclusions\n\n**Effort** = what we're trying to accomplish\n- Can be **open** (in progress) or **resolved**\n- Can have **child efforts** (hierarchical)\n- Tracks the journey, not just the outcome\n- Has metadata: tokens spent, time, sessions\n\n**Conclusion** = resolution of an effort\n- Tied to parent effort\n- Multiple possible (failed attempts + final success)\n\n```\nEffort: \"Fix player collision bug\" (3 days, 50k tokens)\n\u251c\u2500\u2500 Effort: \"Try increasing collider size\"\n\u2502   \u2514\u2500\u2500 Conclusion: \"Failed - still falls through on slopes\"\n\u251c\u2500\u2500 Effort: \"Try ground check raycast\"\n\u2502   \u2514\u2500\u2500 Conclusion: \"Works! Added raycast before movement\"\n\u2514\u2500\u2500 Conclusion: \"Fixed using ground check raycast\"\n\nEffort: \"Add multiplayer mode\" [OPEN - no conclusion yet]\n\u2514\u2500\u2500 (waiting for user decision on co-op vs competitive)\n```"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "\u2713 Works Well",
      "content": "### \u2713 Works Well\n\n| Scenario | Why It Works |\n|----------|--------------|\n| Recency: \"Where did we leave off?\" | Scan recent efforts (open + closed) |\n| Fresh start: \"New idea\" | Past conclusions provide project context |\n| Search: \"That bug we fixed?\" | Search efforts/conclusions |\n| Learning: \"Explain X to me\" | Learning IS an effort with resolution |\n| Creative: \"Write a story\" | Iterative child efforts |\n| Planning: \"Plan trip to Japan\" | Hierarchical efforts |"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "? Uncertain",
      "content": "### ? Uncertain\n\n| Scenario | Issue |\n|----------|-------|\n| Simple Q&A: \"Capital of France?\" | Works but feels heavyweight - is this really an \"effort\"? |"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "\u2717 Doesn't Fit",
      "content": "### \u2717 Doesn't Fit\n\n| Scenario | Issue |\n|----------|-------|\n| Casual chat: \"How's it going?\" | No goal, no resolution, just social exchange |"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n\n1. **Is everything an effort?**\n   - Simple Q&A works but feels like overkill\n   - Casual chat has no goal - not an effort?\n   - Maybe: efforts vs exchanges (lightweight non-goal interactions)?\n\n2. **Effort types/weights?**\n   - Maybe efforts have types: `project`, `question`, `learning`, `planning`\n   - Or weights: `major`, `minor`, `trivial`\n\n3. **What about casual chat?**\n   - Not everything has a goal\n   - Still want to remember \"user mentioned they were tired\"?\n   - Or just discard social noise?\n\n4. **How does AI build context?**\n   - Scan recent efforts (summaries)\n   - See open efforts = pending work\n   - See closed efforts = completed work with conclusions\n   - Drill into child efforts or raw thread if needed\n\n5. **Data structure?**\n   ```\n   Effort:\n     id\n     summary (always present - the \"what\")\n     status: open | resolved\n     parent_effort_id (nullable - for hierarchy)\n     conclusion_ids[] (can have multiple)\n     thread_id (raw conversation if needed)\n     metadata: {tokens, sessions, created, updated}\n\n   Conclusion:\n     id\n     content (the knowledge/resolution)\n     effort_id\n     created\n   ```"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Next Steps",
      "content": "## Next Steps\n\n- Decide: Is casual chat an effort, a different type, or discarded?\n- Decide: Are simple Q&As lightweight efforts or something else?\n- Once model is solid, update schema and code"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Key Insight (v1)",
      "content": "## Key Insight (v1)\n\n> The network is **efforts linked to efforts**, with conclusions as leaves.\n> Open efforts = pending work. Closed efforts = resolved work.\n> This captures the journey, not just the outcomes.\n\n---"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "The Realization",
      "content": "### The Realization\n\nEffort/Conclusion is just ONE artifact type - not THE model.\n\nThe chat log is the **raw artifact**. Everything else is a **learned compression format**.\n\n```\nChat Log (raw)\n    \u2193\n[Artifact Type A: Effort/Conclusion] - for goal-oriented work\n[Artifact Type B: ???] - for casual exchanges\n[Artifact Type C: ???] - for learning journeys\n[Artifact Type D: ???] - user-specific, emerges from usage\n    \u2193\n[Higher-order artifacts] - patterns across artifacts\n```"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Core Ideas",
      "content": "### Core Ideas\n\n1. **Multiple compression formats** - Different \"lenses\" on the same conversation\n2. **Self-evolving schemas** - System learns what formats work for THIS user\n3. **Human-readable neural network** - Emergent structure that's still inspectable/auditable\n4. **Contractual by review** - User can see and correct what it learned"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "The System Learns HOW to Store Knowledge",
      "content": "### The System Learns HOW to Store Knowledge\n\nNot just WHAT to store.\n\n| User Type | Emergent Schemas |\n|-----------|-----------------|\n| Developer | `bug_fix`, `feature`, `refactor`, `architecture_decision` |\n| Researcher | `hypothesis`, `finding`, `contradiction`, `source` |\n| Writer | `draft`, `revision`, `feedback`, `character_note` |\n| Planner | `goal`, `milestone`, `blocker`, `decision` |"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Analogy to Neural Networks",
      "content": "### Analogy to Neural Networks\n\n- Neural networks learn compressed representations (embeddings)\n- But they're opaque - you can't inspect them\n- This system learns compressed representations too\n- But they're **human-readable** and **auditable**\n- Like a neural network you can review and correct"
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Thesis Evolution",
      "content": "### Thesis Evolution\n\n> The network learns both **content** AND **structure**.\n> The schemas themselves evolve based on usage patterns.\n> Compression formats are first-class, evolvable entities."
    },
    {
      "source": "brainstorm\\data-model-exploration.md",
      "heading": "Open Questions",
      "content": "### Open Questions\n\n- How does a new schema emerge? (User defines? System proposes? Hybrid?)\n- How do schemas evolve over time?\n- Can schemas be shared across users? (Community schemas?)\n- What's the \"base\" schema everything starts with?\n- How does the system know which schema to apply to a new conversation?"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "The Problem with Current Systems",
      "content": "## The Problem with Current Systems\n\n**Auto-compaction at arbitrary points** (when context fills up):\n- Loses details at random boundaries\n- Feels like a band-aid\n- Forced summary at arbitrary point misses nuance\n\n**Growing chat logs with old summaries**:\n- Old summaries may have no relevance to current work\n- Loading everything in every prompt is wasteful\n- Relevance decays but storage doesn't\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Core Insight",
      "content": "## Core Insight\n\nCompaction should happen at **meaningful boundaries** (effort completion, topic change) not arbitrary ones (context limit reached).\n\nWhen a new effort/objective is expressed by the user, that signals:\n- Previous efforts are not needed in full detail\n- If details ARE needed, they can be referenced and pulled (RAG-style)\n- Not loaded as context with every prompt\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "The Emerging Model",
      "content": "## The Emerging Model\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 CHAT                                                    \u2502\n\u2502                                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 CURRENT EFFORT (full context)                   \u2502   \u2502\n\u2502  \u2502 - All turns since effort started                \u2502   \u2502\n\u2502  \u2502 - Interactive, user can step through            \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 PREVIOUS EFFORTS (compacted)                    \u2502   \u2502\n\u2502  \u2502 - Summary list: \"Fixed auth bug \u2192 token refresh\"\u2502   \u2502\n\u2502  \u2502 - Links to raw logs if details needed           \u2502   \u2502\n\u2502  \u2502 - NOT loaded in full every prompt               \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2502                                                         \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510   \u2502\n\u2502  \u2502 ARTIFACTS (cross-chat knowledge)                \u2502   \u2502\n\u2502  \u2502 - Facts, preferences, resolved efforts          \u2502   \u2502\n\u2502  \u2502 - RAG-retrieved when relevant                   \u2502   \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Chat Management Revolution",
      "content": "## Chat Management Revolution\n\n**Problem**: Users hate managing chat lists (searching, archiving, renaming, deleting)\n\n**Solution**: AI handles this automatically:\n- Start new chat \u2192 AI finds relevant old context/artifacts\n- No need to search for old chats manually\n- Chat logs still exist (composed of summaries) for manual search if wanted\n\n**Two files per chat**:\n1. **Chat log** = summarized artifact of the conversation (what was done, current state)\n2. **Artifacts** = extracted knowledge (facts, resolutions, cross-referenceable)\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Topic Change Handling",
      "content": "## Topic Change Handling\n\nNot all topic changes are equal:\n\n| Type | Example | Action |\n|------|---------|--------|\n| **Unrelated** | bug \u2192 coffee | AI suggests: \"New chat?\" (no context) |\n| **Related** | bug \u2192 related feature | AI suggests: \"Fork?\" (copy context) |\n| **Resolution** | bug \u2192 \"thanks, fixed\" | Compact effort, stay in chat |\n\nKey principle: Each chat sticks to a **coherent subject**. AI helps enforce this by suggesting new/fork when appropriate.\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Agents in This Model",
      "content": "## Agents in This Model\n\n**Current subagent pattern**:\n- Benefit = separate context window\n- Main agent spawns subagent with summary + instructions\n- Subagent works autonomously, returns summary\n\n**In effort-scoped model**:\n- Context is always naturally compacted, separate window not needed\n- Main agent does work with full context, then compacts\n- User can interact step-by-step (vs autonomous subagent)\n\n**Key difference**: Interactive work vs autonomous execution\n\n**Open question**: Is full context beneficial for the work, or is a focused summary better? (Subagent gets summary, effort-agent gets full context)\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Comparison with Current Systems",
      "content": "## Comparison with Current Systems\n\n| Current Systems | Effort-Scoped Model |\n|-----------------|---------------------|\n| Compaction when context fills | Compaction when effort completes |\n| Arbitrary boundary, loses detail | Meaningful boundary, captures resolution |\n| Growing context until forced cut | Bounded effort context + summary history |\n| Subagents for separate context | Same agent, effort-scoped focus |\n| Subagents run autonomously | Interactive, user steps through |\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Two Main Goals (Early Slices)",
      "content": "## Two Main Goals (Early Slices)\n\n1. **No chat management burden** - AI handles finding/organizing\n2. **No forced auto-compaction** - natural compaction at effort boundaries means never hitting context limit\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "New Thought: Constraint as Feature",
      "content": "## New Thought: Constraint as Feature\n\n> \"Maybe there is a lack of rules beyond utility... maybe some constriction would be beneficial.\"\n\n**Idea**: One chat = one effort\n\nOr more precisely:\n- A chat **spawns** an effort\n- An \"effort chat\" is **locked to a single effort**\n- Child efforts allowed, but must contribute to parent effort\n- Enforces focus, simplifies compaction boundaries\n\n```\nEFFORT CHAT\n\u251c\u2500\u2500 Main Effort: \"Build authentication system\"\n\u2502   \u251c\u2500\u2500 Child Effort: \"Research OAuth libraries\"\n\u2502   \u251c\u2500\u2500 Child Effort: \"Implement login endpoint\"\n\u2502   \u2514\u2500\u2500 Child Effort: \"Debug token refresh bug\"\n\u2502\n\u2502   All child efforts MUST contribute to parent\n\u2502   Unrelated topics \u2192 AI suggests new chat\n```\n\n**Benefits of constraint**:\n- Clear compaction boundaries (chat ends when effort resolves)\n- No ambiguity about what context is relevant\n- Forces user to articulate what they're trying to accomplish\n- Child efforts = natural decomposition, all roll up to parent\n\n**Open question**: Is this too restrictive? Does it hurt flexibility?\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Implications for Slice 1",
      "content": "## Implications for Slice 1\n\nIf we adopt \"one chat = one effort\":\n- No need for \"open/resolved\" artifact state tracking\n- Chat itself IS the effort state\n- Resolution = chat completion (or ready for compaction)\n- The \"two artifacts\" bug goes away - chat produces one artifact on completion\n\n---\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Context Strategy: Lazy Compaction",
      "content": "## Context Strategy: Lazy Compaction\n\n**Old assumption**: Compact early and often to stay small\n**New assumption**: Stay large as long as possible, compact only when needed\n\n**Why more context is better**:\n- Better model understanding and performance\n- Raw details preserved (no premature summarization loss)\n- No risk of losing something important early\n\n**The strategy**:\n\n```\n0%\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u250070%\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u250090%\u2500\u2500\u2500\u2500100%\n\u2502                      \u2502          \u2502       \u2502\n\u2502  RAW CONTEXT         \u2502 COMPACT  \u2502 DANGER\u2502 LIMIT\n\u2502  (keep granular)     \u2502 ZONE     \u2502       \u2502\n\u2502                      \u2502          \u2502       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n                       \u2191\n                    Start selective compaction here\n```\n\n**Selective compaction order** (when needed):\n1. First: Drop low-relevance turns (vector filtered - greetings, filler)\n2. Then: Summarize oldest exchanges (preserve recent detail)\n3. Last resort: Aggressive summarization\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Effort Weight: Quality vs Cost Tradeoff",
      "content": "## Effort Weight: Quality vs Cost Tradeoff\n\nMore context = better results but more expensive. Need a dial.\n\n**Effort Weight** (or \"context budget\"):\n\n```\nEFFORT WEIGHT: low \u25c4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba high\n               \u2502                        \u2502\nCONTEXT:       minimal                  maximal (90%)\nCOST:          cheap                    expensive\nCOMPACTION:    aggressive, early        lazy, late\nUSE CASE:      casual learning          critical dev work\n```\n\n**Examples**:\n\n| Effort Type | Weight | Context Strategy |\n|-------------|--------|------------------|\n| \"Tell me about WW2\" | low | Compact aggressively, keep it cheap |\n| \"Debug prod outage\" | high | Max context, preserve every detail |\n| \"Plan vacation\" | medium | Balanced |\n| \"Refactor auth system\" | high | Full context, no shortcuts |\n\n**How weight is set**:\n1. **User explicit**: `/weight high` or `--priority critical`\n2. **Inferred from keywords**: \"production\", \"urgent\", \"debug\" \u2192 high\n3. **Effort type defaults**: dev work \u2192 high, general questions \u2192 low\n4. **Global user preference**: \"I'm a cheapskate\" vs \"quality over cost\"\n\n**The formula**:\n```\ncontext_budget = base_limit * effort_weight\ncompact_threshold = context_budget * 0.7\n\nif current_context > compact_threshold:\n    compact(strategy=weight_based)\n```\n\n**Ties into \"one chat = one effort\"**: Weight set once for the chat, governs entire context strategy.\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Focus Constraint: Tied to Effort Weight",
      "content": "## Focus Constraint: Tied to Effort Weight\n\nThe \"one chat = one effort\" constraint isn't binary - it's a spectrum tied to effort weight.\n\n**The spectrum**:\n\n```\nFLEXIBLE                                              LOCKED\n(current systems)                               (one effort = one chat)\n     \u2502                                                    \u2502\n     \u2502  casual learning    planning    dev work   prod bug\u2502\n     \u2502       \u2190\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  \u2502\n     \u2502                                                    \u2502\n   \"tell me about WW2\"                    \"fix auth bug\"  \u2502\n   topic drift OK                         deviation = warning\n```\n\n**Constraint level by weight**:\n\n| Weight | Constraint | Behavior on Deviation |\n|--------|------------|----------------------|\n| **low** | flexible | AI follows along, maybe gentle \"this seems different\" |\n| **medium** | soft | AI notes deviation, asks \"new chat or continue?\" |\n| **high** | locked | AI enforces: \"This deviates from [effort]. New chat?\" |\n\n**Example enforcement (high weight dev effort)**:\n```\nYou: \"Actually, what's a good recipe for pasta?\"\n\nAgent: \"\u26a0\ufe0f This deviates from current effort: Fix auth bug\n        \u2192 Start new chat for pasta question?\n        \u2192 Or mark auth effort as paused/abandoned?\"\n```\n\n**Default weights by effort type**:\n\n| Effort Type | Default Weight | Default Constraint |\n|-------------|----------------|-------------------|\n| Dev work | high | locked |\n| Bug fix | high | locked |\n| Code review | high | locked |\n| Planning | medium | soft |\n| Research | low | flexible |\n| Learning | low | flexible |\n| Casual chat | low | flexible |\n\n**User overrides**:\n- `/lock` - enforce constraint regardless of weight\n- `/unlock` - allow flexibility regardless of weight\n- `/weight high|medium|low` - change weight (and thus constraint)\n\n**Benefits of enforcement for dev work**:\n- Keeps you focused (rubber duck effect)\n- Prevents context pollution with irrelevant tangents\n- Clean git history (one effort = one branch)\n- Token budget stays on-task\n- Forces explicit decisions about context switching\n\n**When flexibility helps**:\n- Learning/research (rabbit holes are the point)\n- Brainstorming (tangents spark ideas)\n- Casual chat (no stakes)\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Model Escalation Strategy",
      "content": "## Model Escalation Strategy\n\n**Goal**: Use cheap/free models by default, escalate to expensive models only on repeated failure.\n\n**The tier ladder**:\n```\nFREE/CHEAP          STANDARD           EXPENSIVE\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\nGLM 4 / Haiku       Sonnet             Opus\n     \u2502                  \u2502                 \u2502\n     \u2502 2 failures       \u2502 2 failures      \u2502\n     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba\u2502\n                                          \u2502\n                                    Last resort\n```\n\n**Escalation triggers**:\n- \u2705 Task fails 2+ times at current tier\n- \u2705 Complexity detected (multi-step reasoning needed)\n- \u2705 User explicitly requests higher tier\n- \u274c NOT: \"I'm not sure\" (ask user instead)\n- \u274c NOT: \"Test seems wrong\" (review with test-architect instead)\n\n**De-escalation**:\n- After success, future similar tasks start cheap again\n- Track task-type success rates per model\n- Learn which tasks need which tier\n\n**Integration with effort weight**:\n\n| Effort Weight | Starting Model | Max Escalation |\n|---------------|----------------|----------------|\n| low | free tier | Sonnet (cap) |\n| medium | free tier | Opus |\n| high | Sonnet | Opus (faster escalation) |\n| critical | Opus | Opus (start at top) |\n\n**Cost tracking**:\n- Log tokens per model tier\n- Show user: \"This effort used 80% free tier, 20% Sonnet\"\n- Highlight expensive escalations for review\n\n**Future refinement**:\n- Fine-tune cheap models on successful expensive completions\n- Build task\u2192model mapping from usage data\n- Auto-detect task complexity before starting\n\n---"
    },
    {
      "source": "brainstorm\\effort-scoped-context.md",
      "heading": "Next Steps",
      "content": "## Next Steps\n\n- Debate: Is \"one chat = one effort\" too restrictive?\n- Define: What constitutes a \"child effort\" vs unrelated topic?\n- Design: How does forking work with effort hierarchy?\n- Design: How is effort weight inferred vs explicit?\n- Prototype: Try the constrained model and see if it feels right"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "The Problem",
      "content": "## The Problem\n\nJust in one brainstorming session, we created:\n- 3+ new documents\n- Multiple edits to existing docs\n- Decisions scattered across files\n- Relationships between artifacts that aren't explicit\n\n**Result**: User says \"I have lost track of them, it's hard to access them, I often forget what we created\"\n\nThe AI assistant remembers everything (until context limit). The human doesn't.\n\n---"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "1. Artifact Inventory",
      "content": "### 1. Artifact Inventory\n\"What have we created?\"\n- List of all artifacts from this chat/effort\n- Grouped by type (brainstorm, scenario, decision, code, etc.)\n- Timestamps (when created, last modified)"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "2. Relationship Map",
      "content": "### 2. Relationship Map\n\"How do these connect?\"\n- Which artifacts reference which\n- Parent/child relationships (effort hierarchy)\n- Project associations\n- Topic clustering"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "3. Context Reinforcement",
      "content": "### 3. Context Reinforcement\n\"Why did we create this?\"\n- Brief reminder of the decision/discussion that led to artifact\n- Link back to chat log moment\n- Tags/keywords for quick scanning"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "4. Easy Navigation",
      "content": "### 4. Easy Navigation\n\"How do I find X?\"\n- Search across artifacts\n- Filter by type, project, date, effort\n- Recent artifacts prominently displayed\n- Favorites/pinned artifacts"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "5. Progress Visibility",
      "content": "### 5. Progress Visibility\n\"What's the state of things?\"\n- Open efforts and their status\n- Completed efforts and outcomes\n- Blockers/open questions\n- What's next\n\n---"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "Session Summary View",
      "content": "### Session Summary View\nAfter each session (or on demand), show:\n```\nSESSION SUMMARY\n\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\n\nCreated:\n  \ud83d\udcc4 effort-scoped-context.md (brainstorm)\n     Core model: lazy compaction, effort weight, focus constraint\n\n  \ud83d\udcc4 director-agent-scenario.md (scenario)\n     Future vision: 24/7 director with workers\n\n  \ud83d\udcc4 TODO.md (tracking)\n     8 open design threads\n\nModified:\n  \ud83d\udcdd 1a-minimal.md - updated terminology\n  \ud83d\udcdd pipeline.md - added naming convention\n\nDecisions Made:\n  \u2713 Constraint tied to effort weight (high=locked, low=flexible)\n  \u2713 Effort types have default weights\n  \u2713 User can override with /lock, /unlock\n\nOpen Questions:\n  ? How to detect effort type reliably\n  ? Child effort mechanics\n  ? Fork mechanics\n```"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "Artifact Dashboard",
      "content": "### Artifact Dashboard\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 KNOWLEDGE NETWORK - Artifact Dashboard                      \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502 RECENT                          PROJECTS                    \u2502\n\u2502 \u251c\u2500 effort-scoped-context.md     \u251c\u2500 knowledge-network/       \u2502\n\u2502 \u251c\u2500 director-scenario.md         \u2502   \u2514\u2500 28 artifacts         \u2502\n\u2502 \u2514\u2500 TODO.md                      \u2514\u2500 open-colony/             \u2502\n\u2502                                     \u2514\u2500 45 artifacts         \u2502\n\u2502 BY TYPE                                                     \u2502\n\u2502 \u251c\u2500 Brainstorms (7)              OPEN EFFORTS                \u2502\n\u2502 \u251c\u2500 Scenarios (3)                \u251c\u2500 Slice 1 redesign         \u2502\n\u2502 \u251c\u2500 Decisions (7)                \u251c\u2500 Child effort design      \u2502\n\u2502 \u251c\u2500 Slices (5)                   \u2514\u2500 Human interface design   \u2502\n\u2502 \u2514\u2500 Stories (2)                                              \u2502\n\u2502                                                             \u2502\n\u2502 [Search artifacts...]                                       \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "Relationship Graph",
      "content": "### Relationship Graph\nVisual map showing:\n- Artifacts as nodes\n- Links as edges (references, parent/child)\n- Clusters by topic/project\n- Highlight current effort's artifacts\n\n---"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "Integration with Effort Model",
      "content": "## Integration with Effort Model\n\nThe artifact view ties directly to efforts:\n\n```\nEFFORT: Design effort-scoped context model\n\u251c\u2500 ARTIFACTS CREATED\n\u2502   \u251c\u2500 effort-scoped-context.md (core doc)\n\u2502   \u251c\u2500 director-agent-scenario.md (future vision)\n\u2502   \u2514\u2500 TODO.md (tracking)\n\u2502\n\u251c\u2500 DECISIONS MADE\n\u2502   \u251c\u2500 Lazy compaction (compact late, not early)\n\u2502   \u251c\u2500 Effort weight controls cost/quality\n\u2502   \u2514\u2500 Focus constraint tied to weight\n\u2502\n\u251c\u2500 OPEN QUESTIONS\n\u2502   \u251c\u2500 Child effort mechanics\n\u2502   \u2514\u2500 Fork mechanics\n\u2502\n\u2514\u2500 RELATED EFFORTS\n    \u251c\u2500 Slice 1 design (depends on this)\n    \u2514\u2500 TDD pipeline exploration (informed this)\n```\n\nWhen an effort resolves, this becomes the artifact - not just a text summary, but a **structured record** of what was produced.\n\n---"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "Key Insight",
      "content": "## Key Insight\n\nThe system should help **both** AI and human manage context:\n\n| AI Context | Human Context |\n|------------|---------------|\n| Token limit | Cognitive limit |\n| Compaction | Summarization |\n| RAG retrieval | Search/filter |\n| Effort focus | Dashboard/inventory |\n| Artifact storage | Easy navigation |\n\n**Same problem, different interfaces.**\n\n---"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "For Slice Roadmap",
      "content": "## For Slice Roadmap\n\nThis suggests a slice focused on human interface:\n\n**Slice N: Human Context Dashboard**\n- Session summary generation\n- Artifact inventory view\n- Relationship visualization\n- Search/filter capabilities\n- Effort-artifact linking\n\nCould be a TUI (terminal UI) for CLI, or web dashboard, or both.\n\n---\n\n---"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "Visualization Layer (Future)",
      "content": "## Visualization Layer (Future)\n\nHumans are visual interpreters. Text lists aren't enough.\n\n**Primitives** (data model):\n- Artifacts with metadata\n- Relationships (links, parent/child)\n- Efforts with status\n- Tags, timestamps, projects\n\n**Views** (built on primitives):\n\n| View Type | Use Case |\n|-----------|----------|\n| **Graph** | Relationship map - nodes and edges |\n| **Tree** | Hierarchy - effort/child structure |\n| **Timeline** | Chronological - when things happened |\n| **Kanban** | Status flow - open/in-progress/done |\n| **3D Map** | Spatial clustering - topic neighborhoods |\n| **Flow chart** | Process - how work moves through pipeline |\n\n**Custom views**: Users build their own views on the primitives. Like SQL views but visual.\n\n```\nPRIMITIVES (data)          VIEWS (visual)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500          \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nartifacts      \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba graph view\nrelationships  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba tree view\nefforts        \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba kanban view\nmetadata       \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25ba custom view\n```\n\n**Later slices** - not slice 1, but foundational thinking.\n\n---"
    },
    {
      "source": "brainstorm\\human-context-management.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n\n- [ ] TUI vs web dashboard vs both?\n- [ ] How to auto-generate session summaries?\n- [ ] How to track artifact relationships automatically?\n- [ ] Integration with existing tools (Obsidian, Notion, etc.)?\n- [ ] Real-time updates vs on-demand refresh?\n- [ ] What visualization library/framework?\n- [ ] 3D mapping - Three.js? WebGL?"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Evolution of Thinking",
      "content": "## Evolution of Thinking\n\nStarted with: Sessions as first-class context containers with dashboards\n\nRefined to: **Chats + Artifacts** - simpler, closer to original thesis"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Core Model",
      "content": "## The Core Model\n\n```\nChat = series of messages (like traditional AI systems)\n      \u2193\nCompaction happens naturally as conversation progresses\n      \u2193\nArtifacts = extracted value (facts, efforts, events)\n      \u2193\nContext = artifacts + recent messages (not full history)\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Key Insight",
      "content": "### Key Insight\n\n**We're not replacing chat logs - we're augmenting them with auto-compaction.**\n\nTraditional AI systems:\n```\nChat grows \u2192 Token limit \u2192 Truncate/summarize \u2192 Information loss\n```\n\nThis system:\n```\nChat grows \u2192 Artifacts extracted \u2192 Context stays small \u2192 Nothing lost\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Terminology",
      "content": "## Terminology\n\n| Term | Definition |\n|------|------------|\n| **Chat** | Full conversation container (series of messages) |\n| **Session** | Subset of chat (work period) - future feature, not critical now |\n| **Artifact** | Extracted value from conversation (fact, effort, event) |\n| **Context** | Artifacts + recent messages (what gets sent to LLM) |\n| **Fork** | Copy chat history, continue with branched context |"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Artifacts Are the Memory",
      "content": "## The Artifacts Are the Memory\n\nRaw chat contains noise:\n- Greetings (\"hello\", \"thanks\")\n- Confirmations (\"yes\", \"okay\")\n- Back-and-forth technical discussion\n- Exploratory tangents\n\nArtifacts contain signal:\n- Decisions made\n- Facts learned\n- Goals pursued\n- Resolutions reached\n\n**Cross-reference artifacts, not raw chat.**"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Starting a New Conversation",
      "content": "## Starting a New Conversation\n\nWhen user expresses intent, the system:\n\n1. **Searches** artifacts and chats for relevance\n2. **Presents** options with context\n\n```\nUser: \"I want to work on the payment integration\"\n\nAI: I found related context:\n\nRELATED CHATS:\n  1. \"Payment Gateway Research\" (3 days ago)\n     Summary: Compared Stripe vs PayPal, decided on Stripe\n     Artifacts: 4 (2 facts, 1 resolved effort, 1 open effort)\n\n  2. \"API Design Session\" (last week)\n     Summary: Designed REST endpoints for checkout flow\n     Artifacts: 6 (3 facts, 3 resolved efforts)\n\nRELEVANT ARTIFACTS:\n  \u2022 [fact] Using Stripe API v2023-10\n  \u2022 [fact] Webhook endpoint: /api/webhooks/stripe\n  \u2022 [effort:open] Implement refund logic\n\nOptions:\n  1. Continue \"Payment Gateway Research\" (has open effort)\n  2. Fork from \"API Design Session\"\n  3. New chat with selected artifacts\n  4. Start fresh (no prior context)\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "User Response Options",
      "content": "### User Response Options\n\n```\n> 1                    \u2192 Continue existing chat\n> 2                    \u2192 Fork, maintains shared history\n> 3, include 1,2       \u2192 New chat, imports selected artifacts\n> 3, exclude 3         \u2192 New chat, imports all except specified\n> 4                    \u2192 Completely fresh start\n> just continue        \u2192 AI picks most relevant\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Forking",
      "content": "## Forking\n\nFork = copy chat history, continue with branched context\n\n```\nOriginal Chat A (messages 1-50, artifacts 1-5)\n       \u2502\n    [Fork at current point]\n       \u2502\n       \u251c\u2500\u2500 Chat A continues (messages 51+, artifacts 6+)\n       \u2502\n       \u2514\u2500\u2500 Chat B (forked)\n             New messages, new artifacts\n             Shares history with A up to fork point\n```\n\nLike git branches for conversations."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Cross-Referencing Knowledge",
      "content": "## Cross-Referencing Knowledge\n\nArtifacts are portable across chats:\n\n```\nChat A: \"Payment research\"\n  \u2192 [fact] Using Stripe API\n  \u2192 [fact] Webhook endpoint\n\nChat B: \"Checkout UI\"\n  \u2192 [fact] Form uses React\n  \u2192 [effort] Validation logic\n\nChat C: New chat about \"payment form bugs\"\n  \u2192 Imports: Stripe fact + Form fact + Validation effort\n  \u2192 Has context from BOTH without loading full history\n```\n\n**Artifacts are the index into your knowledge.**"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "At Chat Start (or explicit search)",
      "content": "### At Chat Start (or explicit search)\n\n1. Search artifacts for relevance to user intent\n2. Find source chats for those artifacts\n3. Present options: continue, fork, new+artifacts, fresh\n4. Load selected context\n5. Done - conversation proceeds"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "During Chat",
      "content": "### During Chat\n\n- Artifacts extracted continuously (via cascading inference)\n- Context = current chat's artifacts + recent messages\n- No rebuilding needed until fork/new"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Context Caching",
      "content": "### Context Caching\n\nArtifact portion of context can be cached:\n- Rebuild only when new artifacts created\n- Recent messages added each turn\n- Hash-based cache invalidation"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Value Proposition",
      "content": "## The Value Proposition\n\n| Aspect | Traditional | This System |\n|--------|-------------|-------------|\n| Chat history | Grows unbounded | Compacted to artifacts |\n| Finding context | Search chat titles | Search artifacts + AI assists |\n| Token usage | Linear growth | Bounded by artifact count |\n| Cross-reference | Not possible | Via portable artifacts |\n| Forking | Not possible | Branch from any point |\n| Information loss | At token limit | Never (raw chat preserved) |"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Slice 1: Proof of Concept",
      "content": "### Slice 1: Proof of Concept\n\n**Scope:**\n- Single artifact type: **effort** (with resolution)\n- Compact on **conclusion only** (when user accepts/resolves)\n- No sub-efforts, no token limit fallback\n- Accept context limit as known limitation\n\n**When compaction triggers:**\n```\nUser: \"I'm getting a 401 error\"\n  \u2192 No artifact yet (conversation ongoing)\n\n[... back and forth debugging ...]\n\nUser: \"Oh! Token was expired, works now!\"\n  \u2192 DETECTOR: User accepted solution\n  \u2192 COMPACT: Extract effort + resolution\n  \u2192 SAVE: Artifact persists for future sessions\n```\n\n**What Slice 1 proves:**\n- Conclusion-triggered compaction works\n- Artifacts can replace verbose exchanges\n- Context stays small while knowledge persists\n- Cross-session memory via artifacts"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Future: Smart Chunking (Sub-efforts)",
      "content": "### Future: Smart Chunking (Sub-efforts)\n\nA debugging effort could have multiple attempts as sub-efforts:\n\n```\n[effort] Debug auth bug\n  \u251c\u2500\u2500 [sub-effort] Try refreshing token \u2192 failed\n  \u251c\u2500\u2500 [sub-effort] Check headers \u2192 failed\n  \u2514\u2500\u2500 [sub-effort] Inspect JWT payload \u2192 FOUND IT\n      => Token had wrong audience claim\n```\n\nEach sub-effort compacts as it concludes (success or failure), keeping context bounded even during long investigations."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Future: Token Limit Fallback",
      "content": "### Future: Token Limit Fallback\n\nEven without natural compaction points, system needs emergency compaction:\n\n```python\nif approaching_context_limit() and no_natural_compact_point():\n    # Force summarize oldest uncompacted exchanges\n    force_summarize_oldest()\n    # Or prompt user: \"We've been at this a while, let me summarize...\"\n```\n\nThis ensures the system never crashes due to context overflow."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Slice 1 vs Future Comparison",
      "content": "### Slice 1 vs Future Comparison\n\n| Feature | Slice 1 | Future |\n|---------|---------|--------|\n| Effort artifacts | \u2705 | \u2705 |\n| Compact on conclusion | \u2705 | \u2705 |\n| Fact/event artifacts | \u274c | \u2705 |\n| Sub-efforts | \u274c | \u2705 |\n| Token limit fallback | \u274c | \u2705 |\n| Mid-effort checkpoints | \u274c | \u2705 |\n| Effort as subagent | \u274c | \u2705 |\n| Cross-chat search | \u274c | \u2705 |\n| Fork/continue flow | \u274c | \u2705 |"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Soon (Post Slice 1)",
      "content": "### Soon (Post Slice 1)\n- Search/match for continuing chats\n- Continue/fork/new+artifacts flow\n- Cross-chat artifact references\n- Fact and event artifact types"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Later",
      "content": "### Later\n- Sessions (subdivisions of chats)\n- Dashboard views\n- Fork visualization\n- Artifact graphs\n- Sub-efforts and smart chunking\n- Token limit fallback"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Relationship to Original Thesis",
      "content": "## Relationship to Original Thesis\n\nThis IS the thesis:\n- **Conclusion-triggered compaction** \u2192 Artifacts extracted when understanding reached\n- **Keep threads open until resolution** \u2192 Open efforts persist\n- **Dual storage** \u2192 Raw chat + compressed artifacts\n- **Context as reasoning, not storage** \u2192 Artifacts are reasoned extraction\n\nWe just refined the terminology and simplified the model."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "RAG Strategy (Future Slices)",
      "content": "## RAG Strategy (Future Slices)\n\n> **Note**: Not for Slice 1. Documented here for future implementation."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Problem",
      "content": "### The Problem\n\nWith many artifacts, the context builder needs efficient retrieval:\n\n```\nTraditional:\n  User: \"work on payment integration\"\n  \u2192 Scan all artifact files\n  \u2192 Keyword match\n  \u2192 Slow, misses semantic matches\n\nRAG:\n  User: \"work on payment integration\"\n  \u2192 Embed query \u2192 vector\n  \u2192 Vector similarity search\n  \u2192 Fast, finds \"Stripe checkout\" even without exact words\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Recommendations",
      "content": "### Recommendations\n\n| Question | Recommendation | Rationale |\n|----------|----------------|-----------|\n| Embedding model | Local: `sentence-transformers` (all-MiniLM-L6-v2) | Free, fast, offline, good quality |\n| Storage | ChromaDB (local persistent) | Purpose-built, simple API, local-first |\n| When to embed | On artifact creation | Artifacts created infrequently, always searchable |\n| What to embed | summary + resolution + tags | Semantic essence without noise |"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Artifact Structure with RAG Metadata",
      "content": "### Artifact Structure with RAG Metadata\n\n```javascript\n{\n  // Core artifact data\n  \"id\": \"effort-abc123\",\n  \"type\": \"effort\",\n  \"summary\": \"Debug 401 authentication error\",\n  \"resolution\": \"Token was expired, refresh fixed it\",\n  \"status\": \"resolved\",\n  \"tags\": [\"auth\", \"debugging\", \"api\"],\n\n  // RAG metadata (future)\n  \"embedding\": [0.023, -0.041, ...],\n  \"source_ref\": \"chat-xyz:lines-15-42\",\n  \"created_at\": \"2026-01-14T10:00:00Z\",\n  \"token_count\": 68\n}\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Dual Storage: Summary + Raw Access",
      "content": "### Dual Storage: Summary + Raw Access\n\nThe artifact links back to source chat for deep dives:\n\n```\nArtifact (in context, searchable via RAG)\n  \u251c\u2500\u2500 summary: \"Debug 401 auth error\"\n  \u251c\u2500\u2500 resolution: \"Token was expired\"\n  \u251c\u2500\u2500 embedding: [vectors for semantic search]\n  \u2502\n  \u2514\u2500\u2500 source_ref: \"chat-xyz:lines-15-42\"  \u2190 Link to raw\n          \u2502\n          \u2193\n      Raw Chat Log (preserved, accessible on demand)\n        [full back-and-forth if AI needs details]\n```\n\n**Normal flow:** AI uses artifact summary (cheap, fast, in context)\n**Deep dive:** AI reads linked source chat (on demand, rare)\n\nThis means:\n- Context stays small (summaries only)\n- Full detail always accessible (via source link)\n- AI can manually search/read raw chat when needed"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "ChromaDB Usage (Future)",
      "content": "### ChromaDB Usage (Future)\n\n```python\nimport chromadb\n\nclient = chromadb.PersistentClient(path=\"~/.oi/vectors\")\nartifacts = client.get_or_create_collection(\"artifacts\")\n\n# On artifact creation\nembed_text = f\"{summary}. {resolution}. Tags: {', '.join(tags)}\"\nartifacts.add(\n    ids=[\"effort-abc123\"],\n    documents=[embed_text],\n    metadatas=[{\n        \"type\": \"effort\",\n        \"status\": \"resolved\",\n        \"chat\": \"chat-xyz\",\n        \"source_ref\": \"chat-xyz:lines-15-42\"\n    }]\n)\n\n# On context building (semantic search)\nresults = artifacts.query(\n    query_texts=[\"payment integration\"],\n    n_results=10,\n    where={\"status\": \"resolved\"}  # Optional filters\n)\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Implications for Slice 1",
      "content": "### Implications for Slice 1\n\nNo code changes, but design with RAG in mind:\n- Structure artifacts cleanly (summary, resolution, tags as separate fields)\n- Use JSON storage that's easy to migrate to ChromaDB\n- Keep artifact text concise (good for context AND future embedding)\n- Include source_ref linking back to raw chat"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Agent-Artifact Architecture (Future Slices)",
      "content": "## Agent-Artifact Architecture (Future Slices)\n\n> **Note**: Not for Slice 1. Captured for future implementation."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Insight: Agents and Artifacts Are Linked",
      "content": "### The Insight: Agents and Artifacts Are Linked\n\nArtifact detection, schema, and creation should come from an \"agent package\":\n\n```\nChat Stream (conversation flowing)\n    \u2502\n    \u251c\u2500\u2500 [Effort Agent] \ud83d\udc41\ufe0f (half-awake, watching...)\n    \u2502     Schema: {goal, attempts, resolution}\n    \u2502     Trigger: \"user trying to accomplish something\"\n    \u2502     \u2192 Creates: Effort artifact\n    \u2502\n    \u251c\u2500\u2500 [Fact Agent] \ud83d\udc41\ufe0f (half-awake, watching...)\n    \u2502     Schema: {statement, source, confidence}\n    \u2502     Trigger: \"factual Q&A concluded\"\n    \u2502     \u2192 Creates: Fact artifact\n    \u2502\n    \u2514\u2500\u2500 [Custom: BugReport Agent] \ud83d\udc41\ufe0f (user-defined)\n          Schema: {error, repro_steps, fix}\n          Trigger: \"debugging session concluded\"\n          \u2192 Creates: BugReport artifact\n```\n\nMultiple agents, each:\n- **Half-awake** (low overhead, pattern matching)\n- **Schema-bound** (knows what artifact type to produce)\n- **Self-activating** (triggers on its own conditions)\n- **Extensible** (users can add custom agent packages)"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Key Insight: Subject Doesn't Matter, Structure Does",
      "content": "### Key Insight: Subject Doesn't Matter, Structure Does\n\nThe artifact type depends on **grammatical/intentional structure**, not topic:\n\n| Message | Subject | Structure/Intent |\n|---------|---------|------------------|\n| \"hello how are you?\" | social | Greeting (no artifact) |\n| \"lets solve a bug\" | debugging | **Effort initiation** |\n| \"i want to learn about ww2\" | history | **Effort initiation** |\n| \"i got in a bad fight with my gf\" | relationships | Statement (unclear) |\n| \"what's the capital of France?\" | geography | **Question \u2192 Fact** |\n| \"that fixed it, thanks!\" | any | **Resolution trigger** |\n| \"I'll go with option A\" | any | **Decision** |\n\n**The topic is irrelevant. The intent structure determines the artifact type.**"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Dialogue Acts (Speech Acts)",
      "content": "### Dialogue Acts (Speech Acts)\n\nThis maps to well-studied linguistic concepts:\n\n| Act Type | Examples | Maps to Artifact? |\n|----------|----------|-------------------|\n| Greeting | \"hi\", \"hello\" | No artifact (noise) |\n| Question | \"what is X?\" | Fact (when answered) |\n| Request | \"help me with X\" | Effort (open) |\n| Inform | \"I did X yesterday\" | Event or Statement |\n| Commit | \"I'll do X\" | Decision |\n| Accept | \"that works, thanks\" | Resolution trigger |\n| Reject | \"no that's not it\" | Effort continues |"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Intent Detection: Vectors vs Classifiers",
      "content": "### Intent Detection: Vectors vs Classifiers\n\n**Vectors capture meaning, not intent:**\n\n```\n\"I want to learn about WW2\"  \u2192  [vector about WW2, learning]\n\"WW2 started in 1939\"        \u2192  [vector about WW2, dates]\n\nSemantically similar (both about WW2)\nBut completely different intents (effort vs statement)\n```\n\n**Better: Use classifiers for intent, vectors for topics:**\n\n| Tool | Use For | Speed |\n|------|---------|-------|\n| Rules | Obvious intents (\"lets\", \"help me\") | ~0.1ms |\n| Classifier | Ambiguous intents | ~3ms |\n| Vectors | Finding related artifacts by topic | ~10ms |\n\n```\nVectors    = WHAT is this about?     (topic, semantics)\nClassifier = WHAT is user doing?     (intent, action)\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Efficient Cascading Detection",
      "content": "### Efficient Cascading Detection\n\n```\nMessage: \"lets debug this auth issue\"\n         \u2502\n         \u2193\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 Level 1: Rules \u2502  (~0.1ms)\n    \u2502 \"lets\" \u2192 effort\u2502  \u2190 Match! Done.\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\nMessage: \"I had a weird experience yesterday\"\n         \u2502\n         \u2193\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 Level 1: Rules \u2502  No match\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2502\n         \u2193\n    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n    \u2502 Level 2: Classifier\u2502  (~3ms)\n    \u2502 statement: 0.7     \u2502  \u2190 Use this\n    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Agent Package Structure (Future)",
      "content": "### Agent Package Structure (Future)\n\n```python\n# effort_agent.py\nclass EffortAgent:\n    schema = EffortArtifact  # Pydantic model\n\n    def detect(self, message: str) -> float:\n        \"\"\"Return confidence 0-1 that this triggers me\"\"\"\n        # Rules first, classifier fallback\n\n    def extract(self, context: list) -> EffortArtifact:\n        \"\"\"Create the artifact from conversation context\"\"\"\n        # Summarize, structure, return typed artifact\n\n# Users could add custom agents:\nclass BugReportAgent:\n    schema = BugReportArtifact\n    triggers = [\"error\", \"bug\", \"broken\", \"debugging\"]\n    # ...\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "What Makes This Valuable",
      "content": "### What Makes This Valuable\n\n1. **Agents = artifact factories** - each agent knows its schema\n2. **Composable** - add new artifact types by adding agent packages\n3. **Efficient** - rules + classifier cascade, not heavy LLM calls\n4. **Topic-agnostic** - same detection works for any subject matter\n5. **Self-evolving** - ties to earlier insight about emergent schemas"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Comparison to Traditional Agents",
      "content": "### Comparison to Traditional Agents\n\n| Traditional Agents | This Architecture |\n|-------------------|-------------------|\n| Explicitly invoked | Self-activating on pattern |\n| Do task, return result | Watch stream, create artifact |\n| One at a time | Multiple concurrent observers |\n| Generic output | Schema-bound typed output |"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Summary: Two Systems, Two Tools",
      "content": "### Summary: Two Systems, Two Tools\n\n| System | Tool | Purpose |\n|--------|------|---------|\n| **Context Builder** | Vectors (RAG) | \"Find artifacts *about* this topic\" |\n| **Artifact Builder** | Intent Classifier | \"Is this an *effort*, *fact*, *resolution*?\" |\n\n```\nUser: \"I want to work on payment integration\"\n         \u2502\n         \u251c\u2500\u2192 Intent Classifier: \"effort initiation\" \u2192 Effort Agent activates\n         \u2502\n         \u2514\u2500\u2192 Vector Search: finds related artifacts about payments \u2192 loads into context\n```\n\n**Two orthogonal concerns:**\n- **What to load** (semantic/topical) \u2192 vectors\n- **What to create** (intent/action) \u2192 classifier"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "1. Artifact Ownership",
      "content": "### 1. Artifact Ownership\n- Do artifacts belong to a chat or are they global?\n- If global, how to handle conflicts between chats?"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "2. Forking Mechanics",
      "content": "### 2. Forking Mechanics\n- Do forked chats share artifacts or copy them?\n- How to visualize fork relationships?"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "3. Search Quality",
      "content": "### 3. Search Quality\n- How to match user intent to relevant artifacts?\n- Semantic search? Keyword? Hybrid?"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "4. Artifact Lifecycle",
      "content": "### 4. Artifact Lifecycle\n- When do facts become stale?\n- Can resolved efforts be reopened?\n- Garbage collection for orphaned artifacts?"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "5. Chat Naming",
      "content": "### 5. Chat Naming\n- Auto-generate names from first message/main effort?\n- User can rename?\n- Searchable summaries?\n\n---"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Future Insight: Artifacts as Execution Contexts (Subagents)",
      "content": "## Future Insight: Artifacts as Execution Contexts (Subagents)\n\n> **Note**: This is a future unification concept, NOT for Slice 1. Captured here for architectural clarity."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Observation",
      "content": "### The Observation\n\nWhen a user starts working on a bug, the conversation might look like:\n\n```\n[user] I'm getting a weird error in auth\n[AI] Let's investigate...\n[user] Here's the error log\n[AI] Try X\n[user] Didn't work\n[AI] What about Y?\n...\n```\n\nAn artifact detector could recognize: \"This is an effort - debugging bug X\"\n\nBut here's the insight: **that effort isn't just data - it's a scoped execution context.**"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Pattern",
      "content": "### The Pattern\n\n```\nChat Log (full context)\n    \u2502\n    \u2514\u2500\u2500 DETECTOR: \"This is an effort - extract it\"\n            \u2502\n            \u2193\n        \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n        \u2502 EFFORT ARTIFACT             \u2502\n        \u2502 \"Debugging bug X\"           \u2502\n        \u2502 Status: open                \u2502\n        \u2502                             \u2502\n        \u2502 [Focused thread/context]    \u2502\n        \u2502 \u251c\u2500\u2500 error details           \u2502\n        \u2502 \u251c\u2500\u2500 attempt 1: failed       \u2502\n        \u2502 \u251c\u2500\u2500 attempt 2: trying...    \u2502\n        \u2502                             \u2502\n        \u2502 (This IS a subagent)        \u2502\n        \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "The Generalization",
      "content": "### The Generalization\n\n**An artifact isn't just passive data - it's a potential execution context that can be spawned, worked on, and collapsed.**\n\n| Artifact State | Subagent Analogy |\n|---------------|------------------|\n| Effort created | Subagent spawned with goal |\n| Working on it | Subagent executing with focused context |\n| Writes findings | Subagent updates its own state |\n| Resolved | Subagent returns result, terminates |\n| Summary remains | Result merged back to parent |"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Token Economics",
      "content": "### Token Economics\n\n```\nBefore extraction:\n  Chat: [msg1][msg2][msg3][msg4][msg5]... (growing)\n  Main context: 2500 tokens (and growing)\n\nAfter extraction:\n  Main context: [artifact-ref] = 100 tokens\n  Effort context: [focused thread] = 2000 tokens (only when active)\n\nWhen effort resolves:\n  Main context: 100 tokens (summary + resolution)\n  Effort context: 0 (collapsed, no longer needed)\n```\n\n**Key**: You only load the effort's thread when actively working on it."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Multi-Topic Conversations",
      "content": "### Multi-Topic Conversations\n\nThis enables parallel work without context pollution:\n\n```\nUser: \"I'm getting a weird error in auth\"\n  \u2192 Spawns: EFFORT \"Debug auth error\" (focused context)\n\nUser: \"also, remind me to call mom later\"\n  \u2192 Creates: EVENT \"Call mom\" (in main context, not effort)\n\nUser: \"back to that bug - I tried X\"\n  \u2192 Detects: relates to open effort\n  \u2192 Loads: effort context\n  \u2192 Continues: work in focused thread\n\nUser: \"that fixed it!\"\n  \u2192 Resolves: effort with resolution\n  \u2192 Collapses: effort context back to summary\n  \u2192 Reclaims: tokens for main context\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Artifact Types as Context Types",
      "content": "### Artifact Types as Context Types\n\n| Type | Execution Model |\n|------|-----------------|\n| **Effort** | Active subagent - has goal, does work, returns resolution |\n| **Fact** | Passive data - no execution, just knowledge |\n| **Event** | Temporal context - expires, no execution |\n\nEfforts are special - they're **active contexts** that do work."
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Conceptual Code",
      "content": "### Conceptual Code\n\n```python\n# Future implementation concept\neffort = spawn_context(\n    goal=\"Debug bug X\",\n    context=relevant_messages,  # Focused, not full chat\n    parent=main_chat\n)\n\nwhile not effort.resolved:\n    effort.work()  # Operates with focused context\n    effort.update_artifact()  # Writes findings to itself\n\n# When done:\nmain_chat.receive(effort.summary)  # Collapsed result\neffort.context = None  # Reclaim tokens\n```"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Why This Matters",
      "content": "### Why This Matters\n\nThis unifies three concepts:\n1. **Memory** - artifacts as stored knowledge\n2. **Agents** - efforts as spawnable workers with goals\n3. **Context management** - scoped windows that expand/collapse dynamically"
    },
    {
      "source": "brainstorm\\refined-chat-model.md",
      "heading": "Implementation Notes (Future)",
      "content": "### Implementation Notes (Future)\n\nFor Slice 1: Artifacts are just data with artifact_type field.\n\nFuture slices could:\n- Track which messages belong to which effort's \"thread\"\n- Load/unload effort contexts dynamically\n- Allow efforts to run semi-autonomously (check in periodically)\n- Visualize effort threads as branches\n\nThis is a significant architectural evolution that would require careful design.\n\n---\n\n*Refined: 2026-01-14*\n*Status: Core model clarified*\n*Supersedes: sessions-and-dashboard.md (sessions now optional future feature)*"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Purpose",
      "content": "## Purpose\nAnalyze each scenario to determine what artifact type (if any) should be created.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 1: Recency Query",
      "content": "## Scenario 1: Recency Query\n**User:** \"Where did we leave off?\"\n\n**Context:** User opens new session after working on game dev project yesterday.\n\n**Expected AI behavior:** Scan recent artifacts, respond with summary of recent activity.\n\n**Artifact created from THIS exchange?** No - this is a query, not new work.\n\n**Suggested artifact type:** `query` (or none - just a lookup)\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 2: Fresh Start - New Idea",
      "content": "## Scenario 2: Fresh Start - New Idea\n**User:** \"I have an idea for a multiplayer mode\"\n\n**Context:** User starting something new.\n\n**Expected AI behavior:** Engage with the idea, maybe ask clarifying questions.\n\n**Artifact created?** Yes - this is the START of an effort.\n\n**Suggested artifact type:** `effort` (open)\n```json\n{\n  \"type\": \"effort\",\n  \"status\": \"open\",\n  \"summary\": \"Exploring multiplayer mode idea\",\n  \"detail\": \"User proposed adding multiplayer, type TBD\"\n}\n```\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 3: Search Query",
      "content": "## Scenario 3: Search Query\n**User:** \"What was that bug we fixed with the player falling through floors?\"\n\n**Context:** User trying to recall past work.\n\n**Expected AI behavior:** Search artifacts for \"player\" + \"floor\" or \"collision\", return match.\n\n**Artifact created from THIS exchange?** No - this is a lookup.\n\n**Suggested artifact type:** `query` (or none)\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 4: Continuation Without Conclusion",
      "content": "## Scenario 4: Continuation Without Conclusion\n**Session 1:**\n- User: \"I'm thinking about adding multiplayer\"\n- AI: \"Interesting! What kind - co-op or competitive?\"\n- User: \"Not sure yet, let me think about it\"\n- [Session ends - NO CONCLUSION]\n\n**Session 2:**\n- User: \"Okay I decided - let's do co-op\"\n\n**Expected AI behavior:** Know about the open effort, continue it.\n\n**Artifact from Session 1?** Yes - open effort\n```json\n{\n  \"type\": \"effort\",\n  \"status\": \"open\",\n  \"summary\": \"Deciding on multiplayer type (co-op vs competitive)\"\n}\n```\n\n**Artifact from Session 2?** Yes - conclusion/resolution\n```json\n{\n  \"type\": \"conclusion\",\n  \"summary\": \"Decided on co-op multiplayer\",\n  \"resolves_effort\": \"<effort_id>\"\n}\n```\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 5: Emotional/Personal Context",
      "content": "## Scenario 5: Emotional/Personal Context\n**User:** \"I'm frustrated, this bug has taken 3 days\"\n*[AI helps, bug gets fixed]*\n\n**Later:** \"Remember that nightmare bug?\"\n\n**Expected AI behavior:** Connect \"nightmare bug\" to the 3-day frustrating bug.\n\n**Artifact created?** Yes - effort with emotional context\n```json\n{\n  \"type\": \"effort\",\n  \"status\": \"resolved\",\n  \"summary\": \"Fixed rendering bug (3-day struggle)\",\n  \"tags\": [\"frustrating\", \"nightmare\"],\n  \"time_spent\": \"3 days\",\n  \"conclusion\": \"Fixed by updating shader cache\"\n}\n```\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 6: Learning/Education",
      "content": "## Scenario 6: Learning/Education\n**User:** \"Explain quantum entanglement to me\"\n*[AI explains, user asks follow-ups, eventually understands]*\n\n**Artifact created?** Yes - learning effort\n```json\n{\n  \"type\": \"effort\",\n  \"category\": \"learning\",\n  \"status\": \"resolved\",\n  \"summary\": \"User learned quantum entanglement\",\n  \"conclusion\": \"Key insight: measurement collapses entangled states simultaneously\"\n}\n```\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 7: Simple Q&A (Public Knowledge)",
      "content": "## Scenario 7: Simple Q&A (Public Knowledge)\n**User:** \"What's the capital of France?\"\n**AI:** \"Paris\"\n**User:** \"Thanks\"\n\n**Artifact created?** Maybe not - or very lightweight.\n\n**Analysis:**\n- Public knowledge, no value added\n- BUT if referenced frequently, might be worth keeping\n- Could start with ref_count=0, expire if never referenced\n\n**Suggested artifact type:** `fact` (lightweight, can expire)\n```json\n{\n  \"type\": \"fact\",\n  \"summary\": \"Capital of France is Paris\",\n  \"ref_count\": 0,\n  \"expires\": true\n}\n```\n\n**Alternative:** Don't create artifact, only raw chat log.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 8: Casual Chat",
      "content": "## Scenario 8: Casual Chat\n**User:** \"How's it going?\"\n**AI:** \"Good! How are you?\"\n**User:** \"Tired, long day\"\n**AI:** \"Hope you get some rest\"\n\n**Artifact created?** Probably not - no goal, no resolution.\n\n**Analysis:**\n- No effort, no knowledge gained\n- \"User was tired on Oct 8th\" - relevant if referenced later\n- Could capture as lightweight event, expire if unreferenced\n\n**Suggested artifact type:** `event` (lightweight, expires fast)\n```json\n{\n  \"type\": \"event\",\n  \"summary\": \"Casual check-in, user mentioned being tired\",\n  \"ref_count\": 0,\n  \"expires\": true\n}\n```\n\n**Alternative:** Raw chat only, no artifact.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 9: Creative Writing",
      "content": "## Scenario 9: Creative Writing\n**User:** \"Help me write a short story about a robot\"\n*[Multiple sessions, drafts, revisions]*\n\n**Artifact created?** Yes - hierarchical efforts\n```json\n{\n  \"type\": \"effort\",\n  \"status\": \"open\",\n  \"summary\": \"Writing robot short story\",\n  \"children\": [\n    {\"type\": \"effort\", \"summary\": \"Developed main character Axis\", \"status\": \"resolved\"},\n    {\"type\": \"effort\", \"summary\": \"Wrote first draft (2000 words)\", \"status\": \"resolved\"},\n    {\"type\": \"effort\", \"summary\": \"Revising ending\", \"status\": \"open\"}\n  ]\n}\n```\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario 10: Planning",
      "content": "## Scenario 10: Planning\n**User:** \"Help me plan a trip to Japan\"\n\n**Artifact created?** Yes - hierarchical effort\n```json\n{\n  \"type\": \"effort\",\n  \"category\": \"planning\",\n  \"summary\": \"Planning Japan trip\",\n  \"children\": [\n    {\"summary\": \"Decided dates: April 10-20\", \"status\": \"resolved\"},\n    {\"summary\": \"Book flights\", \"status\": \"open\"},\n    {\"summary\": \"Plan itinerary: Tokyo 3d, Kyoto 4d\", \"status\": \"resolved\"}\n  ]\n}\n```\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Summary: Artifact Types",
      "content": "## Summary: Artifact Types\n\n| Type | When to Use | Expires? |\n|------|-------------|----------|\n| `effort` | Goal-oriented work (open or resolved) | No |\n| `conclusion` | Resolution/knowledge from an effort | No |\n| `fact` | Simple Q&A, public knowledge | Yes (if unreferenced) |\n| `event` | Casual exchange, context that might matter | Yes (fast) |\n| `query` | User asking to look something up | No artifact needed |\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n\n1. Should `fact` and `event` even create artifacts, or just stay in raw chat?\n2. How does the LLM decide which type to use?\n3. What's the expiration policy? Time-based? Reference-based? Both?\n4. Should hierarchical efforts be nested or linked by ID?\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Context Building Scenarios",
      "content": "## Context Building Scenarios\n\nThese scenarios inform how the AI retrieves context using tools."
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario: State Query",
      "content": "### Scenario: State Query\n**User:** \"What are we working on?\"\n\n**AI behavior:** Calls `get_open_efforts()` + `get_recent_resolved(5)`\n\n**Response:** \"You have 3 open efforts for Project X:\n1. Fix login bug\n2. Add dark mode\n3. Refactor auth\n\nRecently finished: Payment integration (2 days ago), User onboarding (last week).\n\nWant to continue one of these?\"\n\n**Artifact created?** No - just a lookup.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario: Continue Last",
      "content": "### Scenario: Continue Last\n**User:** \"Let's continue from where we left off\"\n\n**AI behavior:** Calls `get_open_efforts()`, sorts by `updated` timestamp, picks most recent.\n\n**Key insight:** Need `updated` timestamp, not just `created`. Most recently *active* effort, not most recently *created*.\n\n**Response:** \"Last time we were working on [most recent effort]. Want to continue?\"\n\n**Artifact created?** No - just retrieval + confirmation.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario: Topic Query",
      "content": "### Scenario: Topic Query\n**User:** \"My skin condition is getting worse\"\n\n**AI behavior:** Calls `search_artifacts(\"health skin condition\")`, finds related effort (even if resolved).\n\n**Response:** Uses history: \"Last time we tried cream X and it worked for a bit. What's happening now?\"\n\n**Artifact created?** Maybe - updates existing effort or creates child effort.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario: Specific Search",
      "content": "### Scenario: Specific Search\n**User:** \"What was that bug with the player falling through floors?\"\n\n**AI behavior:** Calls `search_artifacts(\"bug player floor collision\")`. If not found, calls `search_chatlog(\"floor falling\")`.\n\n**Response:** Returns match with context.\n\n**Artifact created?** No - just lookup.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Context Building Architecture",
      "content": "## Context Building Architecture\n\nThe AI has retrieval tools available and decides which to use:\n\n```\nTools:\n\u251c\u2500\u2500 get_open_efforts()           # Current work\n\u251c\u2500\u2500 get_recent_resolved(n)       # Recently finished\n\u251c\u2500\u2500 search_artifacts(query)      # Find by tags/keywords/summary\n\u2514\u2500\u2500 search_chatlog(query)        # Raw history fallback\n\nInstructions:\n\"Use retrieval tools based on what user is asking.\nState queries \u2192 get open efforts.\nTopic queries \u2192 search by relevance.\nYou can combine tools.\"\n```\n\nThis is standard tool use - one LLM call, AI decides what context it needs.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Edge Case Scenarios",
      "content": "## Edge Case Scenarios\n\nThese scenarios clarify when to create artifacts vs just use chat log."
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario A: Emotional/Relationship (No Clear Goal)",
      "content": "### Scenario A: Emotional/Relationship (No Clear Goal)\n**User:** \"I had a huge fight with my sister last night\"\n\n**Analysis:**\n- No clear goal/effort - user is sharing, not trying to accomplish something\n- Without specialized handling (e.g., therapist agent), we can't systematically help\n- Conversation might evolve into clearer effort (\"help me apologize\")\n\n**Artifact created?** No - just chat log for now.\n\n**Rationale:** Without systemic capability to handle this type of conversation, don't force an artifact. The conversation might naturally evolve into a clearer effort. Raw chat log preserves everything for future recall.\n\n**Future:** With specialized agents (therapist, relationship coach), could create structured efforts: \"Process fight\", \"Plan resolution\", \"Prevent future conflicts\".\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario B: Throwaway Utility Query",
      "content": "### Scenario B: Throwaway Utility Query\n**User:** \"Convert 50 USD to EUR\"\n**AI:** \"That's about 46 EUR at current rates\"\n**User:** \"Thanks\"\n\n**Analysis:**\n- Truly one-off, no lasting value\n- User unlikely to reference this later\n- No effort, no fact worth keeping\n\n**Artifact created?** No - just chat log.\n\n**Rationale:** Not everything needs compression artifacts. Chat log is searchable for recall (\"what was that amount I asked you to convert?\"). Don't pollute artifact space with throwaway queries.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario C: Trivial Decision (Still an Effort!)",
      "content": "### Scenario C: Trivial Decision (Still an Effort!)\n**User:** \"Help me name my new cat\"\n*[Back and forth with suggestions]*\n**User:** \"Okay, I'll go with Luna\"\n\n**Analysis:**\n- User had a goal (name cat)\n- Conversation happened\n- Decision was reached (\"Luna\")\n\n**Artifact created?** YES - effort with resolution.\n\n```\n[effort:resolved] Name user's new cat\n  => User decided on \"Luna\"\n```\n\n**Rationale:** No matter how trivial it seems to us, the user cared enough to ask. That's what matters. The artifact respects the user's investment. Might be referenced later (\"How's Luna doing?\").\n\n**Key insight:** Our judgment of \"trivial\" doesn't matter. If user spent time and reached a conclusion, it's an effort.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Scenario D: Open-Ended Learning (May Never Complete)",
      "content": "### Scenario D: Open-Ended Learning (May Never Complete)\n**User:** \"I want to learn about WW2\"\n*[Extended conversation about causes, timeline, key events]*\n**User:** \"Please create a timeline of major events\"\n*[AI creates document]*\n*[User doesn't return for weeks]*\n\n**Analysis:**\n- Parent effort: \"Learn about WW2\"\n- Child efforts emerge: \"Understand causes\", \"Create timeline\"\n- May never explicitly \"complete\" - user just stops coming back\n\n**Artifact structure:**\n```\n[effort:open] Learn about WW2\n  \u251c\u2500\u2500 [effort:resolved] Understand how it started\n  \u2502   => Discussed Treaty of Versailles, rise of fascism\n  \u251c\u2500\u2500 [effort:resolved] Create timeline of major events\n  \u2502   => links to document artifact\n  \u2514\u2500\u2500 [No activity for X weeks \u2192 auto-archive]\n```\n\n**New state needed: `archived`**\n- Not resolved (user didn't say \"I've learned enough\")\n- Not actively open (no recent activity)\n- Preserved for future, not cluttering active view\n\n**Rationale:** Some efforts don't have natural resolution points. They fade rather than conclude. Archiving after inactivity keeps the active list clean while preserving history.\n\n---"
    },
    {
      "source": "brainstorm\\scenarios.md",
      "heading": "Artifact States",
      "content": "## Artifact States\n\nBased on these scenarios, we need three states:\n\n| State | Meaning | Shows in \"What are we working on?\" |\n|-------|---------|-----------------------------------|\n| `open` | Actively working | Yes |\n| `resolved` | Concluded with resolution | No (but in \"recently finished\") |\n| `archived` | Inactive, auto-archived after X time | No (searchable, can reopen) |\n\nTransitions:\n```\nopen \u2192 resolved   (user concludes)\nopen \u2192 archived   (inactivity timeout)\narchived \u2192 open   (user returns to topic)\nresolved \u2192 open   (rare: resolution didn't hold, e.g., skin condition returned)\n```"
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "The Idea",
      "content": "## The Idea\n\nInstead of hardcoded artifact types (effort, fact, event), the LLM proposes new types as it encounters new patterns. Like a \"human-readable neural network\" that develops structure over time."
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "1. How does LLM propose a new type?",
      "content": "### 1. How does LLM propose a new type?\n- Explicitly: \"I haven't seen this pattern before, I suggest creating a 'recipe' type\"\n- Silently: Creates it, we review later\n- Hybrid: Proposes, user approves"
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "2. What defines an artifact type?",
      "content": "### 2. What defines an artifact type?\n```yaml\ntype: recipe\ndescription: \"Step-by-step instructions for making something\"\nfields:\n  - ingredients: list\n  - steps: list\n  - prep_time: string\nexpires: false\n```"
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "3. Where do type definitions live?",
      "content": "### 3. Where do type definitions live?\n- `~/.oi/schemas/` folder?\n- Inside state.json itself?\n- Separate schemas.json?"
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "4. How to prevent type explosion?",
      "content": "### 4. How to prevent type explosion?\n- LLM checks \"is this really new, or does it fit existing type?\"\n- Types need minimum usage count to persist\n- Periodic consolidation: \"these 3 types are similar, merge?\""
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "5. How does interpretation prompt adapt?",
      "content": "### 5. How does interpretation prompt adapt?\n- Dynamically built from current schema definitions\n- Each type definition includes its own interpretation hints"
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "6. Is the schema itself an artifact?",
      "content": "### 6. Is the schema itself an artifact?\n```json\n{\n  \"artifact_type\": \"schema_definition\",\n  \"summary\": \"recipe - step-by-step instructions for making something\",\n  \"fields\": [\"ingredients\", \"steps\", \"prep_time\"]\n}\n```\n\nThis would make the system truly self-describing."
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "Prerequisite",
      "content": "## Prerequisite\n\nFirst implement **configurable schemas (B)** - user defines types in a config file. This creates the foundation for self-evolving schemas."
    },
    {
      "source": "brainstorm\\self-evolving-schemas.md",
      "heading": "Status",
      "content": "## Status\n\nParked for later. Focus on configurable schemas first."
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "The Problem with Traditional Chat Interfaces",
      "content": "## The Problem with Traditional Chat Interfaces\n\n**Current AI chat UX:**\n1. User needs to remember which chat has the right context\n2. Scrolls through chat list looking for \"that conversation about X\"\n3. Hopes the chat history has enough context\n4. Can't easily combine context from multiple chats\n5. No way to see what's \"active\" vs \"concluded\" at a glance\n\n**Users are forced to:**\n- Manage context manually through chat history\n- Start new chats for new topics (losing cross-topic connections)\n- Repeat context when resuming old topics"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "The Insight: Context as First-Class Entity",
      "content": "## The Insight: Context as First-Class Entity\n\n**Instead of**: \"Find the right chat with the right history\"\n**We enable**: \"Build/load the right context explicitly\"\n\nThe context builder becomes the primary interface, not the chat history."
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "What is a Session?",
      "content": "### What is a Session?\n\nA **session** is a named workspace containing:\n- **Artifacts** (efforts, facts, events)\n- **Recent message history**\n- **Metadata** (created, last active, status)\n\nThink: IDE workspaces, tmux sessions, or browser tab groups for conversations."
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Session Lifecycle",
      "content": "### Session Lifecycle\n\n```\n[new] \u2192 [open] \u2192 [concluded] \u2192 [archived]\n           \u2193\n        [stale] (auto-detected)\n```\n\n**Open**: Active work, appears in main dashboard\n**Concluded**: Resolved/finished, can be resumed if needed\n**Stale**: Inactive for N days, system suggests archiving\n**Archived**: Removed from main view, searchable"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Sessions ARE Artifacts!",
      "content": "### Sessions ARE Artifacts!\n\n```javascript\n{\n  \"artifact_type\": \"session\",\n  \"summary\": \"Debug authentication bug in work project\",\n  \"status\": \"open\",\n  \"resolution\": null,  // Set when concluded\n  \"tags\": [\"work\", \"debugging\", \"auth\"],\n  \"created\": \"2026-01-13T10:00:00Z\",\n  \"last_active\": \"2026-01-13T15:30:00Z\",\n  \"child_artifacts\": [\n    // All efforts, facts, events in this session\n  ]\n}\n```\n\nThis makes sessions first-class in the knowledge network!"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "The Observation",
      "content": "### The Observation\n\n**Context changes slowly!**\n\nArtifacts portion: Only changes when new artifacts created (~30% of turns)\nMessages portion: Changes every turn (grows by 2 messages)\n\n**Currently**: We rebuild the full context every turn (wasteful!)"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Proposed: Cached Context per Session",
      "content": "### Proposed: Cached Context per Session\n\n```javascript\n// session-123.json\n{\n  \"session_id\": \"work-project-auth-debug\",\n  \"name\": \"Debug authentication bug\",\n  \"status\": \"open\",\n\n  // Cached context (rebuilt only when artifacts change)\n  \"artifacts_context\": \"Open efforts:\\n1. Debug auth bug...\",\n  \"artifacts_hash\": \"abc123def456\",  // Detect changes\n\n  // Growing message history (appends each turn)\n  \"recent_messages\": [\n    {\"role\": \"user\", \"content\": \"...\"},\n    {\"role\": \"assistant\", \"content\": \"...\"}\n  ],\n\n  \"metadata\": {\n    \"created\": \"2026-01-13T10:00:00Z\",\n    \"last_active\": \"2026-01-13T15:30:00Z\",\n    \"open_efforts\": 2,\n    \"facts_count\": 3,\n    \"message_count\": 24\n  }\n}\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Context Building Algorithm",
      "content": "### Context Building Algorithm\n\n```python\ndef build_context(session):\n    # Load session file\n    session_data = load_session(session.id)\n\n    # Check if artifacts changed\n    current_hash = hash_artifacts(session.artifacts)\n\n    if current_hash != session_data[\"artifacts_hash\"]:\n        # Rebuild artifacts context\n        artifacts_context = render_artifacts(session.artifacts)\n        session_data[\"artifacts_context\"] = artifacts_context\n        session_data[\"artifacts_hash\"] = current_hash\n        save_session(session_data)\n\n    # Always use cached artifacts context\n    context = [\n        system_prompt,\n        session_data[\"artifacts_context\"],\n        session_data[\"recent_messages\"][-10:]  # Last 10 messages\n    ]\n\n    return context\n```\n\n**Benefits:**\n- Build artifacts context once, reuse until changed\n- Massive performance improvement for long sessions\n- Still perfectly accurate (hash detects changes)\n- Context file is small (compressed artifacts + recent messages)"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Multiple Sessions: Workspace Switching",
      "content": "## Multiple Sessions: Workspace Switching\n\nUsers can have multiple parallel contexts:\n\n```bash\n> /session new work-project\nCreated session: work-project\n> /effort debug authentication bug\n...\n\n> /session new personal\nCreated session: personal\n> /effort plan Japan trip\n...\n\n> /session list\n\u25cf work-project (2 open efforts, 24 messages) - active\n\u25cf personal (1 open effort, 12 messages) - 2h ago\n\u25cb gaming-research (concluded) - 3 days ago\n\n> /session switch work-project\nSwitched to: work-project\nOpen efforts: 2\n  \u2022 Debug authentication bug\n  \u2022 Refactor user service\n```\n\n**Key benefit**: Context isolation + easy switching\n\nNo more \"which chat was that in?\" - just switch to the named session."
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Vision",
      "content": "### Vision\n\nThe dashboard is the primary entry point - a **customizable view over your knowledge network**.\n\nInstead of a list of chats, users see:\n- **Open sessions** (active workspaces)\n- **Top efforts** (current goals across all sessions)\n- **Recent conclusions** (what was resolved)\n- **Stale sessions** (suggest conclude/archive)\n- **Quick actions** (create session, search, etc.)"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Example: Developer Dashboard",
      "content": "### Example: Developer Dashboard\n\n```\n\u256d\u2500 Living Knowledge Dashboard \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502                                                           \u2502\n\u2502 OPEN SESSIONS                                             \u2502\n\u2502 \u25cf work-project (2 efforts) - active                      \u2502\n\u2502 \u25cf side-project (1 effort) - 2h ago                       \u2502\n\u2502                                                           \u2502\n\u2502 PRIORITY EFFORTS                                          \u2502\n\u2502 [open] Debug authentication bug - work-project           \u2502\n\u2502   \u2514\u2500 Last: \"Found issue in JWT validation\"              \u2502\n\u2502 [open] Add dark mode - side-project                      \u2502\n\u2502                                                           \u2502\n\u2502 RECENT CONCLUSIONS                                        \u2502\n\u2502 \u2713 Use Postgres over MySQL - work-project (2h ago)       \u2502\n\u2502 \u2713 API uses /v2/auth endpoint - work-project (yesterday) \u2502\n\u2502                                                           \u2502\n\u2502 STALE SESSIONS (conclude or archive?)                    \u2502\n\u2502 \u25cb gaming-research (concluded 3 days ago)                 \u2502\n\u2502 \u25cb weekend-idea (no activity, 7 days)                     \u2502\n\u2502                                                           \u2502\n\u2502 QUICK STATS                                               \u2502\n\u2502 12 open efforts \u00b7 45 facts \u00b7 3 active sessions           \u2502\n\u2502                                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 > Start talking or click above to resume context         \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Example: Writer Dashboard",
      "content": "### Example: Writer Dashboard\n\n```\n\u256d\u2500 Living Knowledge Dashboard \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256e\n\u2502                                                           \u2502\n\u2502 ACTIVE DRAFTS (sessions)                                  \u2502\n\u2502 \u25cf chapter-3-rewrite (2 efforts) - active                 \u2502\n\u2502 \u25cf story-outline (concluded) - yesterday                  \u2502\n\u2502                                                           \u2502\n\u2502 WRITING TASKS (efforts)                                   \u2502\n\u2502 [open] Fix pacing in Act 2 - chapter-3-rewrite          \u2502\n\u2502 [open] Research medieval armor - chapter-5               \u2502\n\u2502                                                           \u2502\n\u2502 CHARACTER NOTES (facts)                                   \u2502\n\u2502 \u2022 Elena: afraid of heights (backstory TBD)               \u2502\n\u2502 \u2022 Marcus: former soldier, scar on left arm               \u2502\n\u2502                                                           \u2502\n\u2502 COMPLETED TODAY                                           \u2502\n\u2502 \u2713 Finished first draft of chapter 3                      \u2502\n\u2502 \u2713 Decided on third-person POV                            \u2502\n\u2502                                                           \u2502\n\u2502 WORD COUNT: 12,450 across 3 active chapters              \u2502\n\u2502                                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 > Continue writing or click above to resume              \u2502\n\u2570\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u256f\n```\n\nSame primitives (sessions, efforts, facts), different dashboard!"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "The Vision",
      "content": "### The Vision\n\nDashboards **compose from primitives** and **emerge from usage**.\n\n**Primitives:**\n- Sessions (context containers)\n- Efforts (goals)\n- Facts (knowledge points)\n- Events (temporal context)\n- Artifacts (generic knowledge)\n\n**Dashboard = Views over primitives**"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "How It Works",
      "content": "### How It Works\n\n1. **Start with defaults**: All users see generic dashboard\n2. **Track usage patterns**: What does this user work on?\n3. **Suggest customizations**: \"Show open PRs as sessions?\"\n4. **User refines**: Drag, drop, configure widgets\n5. **Dashboard evolves**: Becomes personalized control panel"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Configuration Examples",
      "content": "### Configuration Examples\n\n```yaml\n# Developer dashboard config\ndashboard:\n  widgets:\n    - type: sessions\n      filter: status=open\n      sort: last_active\n      limit: 5\n\n    - type: efforts\n      filter: tags contains \"bug\"\n      title: \"Active Bugs\"\n\n    - type: facts\n      filter: tags contains \"api\"\n      title: \"API Documentation\"\n\n    - type: stats\n      show: [open_efforts, total_facts, active_sessions]\n```\n\n```yaml\n# Writer dashboard config\ndashboard:\n  widgets:\n    - type: sessions\n      filter: tags contains \"writing\"\n      title: \"Active Drafts\"\n\n    - type: efforts\n      filter: artifact_type=effort AND status=open\n      title: \"Writing Tasks\"\n\n    - type: facts\n      filter: tags contains \"character\"\n      title: \"Character Notes\"\n\n    - type: custom\n      query: \"count words in all sessions\"\n      title: \"Total Word Count\"\n```\n\n**Key insight**: Same knowledge network, personalized interface!"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Creating and Managing",
      "content": "### Creating and Managing\n\n```bash\n# Create new session\n> /session new work-auth\n> /session new work-auth [tags: work, debugging, urgent]\n\n# Switch sessions\n> /session switch personal\n> /session switch work-auth\n\n# List sessions\n> /session list\n> /session list --all  # Include concluded/archived\n\n# Rename\n> /session rename work-auth \u2192 auth-bug-fix\n\n# Conclude (mark as resolved)\n> /session conclude\n> /session conclude \"Fixed JWT validation bug\"\n\n# Archive (remove from main view)\n> /session archive gaming-research\n\n# Resume archived\n> /session resume gaming-research\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Context-Aware Commands",
      "content": "### Context-Aware Commands\n\nCommands are filtered based on current session:\n\n```bash\n# In open session with open effort:\nAvailable: /effort /fact /resolve /conclude /switch\n\n# In concluded session:\nAvailable: /resume /archive /switch\n\n# No active session:\nAvailable: /session new /session list\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "File Structure",
      "content": "### File Structure\n\n```\n~/.oi/\n  state.json                    # Global state (all artifacts)\n  sessions/\n    work-project.json           # Session with cached context\n    personal.json\n    gaming-research.json\n  chatlogs/\n    work-project.jsonl          # Permanent message log\n    personal.jsonl\n    gaming-research.jsonl\n  dashboards/\n    default.yaml                # Dashboard configuration\n    custom.yaml                 # User customization\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Session File Format",
      "content": "### Session File Format\n\n```javascript\n{\n  \"session_id\": \"work-project-abc123\",\n  \"name\": \"Debug authentication bug\",\n  \"status\": \"open\",\n  \"tags\": [\"work\", \"debugging\", \"auth\"],\n\n  // Cached context (artifact summaries)\n  \"artifacts_context\": {\n    \"text\": \"Open efforts:\\n1. Debug auth bug...\",\n    \"hash\": \"abc123def456\",\n    \"last_built\": \"2026-01-13T15:30:00Z\"\n  },\n\n  // Metadata\n  \"metadata\": {\n    \"created\": \"2026-01-13T10:00:00Z\",\n    \"last_active\": \"2026-01-13T15:30:00Z\",\n    \"message_count\": 24,\n    \"artifact_ids\": [\"effort-1\", \"fact-2\", \"event-3\"]\n  },\n\n  // Quick stats for dashboard\n  \"stats\": {\n    \"open_efforts\": 2,\n    \"resolved_efforts\": 1,\n    \"facts\": 3,\n    \"events\": 5\n  }\n}\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Context Builder Updates",
      "content": "### Context Builder Updates\n\n```python\ndef build_context(session_id: str) -> str:\n    \"\"\"Build context for a session with caching.\"\"\"\n\n    # Load session\n    session = load_session(session_id)\n\n    # Get current artifact hash\n    artifacts = get_session_artifacts(session_id)\n    current_hash = hash_artifacts(artifacts)\n\n    # Check cache\n    if current_hash == session.artifacts_context.hash:\n        # Cache hit - reuse\n        artifacts_text = session.artifacts_context.text\n    else:\n        # Cache miss - rebuild\n        artifacts_text = render_artifacts(artifacts)\n        session.artifacts_context = {\n            \"text\": artifacts_text,\n            \"hash\": current_hash,\n            \"last_built\": now()\n        }\n        save_session(session)\n\n    # Load recent messages\n    recent_messages = load_chatlog(session_id, limit=10)\n\n    # Assemble final context\n    context = f\"\"\"\n{system_prompt}\n\n{artifacts_text}\n\nRecent conversation:\n{recent_messages}\n\"\"\"\n\n    return context\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Dashboard Rendering",
      "content": "### Dashboard Rendering\n\n```python\nclass Dashboard:\n    def __init__(self, config: DashboardConfig):\n        self.widgets = load_widgets(config)\n\n    def render(self) -> str:\n        \"\"\"Render dashboard to text/terminal.\"\"\"\n        output = []\n\n        for widget in self.widgets:\n            data = widget.query()  # Query knowledge network\n            rendered = widget.render(data)  # Render to text\n            output.append(rendered)\n\n        return \"\\n\".join(output)\n\n# Usage\ndashboard = Dashboard.load_user_config()\nprint(dashboard.render())\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Flow 1: New User First Session",
      "content": "### Flow 1: New User First Session\n\n```\n1. User launches oi\n2. Dashboard shows: \"No sessions yet. Start talking or create a session.\"\n3. User types: \"help me debug this code\"\n4. System auto-creates session: \"session-2026-01-13\" (timestamp)\n5. User gets response\n6. System interprets: \"This is an effort\"\n7. Dashboard updates: \"1 open session, 1 open effort\"\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Flow 2: Returning User",
      "content": "### Flow 2: Returning User\n\n```\n1. User launches oi\n2. Dashboard shows:\n   - 2 open sessions (work-project, personal)\n   - 3 open efforts across sessions\n   - 2 recent conclusions\n3. User clicks \"work-project\" session\n4. Context loaded (cached artifacts + recent messages)\n5. User continues conversation\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Flow 3: Concluding Work",
      "content": "### Flow 3: Concluding Work\n\n```\n1. User finishes debugging\n2. User types: \"/resolve used JWT secret validation\"\n3. System resolves effort with resolution\n4. User types: \"/session conclude Fixed auth bug\"\n5. Session marked as concluded\n6. Dashboard updates: \"1 open session, 0 open efforts in work-project\"\n7. Session moves to \"concluded\" section\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Flow 4: Resuming Old Work",
      "content": "### Flow 4: Resuming Old Work\n\n```\n1. User sees \"gaming-research (concluded 3 days ago)\"\n2. User types: \"/session resume gaming-research\"\n3. System loads session context (cached)\n4. Shows: \"Resumed: gaming-research. Conclusion: Chose Logitech mouse\"\n5. User: \"actually, what about the Razer alternative?\"\n6. System reopens effort (was resolved, now open again)\n7. Session status changes: concluded \u2192 open\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Integration with Cascading Inference",
      "content": "## Integration with Cascading Inference\n\nSessions + cascading inference work together:\n\n```\nUser: \"/session new work-auth\"\n  \u2192 Command parsed (Level 1)\n  \u2192 Session created instantly\n  \u2192 No LLM call needed\n\nUser: \"debug this auth issue\"\n  \u2192 Session context loaded (cached artifacts)\n  \u2192 Main LLM responds\n  \u2192 Interpretation: Is this an effort?\n  \u2192 Cascading inference decides (command/pattern/local/remote)\n  \u2192 Artifact created in session\n\nUser: \"/resolve fixed it\"\n  \u2192 Command parsed (Level 1)\n  \u2192 Current open effort resolved\n  \u2192 Session stats updated\n  \u2192 No LLM call needed\n```\n\n**Commands work at session AND artifact level!**"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "1. Default Session Behavior",
      "content": "### 1. Default Session Behavior\n\n- Auto-create session on first message?\n- Require explicit `/session new`?\n- Use \"default\" session if none specified?"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "2. Session Isolation",
      "content": "### 2. Session Isolation\n\n- Are facts shared across sessions or isolated?\n- Can efforts span multiple sessions?\n- How to reference artifacts from other sessions?"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "3. Concluding Sessions",
      "content": "### 3. Concluding Sessions\n\n- Auto-conclude if all efforts resolved?\n- Require explicit `/session conclude`?\n- What happens to unresolved efforts?"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "4. Dashboard Defaults",
      "content": "### 4. Dashboard Defaults\n\n- What does first-time user dashboard look like?\n- When to suggest customization?\n- Community dashboard templates?"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "5. Context Size Limits",
      "content": "### 5. Context Size Limits\n\n- Max artifacts per session before suggesting split?\n- Max messages before suggesting conclude?\n- How to handle very long-running sessions?"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "6. Cross-Session Features",
      "content": "### 6. Cross-Session Features\n\n- Search across all sessions?\n- Link artifacts between sessions?\n- Merge sessions?\n- Session hierarchies (project \u2192 tasks)?"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Success Metrics",
      "content": "## Success Metrics\n\n**Efficiency:**\n- Context build time (should be near-instant with caching)\n- Cache hit rate (% of turns that reuse cached context)\n- Average session length before conclusion\n\n**User Experience:**\n- Time to find relevant context (dashboard vs chat list)\n- Session switch frequency\n- Dashboard customization adoption\n\n**Knowledge Quality:**\n- Artifacts per session (density)\n- Concluded vs abandoned sessions\n- Cross-session artifact references"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Session Analytics",
      "content": "### Session Analytics\n\n```bash\n> /session stats work-project\n\nSession: work-project\nCreated: 2026-01-10\nDuration: 3 days\nMessages: 247\nEfforts: 12 (8 resolved, 4 open)\nFacts: 23\nTokens used: ~125,000\nTokens saved via compression: ~850,000 (87% reduction)\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Session Graphs",
      "content": "### Session Graphs\n\nVisualize knowledge network for a session:\n\n```\nwork-project\n\u251c\u2500\u2500 [effort] Debug auth bug\n\u2502   \u251c\u2500\u2500 [fact] JWT uses HS256\n\u2502   \u251c\u2500\u2500 [fact] Secret stored in .env\n\u2502   \u2514\u2500\u2500 [resolved] Fixed validation logic\n\u251c\u2500\u2500 [effort] Refactor user service\n\u2502   \u2514\u2500\u2500 [open] Extract to separate module\n\u2514\u2500\u2500 [event] Team meeting discussed API changes\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Session Templates",
      "content": "### Session Templates\n\n```bash\n> /session new bug-fix --template=debugging\n\nCreated session: bug-fix\nTemplate: debugging\n  - Auto-tags: debugging, bug\n  - Pre-loaded facts: project structure, common issues\n  - Suggested efforts: reproduce bug, find root cause, fix, test\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Collaborative Sessions",
      "content": "### Collaborative Sessions\n\n```bash\n> /session share work-project --with=teammate@example.com\n> /session merge personal-research \u2192 team-project\n```"
    },
    {
      "source": "brainstorm\\sessions-and-dashboard.md",
      "heading": "Key Insights",
      "content": "## Key Insights\n\n> **Sessions replace chat history as the unit of context.**\n> Users build/load context explicitly rather than searching for the right chat.\n\n> **Context caching makes long sessions efficient.**\n> Rebuild artifacts context only when changed, reuse cached version otherwise.\n\n> **Dashboards are personalized entry points to knowledge networks.**\n> Same primitives, different views - emergent customization based on usage.\n\n> **Sessions are first-class artifacts with lifecycle states.**\n> Open, concluded, archived - just like efforts but at the workspace level.\n\n> **The interface layer should be as flexible as the knowledge layer.**\n> Composable primitives enable emergent, personalized experiences.\n\n---\n\n*Brainstormed: 2026-01-13*\n*Status: Design phase*\n*Dependencies: Cascading inference (slash commands), artifact system*\n*Next: Create slice spec, prototype session file format*"
    },
    {
      "source": "decisions\\001-scenario-before-stories.md",
      "heading": "Context",
      "content": "## Context\n\nWhile writing user stories for Slice 1a, we discovered a gap in the workflow:\n\n1. **Slice spec** defined features and scope\n2. **User stories** broke those into testable pieces\n\nBut the story agent kept adding implementation details (\"Context:\" blocks) into stories, and stories felt disconnected from the actual user experience."
    },
    {
      "source": "decisions\\001-scenario-before-stories.md",
      "heading": "Problem",
      "content": "## Problem\n\nWithout a cohesive narrative, user stories become:\n- Fragmented - each story exists in isolation\n- Ambiguous - unclear how features connect\n- Implementation-leaky - writers fill gaps with technical details\n\nThe spec says WHAT we're building. Stories say HOW to test it. But neither captures the **full experience** of using the feature."
    },
    {
      "source": "decisions\\001-scenario-before-stories.md",
      "heading": "Decision",
      "content": "## Decision\n\nAdd a **Scenario** step between slice spec and user stories:\n\n```\nSlice Spec \u2192 Scenario \u2192 User Stories\n(what)       (experience)  (testable)\n```\n\nThe scenario is a narrative walkthrough - a \"day in the life\" story that shows the complete experience from start to finish."
    },
    {
      "source": "decisions\\001-scenario-before-stories.md",
      "heading": "Format",
      "content": "## Format\n\nA scenario document contains:\n1. **The Session** - narrative prose describing a realistic usage session\n2. **What I Observed** - summary of observable behaviors\n3. **What I Didn't Have To Do** - implicit expectations made explicit"
    },
    {
      "source": "decisions\\001-scenario-before-stories.md",
      "heading": "Benefits",
      "content": "## Benefits\n\n1. **Locks in expectations** before breaking into stories\n2. **Catches gaps** - if you can't narrate it, something's missing\n3. **Grounds stories** - story writers have a reference for the experience\n4. **Prevents implementation leak** - stories can focus on observable behavior because the scenario already established context"
    },
    {
      "source": "decisions\\001-scenario-before-stories.md",
      "heading": "Example",
      "content": "## Example\n\n**Without scenario:**\nStory agent writes: \"Context: There is ONE continuous conversation. When a conclusion is extracted, it replaces the verbose thread...\"\n\n**With scenario:**\nStory agent reads narrative of user exiting and restarting, writes: \"Acceptance: I restart the CLI, my previous conclusions are still there\"\n\nThe scenario absorbed the context, so stories stay clean."
    },
    {
      "source": "decisions\\001-scenario-before-stories.md",
      "heading": "Future",
      "content": "## Future\n\nWe may create a dedicated scenario agent for this step, but will learn from manual creation first."
    },
    {
      "source": "decisions\\002-hybrid-testing-approach.md",
      "heading": "Context",
      "content": "## Context\n\nBefore starting implementation of Slice 1a, we considered two approaches:\n\n1. **TDD (Test-Driven Development)** - Write tests first based on user stories, then implement\n2. **Dev First** - Build the prototype, add tests later"
    },
    {
      "source": "decisions\\002-hybrid-testing-approach.md",
      "heading": "Problem",
      "content": "## Problem\n\nThis system has two types of behavior:\n\n**Deterministic:**\n- Persistence (save/load state)\n- Token counting\n- Data structures (Thread, Conclusion, ConversationState)\n- Context building (assembling prompt from conclusions + active thread)\n\n**Non-deterministic (LLM-dependent):**\n- Conclusion detection (did user disagree?)\n- Conclusion extraction (summarize the resolution)\n- Topic change detection\n\nTDD works well for deterministic code. But testing LLM behavior upfront is problematic:\n- Outputs vary between runs\n- Detection thresholds need tuning through experimentation\n- We don't know the exact patterns until we see real conversations"
    },
    {
      "source": "decisions\\002-hybrid-testing-approach.md",
      "heading": "Decision",
      "content": "## Decision\n\n**Hybrid approach:**\n\n1. **Dev with inline tests for deterministic parts**\n   - Persistence: test save/load roundtrip\n   - Token counting: test calculation accuracy\n   - Data structures: test serialization/deserialization\n   - Context building: test prompt assembly\n\n2. **Manual validation for LLM-dependent parts**\n   - Run real conversations\n   - Observe detection behavior\n   - Tune prompts and thresholds\n   - Add integration tests once patterns stabilize"
    },
    {
      "source": "decisions\\002-hybrid-testing-approach.md",
      "heading": "Rationale",
      "content": "## Rationale\n\n1. **Speed matters** - This is a research prototype to prove a thesis\n2. **LLM behavior needs iteration** - We'll learn what works through experimentation\n3. **Deterministic code should be tested** - No excuse for bugs in save/load or token counting\n4. **Premature tests create friction** - Testing LLM outputs before we understand them leads to flaky tests"
    },
    {
      "source": "decisions\\002-hybrid-testing-approach.md",
      "heading": "What Gets Tested (During Dev)",
      "content": "## What Gets Tested (During Dev)\n\n| Component | Testable? | Approach |\n|-----------|-----------|----------|\n| State persistence | Yes | Unit tests |\n| Token counting | Yes | Unit tests |\n| Data structures | Yes | Unit tests |\n| Context builder | Yes | Unit tests |\n| Disagreement detection | Later | Manual first, then integration tests |\n| Conclusion extraction | Later | Manual first, then integration tests |"
    },
    {
      "source": "decisions\\002-hybrid-testing-approach.md",
      "heading": "What Gets Validated Manually",
      "content": "## What Gets Validated Manually\n\n- Conclusion triggers at the right moments\n- Extracted conclusions are accurate summaries\n- Context building produces coherent prompts\n- The overall flow feels natural"
    },
    {
      "source": "decisions\\002-hybrid-testing-approach.md",
      "heading": "Future",
      "content": "## Future\n\nOnce the LLM-dependent behavior stabilizes:\n1. Capture example conversations as fixtures\n2. Write integration tests against those fixtures\n3. Use snapshot testing for prompt construction"
    },
    {
      "source": "decisions\\003-external-prompt-files.md",
      "heading": "Context",
      "content": "## Context\n\nSystem prompts for LLM operations (like conclusion extraction) were initially hardcoded in Python."
    },
    {
      "source": "decisions\\003-external-prompt-files.md",
      "heading": "Decision",
      "content": "## Decision\n\nStore all system prompts in external markdown files under `src/oi/prompts/`."
    },
    {
      "source": "decisions\\003-external-prompt-files.md",
      "heading": "Reasoning",
      "content": "## Reasoning\n\n1. **Iterate without code changes** - Tweak prompts by editing markdown, no Python changes needed\n2. **Version control clarity** - Git diff shows exactly how prompts evolved over time\n3. **Self-documenting** - Prompt files serve as documentation of system behavior\n4. **Testable** - Can A/B test different prompt versions by swapping files"
    },
    {
      "source": "decisions\\003-external-prompt-files.md",
      "heading": "Structure",
      "content": "## Structure\n\n```\nsrc/oi/prompts/\n\u251c\u2500\u2500 conclusion_extraction.md\n\u2514\u2500\u2500 (future prompts...)\n```"
    },
    {
      "source": "decisions\\003-external-prompt-files.md",
      "heading": "Implementation",
      "content": "## Implementation\n\n```python\ndef load_prompt(name: str) -> str:\n    prompt_path = PROMPTS_DIR / f\"{name}.md\"\n    return prompt_path.read_text(encoding=\"utf-8\").strip()\n```"
    },
    {
      "source": "decisions\\004-thread-context-linking.md",
      "heading": "Context",
      "content": "## Context\n\nThreads can be follow-ups to previous discussions. Without context, messages like \"What about water?\" are meaningless - water in relation to what?"
    },
    {
      "source": "decisions\\004-thread-context-linking.md",
      "heading": "Problem",
      "content": "## Problem\n\nHow do we make threads self-contained and understandable without modifying the chat history?"
    },
    {
      "source": "decisions\\004-thread-context-linking.md",
      "heading": "Options Considered",
      "content": "## Options Considered\n\n1. **Thread linking** - Store `related_conclusion_ids`, traverse links to build context on read\n2. **Context field** - Store text snapshot of relevant conclusions when thread starts\n3. **Message expansion** - Rewrite ambiguous messages to be self-contained"
    },
    {
      "source": "decisions\\004-thread-context-linking.md",
      "heading": "Decision",
      "content": "## Decision\n\nUse **conclusion ID linking** (variant of option 1, but with simple lookup not traversal).\n\n```python\nclass Thread:\n    context_conclusion_ids: list[str]  # IDs of conclusions that provide context\n```"
    },
    {
      "source": "decisions\\004-thread-context-linking.md",
      "heading": "Reasoning",
      "content": "## Reasoning\n\n**Option 3 rejected**: Modifying chat history breaks trust. The history should be a faithful record of what was actually said, not a cleaned-up version.\n\n**Option 2 rejected**: Duplicates data that already exists in conclusions.\n\n**Option 1 chosen** because:\n- Conclusions already exist as standalone knowledge - reuse them\n- No data duplication\n- Simple ID lookup (O(1) with dict), not chain traversal\n- Thread remains a faithful record of what was said\n- Context is recoverable by looking up the linked conclusions"
    },
    {
      "source": "decisions\\004-thread-context-linking.md",
      "heading": "Example",
      "content": "## Example\n\n```json\n{\n  \"id\": \"thread-2\",\n  \"messages\": [{\"role\": \"user\", \"content\": \"What about water?\"}],\n  \"context_conclusion_ids\": [\"abc123\"]\n}\n```\n\nLook up `abc123` \u2192 \"Plants require sunlight for photosynthesis...\"\n\nNow \"What about water?\" makes sense: it's asking about water in the context of plant biology."
    },
    {
      "source": "decisions\\005-knowledge-statement-conclusions.md",
      "heading": "Context",
      "content": "## Context\n\nInitial implementation summarized conversations:\n> \"The user asked why plants need water, and the assistant explained it's essential for photosynthesis.\"\n\nThis is meta-information about what happened, not extracted knowledge."
    },
    {
      "source": "decisions\\005-knowledge-statement-conclusions.md",
      "heading": "Decision",
      "content": "## Decision\n\nConclusions should be standalone knowledge statements:\n> \"Water is essential for plants for photosynthesis and nutrient transport.\""
    },
    {
      "source": "decisions\\005-knowledge-statement-conclusions.md",
      "heading": "Reasoning",
      "content": "## Reasoning\n\n1. **Knowledge network, not conversation archive** - We're building a graph of facts, not a log of discussions\n2. **Standalone meaning** - Each conclusion should be meaningful without knowing there was a conversation\n3. **Reusable context** - Knowledge statements can inform future threads directly\n4. **Composable** - Facts can be combined, cross-referenced, and built upon"
    },
    {
      "source": "decisions\\005-knowledge-statement-conclusions.md",
      "heading": "Implementation",
      "content": "## Implementation\n\nUpdated prompt in `src/oi/prompts/conclusion_extraction.md`:\n\n```\nExtract the key fact or conclusion from this conversation.\nState it as standalone knowledge - not as a summary of what was discussed.\nBe concise - one sentence.\n```"
    },
    {
      "source": "decisions\\005-knowledge-statement-conclusions.md",
      "heading": "Before/After",
      "content": "## Before/After\n\n| Before (conversation summary) | After (knowledge statement) |\n|-------------------------------|----------------------------|\n| \"The user asked why plants need water, and the assistant explained...\" | \"Water is essential for plants for photosynthesis and nutrient transport.\" |"
    },
    {
      "source": "decisions\\006-storage-json-for-now.md",
      "heading": "Context",
      "content": "## Context\n\nSingle JSON file won't scale forever. Discussed alternatives: file sharding, SQLite, graph databases."
    },
    {
      "source": "decisions\\006-storage-json-for-now.md",
      "heading": "Decision",
      "content": "## Decision\n\nUse JSON with a split structure:\n\n```\n~/.oi/\n\u251c\u2500\u2500 network.json        # Conclusions + metadata (small, always loaded)\n\u2514\u2500\u2500 threads/\n    \u2514\u2500\u2500 {thread-id}.json  # Individual thread files (loaded on demand)\n```"
    },
    {
      "source": "decisions\\006-storage-json-for-now.md",
      "heading": "Reasoning",
      "content": "## Reasoning\n\n1. **Conclusions are primary** - The knowledge network is what matters; threads are source material\n2. **Network stays small** - Only conclusions and metadata, loads fast every time\n3. **Threads isolated** - Old threads don't bloat the main file\n4. **Load on demand** - Only active thread loaded; concluded threads stay on disk\n5. **Still simple JSON** - Inspectable, debuggable, no dependencies"
    },
    {
      "source": "decisions\\006-storage-json-for-now.md",
      "heading": "Structure",
      "content": "## Structure\n\n**network.json**:\n- `conclusions[]` - The knowledge network\n- `active_thread_id` - Reference to current thread (if any)\n- `token_stats` - Aggregate statistics\n\n**threads/{id}.json**:\n- `id`, `messages[]`, `status`, `conclusion_id`\n- `context_conclusion_ids[]` - Links to conclusions that provide context"
    },
    {
      "source": "decisions\\006-storage-json-for-now.md",
      "heading": "Future Options",
      "content": "## Future Options\n\nWhen scale becomes an issue:\n\n| Option | Pros | Cons |\n|--------|------|------|\n| SQLite | Built-in, ACID, indexes, FTS | Still a file abstraction |\n| Graph DB | Native to knowledge network structure | Added dependency |"
    },
    {
      "source": "decisions\\006-storage-json-for-now.md",
      "heading": "Migration Path",
      "content": "## Migration Path\n\nThe current model translates directly to relational:\n- `conclusions` table\n- `threads` table\n- `messages` table\n- `thread_context` junction table (thread_id, conclusion_id)\n\nWhen ready, swap `storage.py` implementation - the rest of the system doesn't need to know."
    },
    {
      "source": "decisions\\007-sqlite-storage.md",
      "heading": "Context",
      "content": "## Context\n\nWe went through several iterations trying to make JSON files work:\n1. Single `state.json` - grows unbounded\n2. Split `network.json` + `threads/{id}.json` - multiple files, still loads everything\n3. JSONL for history - better append, but can't index\n4. Individual conclusion files - filesystem as database\n\nEach fix added complexity to work around JSON's fundamental limitation: **you can't do JIT (Just-In-Time) access without loading the whole file**."
    },
    {
      "source": "decisions\\007-sqlite-storage.md",
      "heading": "Reasoning",
      "content": "## Reasoning\n\nSQLite solves everything natively:\n\n| Need | JSON Workaround | SQLite |\n|------|-----------------|--------|\n| JIT by ID | Individual files or load all | Indexed primary key, O(1) |\n| Chronological access | JSONL, read backwards | `ORDER BY timestamp DESC LIMIT N` |\n| Append without rewrite | JSONL | Just INSERT |\n| Search | Load all, filter in memory | SQL queries, FTS if needed |\n| Relationships | Manual ID linking | Foreign keys, JOINs |\n| ACID | Manual file handling | Built-in transactions |\n\nAdditional benefits:\n- **Built into Python** - zero dependencies\n- **Single file** - still portable (`oi.db`)\n- **Battle-tested** - billions of deployments\n- **Future-proof** - can add indexes, FTS, etc."
    },
    {
      "source": "decisions\\007-sqlite-storage.md",
      "heading": "Schema",
      "content": "## Schema\n\n```sql\n-- The knowledge network\nCREATE TABLE conclusions (\n    id TEXT PRIMARY KEY,\n    content TEXT NOT NULL,\n    source_thread_id TEXT NOT NULL,\n    created TEXT NOT NULL\n);\n\n-- Conversation threads\nCREATE TABLE threads (\n    id TEXT PRIMARY KEY,\n    status TEXT NOT NULL DEFAULT 'open',\n    conclusion_id TEXT,\n    created TEXT NOT NULL\n);\n\n-- Thread context links (many-to-many)\nCREATE TABLE thread_context (\n    thread_id TEXT NOT NULL,\n    conclusion_id TEXT NOT NULL,\n    PRIMARY KEY (thread_id, conclusion_id)\n);\n\n-- Messages within threads\nCREATE TABLE messages (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    thread_id TEXT NOT NULL,\n    role TEXT NOT NULL,\n    content TEXT NOT NULL,\n    timestamp TEXT NOT NULL\n);\n\n-- Chronological history log\nCREATE TABLE history (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    type TEXT NOT NULL,      -- 'event' or 'knowledge'\n    label TEXT,              -- for events: 'greeting', etc.\n    thread_id TEXT,\n    conclusion_id TEXT,      -- for knowledge entries\n    timestamp TEXT NOT NULL\n);\n\n-- Singleton tables for global state\nCREATE TABLE token_stats (id INTEGER PRIMARY KEY CHECK (id = 1), ...);\nCREATE TABLE state (id INTEGER PRIMARY KEY CHECK (id = 1), active_thread_id TEXT);\n```"
    },
    {
      "source": "decisions\\007-sqlite-storage.md",
      "heading": "JIT Access Patterns",
      "content": "## JIT Access Patterns\n\n```python\n# Load only what you need\nconclusion = load_conclusion(\"abc123\")  # Single row lookup\n\n# Recent history (backwards chronological)\nrecent = load_recent_history(limit=10)  # Last 10 entries\n\n# Active thread only\nthread = load_thread(active_thread_id)  # Don't load concluded threads\n```"
    },
    {
      "source": "decisions\\007-sqlite-storage.md",
      "heading": "Migration",
      "content": "## Migration\n\nThe JSON files (`network.json`, `threads/`) are no longer used. The database file is `~/.oi/oi.db`."
    },
    {
      "source": "decisions\\007-sqlite-storage.md",
      "heading": "Lesson Learned",
      "content": "## Lesson Learned\n\nDon't patch around fundamental limitations. When you find yourself adding complexity layer after layer, step back and ask if the underlying choice is wrong."
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Context",
      "content": "## Context\n\nThe original slice roadmap targeted a generic AI conversation system with:\n- Conclusion-triggered compaction\n- Knowledge graph\n- Abstraction layers\n- Conflict resolution\n- Emergent confidence\n\nThrough extensive brainstorming, we realized:\n\n1. **The system is primitives + applications** - primitives are domain-agnostic, applications are configurations\n2. **Dev workflow is the first application** - and will be used to build everything else\n3. **2025 dev is PO-centric** - brainstorming, contracts, documentation - not touching code\n4. **We designed significant new concepts** that weren't in the original slices:\n   - Two-log model (raw + manifest)\n   - Continuous capture\n   - Effort weight / context budget\n   - Peer agent model with kanban coordination\n   - Stateless escalation via failure_count\n   - Human cognitive model (temporal grounding, progress visibility)\n\n---"
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Decision",
      "content": "## Decision\n\n**Pivot from generic AI slices to dev-first slices.**\n\nThe new slice roadmap:\n1. Targets development/documentation/brainstorming workflows\n2. Incorporates all concepts designed in this session\n3. Builds the TDD pipeline as the first application\n4. Will generalize later by expanding, not by returning to old generic slices\n\n---"
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Why dev-first?",
      "content": "### Why dev-first?\n\n1. **Self-hosting** - The system builds itself. Dev tooling is needed first.\n2. **Concrete use case** - Generic AI is vague. TDD pipeline is specific and testable.\n3. **Informed generalization** - Building dev-first teaches us what primitives actually need.\n4. **Immediate value** - We can use it while building it."
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Why not keep old slices?",
      "content": "### Why not keep old slices?\n\n1. **Superseded** - New concepts (two-log, continuous capture, peer agents) weren't in old slices\n2. **Not implementation-ready** - Old slices were brainstorm-level, not detailed\n3. **Git preserves history** - Can always look back if needed\n4. **Expansion not regression** - Generalization will expand dev system, not return to old generic\n\n---"
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Positive",
      "content": "### Positive\n- Clear focus on concrete deliverable (dev pipeline)\n- All session insights incorporated from the start\n- System can be used while being built"
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Negative",
      "content": "### Negative\n- Delays generic AI features (knowledge graph, abstraction layers, etc.)\n- Old slice docs become obsolete"
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Mitigations",
      "content": "### Mitigations\n- Generic features become later slices (after dev pipeline works)\n- Old docs replaced, not archived (git history suffices)\n\n---"
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "New Slice Roadmap",
      "content": "## New Slice Roadmap\n\nSee [slices/README.md](../slices/README.md) for the dev-first roadmap.\n\n---"
    },
    {
      "source": "decisions\\008-dev-first-pivot.md",
      "heading": "Related Documents",
      "content": "## Related Documents\n\n- [effort-scoped-context.md](../brainstorm/effort-scoped-context.md) - Core model\n- [context-and-cognition.md](../brainstorm/context-and-cognition.md) - Two-log, continuous capture\n- [peer-agent-scenario.md](../scenarios/peer-agent-scenario.md) - Peer agent model\n- [agent-communication.md](../brainstorm/agent-communication.md) - Disputes, escalation\n- [tech-stack.md](../tech-stack.md) - Primitives + applications framing\n- [thesis.md](../thesis.md) - Updated with primitives framing"
    },
    {
      "source": "decisions\\009-pipeline-drives-knowledge-network.md",
      "heading": "Context",
      "content": "## Context\n\nWe identified two distinct modes of operation:\n\n| Mode | Description | Context Pattern |\n|------|-------------|-----------------|\n| **Pipeline Step** | Agent runs, produces artifact | Clean in \u2192 work \u2192 clean out. Short-lived context. |\n| **Interactive Session** | User + AI back-and-forth | Accumulating context. Needs auto-compaction. |\n\nThe knowledge network's auto-compaction (two-log model, streaming capture) is valuable for **interactive sessions** where context accumulates and needs management.\n\nFor **pipeline steps**, artifacts themselves serve as the compaction boundary:\n- Agent receives artifact (clean input)\n- Agent produces artifact (clean output)\n- Internal \"work\" context is discarded after step completes\n- No need for sophisticated context management within short-lived agent runs"
    },
    {
      "source": "decisions\\009-pipeline-drives-knowledge-network.md",
      "heading": "Decision",
      "content": "## Decision\n\n**The pipeline project drives the knowledge network project.**\n\nInstead of:\n```\n1. Build knowledge network primitives\n2. Build pipeline on top\n```\n\nWe will:\n```\n1. Build pipeline (agents, artifacts, workflow)\n2. When pipeline needs a knowledge network feature, add it\n3. Features are driven by real usage, not speculation\n```"
    },
    {
      "source": "decisions\\009-pipeline-drives-knowledge-network.md",
      "heading": "Knowledge Network (this project)",
      "content": "### Knowledge Network (this project)\n- **Pause active development** until pipeline needs drive it\n- Current state (models, basic storage) is sufficient for pipeline v1\n- Interactive session features (two-log, auto-compaction) wait until needed"
    },
    {
      "source": "decisions\\009-pipeline-drives-knowledge-network.md",
      "heading": "Open Intelligence (sibling project)",
      "content": "### Open Intelligence (sibling project)\n- **Primary development focus**\n- Build CLI, agents, artifact workflow\n- When we add interactive brainstorm mode \u2192 pull in knowledge network features"
    },
    {
      "source": "decisions\\009-pipeline-drives-knowledge-network.md",
      "heading": "Slice 1 Reframing",
      "content": "### Slice 1 Reframing\n- Original Slice 1 mixed pipeline + knowledge network concerns\n- For pipeline-only mode: artifacts are the interface, no two-log needed\n- Two-log model becomes relevant when we add interactive sessions"
    },
    {
      "source": "decisions\\009-pipeline-drives-knowledge-network.md",
      "heading": "What We Learned",
      "content": "## What We Learned\n\n1. **Artifacts are context boundaries** - Clean handoff between agents\n2. **Auto-compaction solves interactive accumulation** - Not needed for agent steps\n3. **Let usage drive features** - Don't build primitives in isolation"
    },
    {
      "source": "decisions\\009-pipeline-drives-knowledge-network.md",
      "heading": "Related",
      "content": "## Related\n\n- [thesis.md](../thesis.md) - Original knowledge network vision (still valid, just deferred)\n- [008-dev-first-pivot.md](./008-dev-first-pivot.md) - Earlier decision to specialize for dev"
    },
    {
      "source": "lessons-learned\\001-premature-optimization.md",
      "heading": "What Happened",
      "content": "## What Happened\n\n1. Started with simple JSON storage\n2. Discussed theoretical scaling concerns\n3. Spent effort migrating to SQLite (schema, tests, etc.)\n4. Concept evolved significantly during brainstorming\n5. SQLite schema became baggage - harder to pivot"
    },
    {
      "source": "lessons-learned\\001-premature-optimization.md",
      "heading": "The Mistake",
      "content": "## The Mistake\n\nOptimized for scale before proving the concept.\n\nWe didn't know the model would evolve from:\n- \"threads + conclusions\"\n- \u2192 \"efforts + conclusions\"\n- \u2192 \"self-evolving artifact schemas with reference-weighted expiration\"\n\nEach pivot would have required schema migrations, test updates, etc."
    },
    {
      "source": "lessons-learned\\001-premature-optimization.md",
      "heading": "The Lesson",
      "content": "## The Lesson\n\n**Prove the concept first. Optimize when you know what you're optimizing FOR.**\n\n- Simple JSON files are easier to inspect, modify, debug\n- Schema changes are trivial (just change the structure)\n- No migrations, no SQL changes\n- Can look at the data directly in any editor"
    },
    {
      "source": "lessons-learned\\001-premature-optimization.md",
      "heading": "When to Optimize",
      "content": "## When to Optimize\n\n- When the model is stable\n- When you hit actual (not theoretical) scaling issues\n- When the cost of NOT optimizing is real"
    },
    {
      "source": "lessons-learned\\001-premature-optimization.md",
      "heading": "Applied",
      "content": "## Applied\n\nReverted to simple JSON storage. SQLite can come back when:\n1. The artifact/schema model is proven and stable\n2. We have actual data showing performance problems"
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "1. Executive Summary",
      "content": "## 1. Executive Summary\n\nThis document compares retrieval architectures for AI systems. It delineates the distinction between probabilistic retrieval (**Vector/Similarity**) and deterministic retrieval (**Graph/Understanding**), while also addressing high-performance non-semantic optimization techniques (**Binary Evaluation**)."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "2. Core Retrieval Paradigms: Vector vs. Graph",
      "content": "## 2. Core Retrieval Paradigms: Vector vs. Graph\n\nThe primary architectural decision in RAG is defining how data is retrieved: by **mathematical proximity** or by **explicit relationship**."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "2.1 Vector Database (The \"Similarity\" Engine)",
      "content": "### 2.1 Vector Database (The \"Similarity\" Engine)\n\n* **Mechanism:** Converts text into high-dimensional vectors (embeddings). Retrieval is based on calculating distance (e.g., Cosine Similarity) in vector space.\n* **Core Logic:** \"Find data that 'looks' or 'feels' like this query.\"\n* **Best For:** Unstructured text, fuzzy matching, semantic search, broad topic exploration.\n* **Limitation:** \"The Hallucination of Relevance.\" It may retrieve semantically similar but factually irrelevant data. It struggles with multi-step reasoning."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "2.2 Graph Database / Knowledge Graph (The \"Understanding\" Engine)",
      "content": "### 2.2 Graph Database / Knowledge Graph (The \"Understanding\" Engine)\n\n* **Mechanism:** Stores data as **Nodes** (Entities) and **Edges** (Relationships). Retrieval is based on traversing explicit paths.\n* **Core Logic:** \"Traverse the specific path connecting Entity A to Entity B.\"\n* **Best For:** Structured data, complex reasoning, supply chains, fraud detection, corporate hierarchies.\n* **Limitation:** Rigid schema. If a relationship is not explicitly defined, it cannot be traversed."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "2.3 Comparative Analysis",
      "content": "### 2.3 Comparative Analysis\n\n| Feature | Vector Database | Graph Database |\n|---------|-----------------|----------------|\n| **Search Basis** | Probabilistic (Similarity) | Deterministic (Connection) |\n| **Data Structure** | Embeddings (Float Arrays) | Nodes & Edges (Adjacency Lists) |\n| **Query Type** | \"Find similar concepts\" | \"Find connected entities\" |\n| **Reasoning** | Single-hop / Contextual | Multi-hop / Logical |\n| **Blind Spot** | Precision (Exact values) | Unstructured / Unknown connections |"
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "3. Storage Layer: NoSQL Landscape",
      "content": "## 3. Storage Layer: NoSQL Landscape\n\nA Graph Database is a subset of the NoSQL family. Understanding the distinction is crucial for storage selection."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "3.1 The \"Aggregate\" Family (Document & Key-Value)",
      "content": "### 3.1 The \"Aggregate\" Family (Document & Key-Value)\n\n* **Examples:** MongoDB, DynamoDB, Redis.\n* **Philosophy:** Keep related data together in one blob.\n* **Structure:** JSON Documents or Key-Value pairs.\n* **Performance:** Fast for retrieving *single items* or *lists*. Slow for joining data.\n* **RAG Role:** Storing the raw \"chunks\" of text that vectors point to."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "3.2 The \"Connection\" Family (Graph)",
      "content": "### 3.2 The \"Connection\" Family (Graph)\n\n* **Examples:** Neo4j, Amazon Neptune.\n* **Philosophy:** Break data apart to link it. Relationships are \"first-class citizens\" stored physically on disk.\n* **Structure:** Nodes and Pointers.\n* **Performance:** Constant time for traversing relationships (index-free adjacency).\n* **RAG Role:** Providing the \"ground truth\" or \"skeleton\" of facts to ground the AI."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "4. High-Performance \"Binary\" Primitives",
      "content": "## 4. High-Performance \"Binary\" Primitives\n\nWhile Vector Search (Float32 math) is computationally expensive, modern stacks utilize binary logic for speed and precision."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "4.1 Roaring Bitmaps (Logical Filtering)",
      "content": "### 4.1 Roaring Bitmaps (Logical Filtering)\n\n* **Concept:** Represents sets of document IDs as compressed bitmaps.\n* **Operation:** Uses CPU-level bitwise instructions (AND, OR, XOR) to filter millions of documents in microseconds.\n* **Use Case:** Hard filtering *before* vector search (e.g., \"Only search documents where Status=Active AND Region=US\").\n* **Speed:** Near-instant (Non-semantic)."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "4.2 Binary Quantization (Optimized Semantic Search)",
      "content": "### 4.2 Binary Quantization (Optimized Semantic Search)\n\n* **Concept:** Compresses 1024-dimensional float vectors into binary strings (1s and 0s).\n  * Positive float \u2192 1\n  * Negative float \u2192 0\n* **Operation:** Uses **Hamming Distance** (XOR + Popcount) instead of Cosine Similarity.\n* **Benefit:** Reduces memory usage by ~32x and increases search speed by ~30x-100x.\n* **Trade-off:** Slight loss in precision, often mitigated by re-ranking the top results."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "4.3 Protocol Buffers (Compact Serialization)",
      "content": "### 4.3 Protocol Buffers (Compact Serialization)\n\n* **Concept:** A language-neutral, platform-neutral extensible mechanism for serializing structured data.\n* **Use Case:** Storing the actual retrieved data (Forward Index) efficiently. Far smaller and faster to parse than JSON."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "5. Decision Matrix: Choosing the Stack",
      "content": "## 5. Decision Matrix: Choosing the Stack\n\nUse this matrix to determine the components of your RAG pipeline."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "Scenario A: The \"chatbot for documentation\"",
      "content": "### Scenario A: The \"chatbot for documentation\"\n\n* **Data:** Unstructured PDFs, Help Docs.\n* **User Intent:** \"How do I reset my password?\"\n* **Recommended Stack:**\n  * **Vector DB:** Yes (Primary retrieval).\n  * **Graph DB:** No (Overkill).\n  * **Binary Filter:** Basic (e.g., filter by product version)."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "Scenario B: The \"Forensic Analyst\"",
      "content": "### Scenario B: The \"Forensic Analyst\"\n\n* **Data:** Financial transactions, emails, corporate entities.\n* **User Intent:** \"Who authorized the payment to the vendor owned by the CEO's brother?\"\n* **Recommended Stack:**\n  * **Graph DB:** Yes (Crucial for linking Person \u2192 Company \u2192 Transaction).\n  * **Vector DB:** Secondary (For searching email text).\n  * **Architecture:** **GraphRAG** (Hybrid)."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "Scenario C: The \"Scale-at-all-costs\" System",
      "content": "### Scenario C: The \"Scale-at-all-costs\" System\n\n* **Data:** Billions of log lines or user comments.\n* **Constraint:** Must return results in <50ms.\n* **Recommended Stack:**\n  * **Binary Quantization:** Mandatory (Vectors converted to bits).\n  * **Roaring Bitmaps:** Mandatory (For metadata filtering).\n  * **Protocol Buffers:** Mandatory (For data transport).\n  * **Graph:** Only if pre-computed."
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "6. Summary: The Modern Hybrid Stack",
      "content": "## 6. Summary: The Modern Hybrid Stack\n\nThe most robust RAG systems currently deploy a **Hybrid Architecture**:\n\n1. **Ingestion:** Text is chunked (Vectorized) AND entities are extracted (Graph).\n2. **Query Processing:**\n   * **Step 1 (Binary Filter):** Use **Roaring Bitmaps** to restrict search space (e.g., Date > 2023).\n   * **Step 2 (Retrieval):** Run parallel searches:\n     * **Lexical:** Keyword match for precision (IDs, Codes).\n     * **Vector (Binary Quantized):** Semantic match for intent.\n     * **Graph:** Traversal for related context.\n3. **Synthesis:** Combine results and feed to LLM.\n\n---"
    },
    {
      "source": "research\\rag-architecture-reference.md",
      "heading": "Relevance to Knowledge Network",
      "content": "## Relevance to Knowledge Network\n\nThis aligns with our Thesis 2 (Dynamic Knowledge Network) and Thesis 5 (Emergent Confidence):\n\n| Knowledge Network Need | RAG Component |\n|------------------------|---------------|\n| \"What do I know about X?\" | Vector (semantic search) |\n| Support/contradiction edges | Graph (relationship traversal) |\n| Confidence propagation | Graph (topology algorithms) |\n| Abstraction hierarchy | Graph (multi-hop traversal) |\n\n**Recommendation:** Hybrid approach - see tech-stack discussion."
    },
    {
      "source": "research\\recursive-language-models.md",
      "heading": "Summary",
      "content": "## Summary\n\nRLMs enable LLMs to process inputs up to 100x longer than their context window through recursive decomposition. The model receives symbolic handles to prompts (not full content) and can programmatically examine, decompose, and recursively call itself over snippets.\n\nKey results:\n- RLM(GPT-5) achieves 28% improvement on long-context tasks\n- Scales to 10M+ tokens\n- RLM-Qwen3-8B (small native model) approaches GPT-5 performance"
    },
    {
      "source": "research\\recursive-language-models.md",
      "heading": "Relationship to This Project",
      "content": "## Relationship to This Project\n\n**Orthogonal, not competing.** RLMs and our thesis solve different problems:\n\n| | RLMs | Knowledge Network |\n|---|------|-------------------|\n| Problem | Process long inputs | Accumulate knowledge |\n| Scope | Single inference | Across sessions |\n| Output | Answer | Growing graph |"
    },
    {
      "source": "research\\recursive-language-models.md",
      "heading": "Potential Integration",
      "content": "## Potential Integration\n\nRLMs could serve as the **processing layer** for the knowledge network:\n\n```\nLong conversation history\n         \u2502\n         \u25bc\n      [RLMs]  \u2190 Handle massive context\n         \u2502\n         \u25bc\n  Conclusion extraction\n         \u2502\n         \u25bc\n  [Knowledge Network]  \u2190 Persist & connect\n```\n\nThe \"symbolic handles + metadata\" approach validates our \"conclusion + link\" architecture - both maintain access to full content while working with compressed representations."
    },
    {
      "source": "research\\recursive-language-models.md",
      "heading": "Future Work",
      "content": "## Future Work\n\n- Explore RLM-style decomposition for processing large knowledge graphs\n- Consider RLMs for querying across many historical sessions\n- Evaluate whether RLM training approach applies to conclusion extraction"
    },
    {
      "source": "research\\recursive-language-models.md",
      "heading": "References",
      "content": "## References\n\n- Full paper: https://arxiv.org/abs/2512.24601\n- Code: Available on GitHub (see paper)"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "The Setup",
      "content": "## The Setup\n\nSometimes you don't have an idea\u2014you have a **problem**. Something's wrong, players are frustrated, metrics are dropping. The solution isn't obvious.\n\n```\nProblem Signal \u2192 Investigation \u2192 Research \u2192 Solution Discovery \u2192 Brainstorm Artifact\n```\n\nThis is **discovery work**. You're not refining an idea; you're finding one.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Artifacts & Kanban",
      "content": "## Artifacts & Kanban\n\nAll state is local. Artifacts carry their own status via frontmatter:\n\n```yaml\n---\nstatus: backlog | ready-for-stories | in-progress | done\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [churn-fix, trading]\npriority: high\n---\n```\n\nDiscovery produces two artifacts:\n```\nartifacts/\n\u251c\u2500\u2500 discovery/\n\u2502   \u2514\u2500\u2500 trading-churn-discovery.md    \u2190 Full investigation (status: n/a)\n\u2514\u2500\u2500 brainstorms/\n    \u2514\u2500\u2500 trade-escrow.md               \u2190 Phase 1 solution (status: ready-for-stories)\n```\n\nThe discovery report is reference material. The brainstorm artifact enters the pipeline.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "The Difference",
      "content": "## The Difference\n\n| Approach | Starts With | Process |\n|----------|-------------|---------|\n| Solo Brainstorm | \"What if we added X?\" | Refine the idea |\n| Roundtable | \"Should we do X?\" | Debate the idea |\n| Problem-First | \"Something's broken\" | Find the solution |\n\nProblem-first doesn't assume a solution. It investigates first.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "The Symptom",
      "content": "### The Symptom\n\nThe data team flags an anomaly:\n\n```\nALERT: Player churn spiked 23% this week\n- Cohort: Players with 10-50 hours played\n- Pattern: Last session was a trade attempt\n- No recent deployments or changes\n```\n\nThis isn't a bug report. It's not a feature request. It's a **signal that something's wrong**."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Problem Signal",
      "content": "## Problem Signal\n\nSYMPTOM: Mid-game players churning after trade attempts\nIMPACT: 23% increase in week-over-week churn for 10-50hr cohort\nUNKNOWN: Why are trade attempts causing churn?\n```\n\nWe don't know the solution yet. We barely understand the problem.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Gathering Evidence",
      "content": "### Gathering Evidence\n\nThe investigator (human or AI agent) starts collecting data:\n\n**Player Support Tickets (Last 7 Days)**\n```\n- \"Tried to trade but other guy went offline. Wasted 20 mins.\"\n- \"Got scammed. Showed sword in trade window, I accepted, got nothing.\"\n- \"Trading is broken. Clicked accept, nothing happened, other player left.\"\n- \"How do I find someone to trade with? Chat moves too fast.\"\n```\n\n**Discord Feedback**\n```\n- \"Trading in this game is painful. I'm going back to [competitor].\"\n- \"Spent an hour trying to sell my drops. Nobody buying.\"\n- \"Got scammed twice today. Any way to report?\"\n```\n\n**Session Replay Analysis**\n```\nSampled 50 churned players from the cohort:\n- 34/50 had failed trade attempts in final session\n- Average time spent in trade UI before churn: 12 minutes\n- Common pattern: Open trade \u2192 Wait \u2192 Other player disconnects \u2192 Quit game\n```"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Problem Refinement",
      "content": "### Problem Refinement\n\nThe vague symptom becomes a clearer problem:\n\n```markdown"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Problem Statement (Refined)",
      "content": "## Problem Statement (Refined)\n\nCORE ISSUE: Trading is frustrating enough to make players quit\n\nCONTRIBUTING FACTORS:\n1. Discovery friction - Hard to find trading partners\n2. Trust issues - Scams happen, no recourse\n3. Reliability - Trades fail due to disconnections\n4. Time waste - Players spend 10+ mins on failed trade attempts\n\nIMPACT: 23% churn spike in mid-game cohort (our most valuable segment)\n\nROOT CAUSE HYPOTHESIS:\nTrading requires synchronous presence of two players with matching needs.\nThis is rare. Players waste time waiting, get frustrated, leave.\n```\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Research Phase",
      "content": "## Research Phase\n\nNow we understand the problem. Time to research solutions."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "How Do Others Solve This?",
      "content": "### How Do Others Solve This?\n\n**Competitor Analysis**\n```markdown"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "World of Warcraft",
      "content": "### World of Warcraft\n- Auction House: Async listings, automated transactions\n- Result: Trading is a non-issue. Players rarely quit over it."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Path of Exile",
      "content": "### Path of Exile\n- Trade website: External tool, search listings, whisper in-game\n- Result: Works but clunky. Community complains about friction."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "EVE Online",
      "content": "### EVE Online\n- Full market system with buy/sell orders\n- Result: Trading is a core gameplay loop, not friction."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Animal Crossing",
      "content": "### Animal Crossing\n- No built-in solution. Community uses Discord/Reddit.\n- Result: Players accept it because game is casual.\n\nPATTERN: Successful games either have async trading OR are casual enough\nthat trading friction doesn't matter. We're neither.\n```\n\n**Academic/Industry Research**\n```markdown"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Escrow Systems",
      "content": "### Escrow Systems\nHold items until both parties confirm. Prevents \"show then swap\" scams."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Reputation Systems",
      "content": "### Reputation Systems\nTrack trade history. Flag accounts with scam reports."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Async Marketplaces",
      "content": "### Async Marketplaces\nRemove synchronous requirement entirely. List \u2192 Buy \u2192 Done."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Trade Windows with Confirmation",
      "content": "### Trade Windows with Confirmation\nForce both players to confirm twice. Reduces accidental accepts.\n```"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Feasibility Assessment",
      "content": "## Feasibility Assessment\n\n| Solution | Addresses | Effort | Risk |\n|----------|-----------|--------|------|\n| Escrow (hold items) | Scams | Low | Low |\n| Double-confirm | Accidental accepts | Low | Low |\n| Reputation system | Scams | Medium | Medium (gaming) |\n| Bulletin board | Discovery | Medium | Low |\n| Full auction house | Discovery, async | High | High (economy) |\n| External trade site | Discovery | Medium | Medium (fragmentation) |\n\nRECOMMENDED COMBINATION:\n1. Quick win: Escrow + double-confirm (fix trust/reliability)\n2. Medium term: Bulletin board (fix discovery)\n3. Long term: Evaluate auction house based on data\n```\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Solution Discovery",
      "content": "## Solution Discovery\n\nThe solution emerges from the research:\n\n```markdown"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Insight",
      "content": "### Insight\nThe problem isn't one thing\u2014it's three:\n1. Trust (scams, failed trades)\n2. Discovery (can't find partners)\n3. Sync requirement (both online simultaneously)"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Phased Approach",
      "content": "### Phased Approach\n\nPHASE 1: Trust & Reliability (Quick Wins)\n- Add escrow: Items locked during trade, released on confirm\n- Add double-confirm: Both players confirm twice before execution\n- Add trade log: Record of completed trades for dispute resolution\n- Effort: ~1 sprint\n- Impact: Addresses scams and failed trades immediately\n\nPHASE 2: Discovery (Medium Term)\n- Add bulletin board (see: roundtable synthesis)\n- Effort: ~2 sprints\n- Impact: Addresses \"can't find partners\" problem\n\nPHASE 3: Async (Long Term, Conditional)\n- Full auction house IF Phase 1+2 don't reduce churn sufficiently\n- Gate: Re-evaluate churn metrics 4 weeks after Phase 2"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Success Metrics",
      "content": "### Success Metrics\n- Primary: Reduce 10-50hr cohort churn to baseline (pre-spike levels)\n- Secondary: Reduce average time-in-trade-UI from 12min to <3min\n- Secondary: Zero scam reports in support tickets\n```\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Discovery Report",
      "content": "### Discovery Report\n\nThe full investigation becomes a discovery artifact:\n\n```markdown\n---\ntype: discovery\ncreated: 2024-01-15\nproblem: trading-churn\n---\n\n# Discovery Report: Trading-Related Churn"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Executive Summary",
      "content": "## Executive Summary\nMid-game player churn spiked 23% due to trading friction. Investigation\nidentified three root causes: trust issues, discovery friction, and\nsynchronous requirements. Recommend phased solution starting with quick\nwins (escrow, double-confirm) before larger investments."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Problem Evidence",
      "content": "## Problem Evidence\n[Support tickets, Discord feedback, session replay data]"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Root Cause Analysis",
      "content": "## Root Cause Analysis\n[The three contributing factors with evidence]"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Research Findings",
      "content": "## Research Findings\n[Competitor analysis, industry patterns, feasibility matrix]"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Recommended Solution",
      "content": "## Recommended Solution\n[Phased approach with effort/impact for each phase]"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n- Should we notify players when someone wants to trade their listed item?\n- Do we need a \"report scammer\" button or just use existing report system?\n- What happens to escrowed items if a player disconnects mid-trade?\n```\n\nSaved to: `artifacts/discovery/trading-churn-discovery.md`\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Brainstorm Artifact Creation",
      "content": "## Brainstorm Artifact Creation\n\nPhase 1 becomes a brainstorm artifact:\n\n```markdown\n---\nstatus: backlog\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, churn-fix, trading]\npriority: high\nsource: artifacts/discovery/trading-churn-discovery.md\n---\n\n# Add Trade Escrow and Double-Confirm"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Summary",
      "content": "## Summary\nAdd escrow and double-confirm to existing trade system to address\ntrust and reliability issues causing player churn."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Context",
      "content": "## Context\n- Discovery Report: artifacts/discovery/trading-churn-discovery.md\n- 23% churn spike in 10-50hr player cohort\n- Root cause: Trade failures and scams frustrate players"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Escrow System",
      "content": "### Escrow System\n- When trade is initiated, items are \"locked\" (can't be modified)\n- Items remain locked until trade completes or is cancelled\n- Prevents \"show then swap\" scam pattern"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Double-Confirm",
      "content": "### Double-Confirm\n- After both players add items, first confirm locks the offer\n- Second confirm executes the trade\n- Either player can cancel before second confirm\n- UI shows clear state: \"Waiting for confirm\" \u2192 \"Ready to execute\""
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Trade Log",
      "content": "### Trade Log\n- Record completed trades: who, what, when\n- Players can view their own trade history\n- Enables dispute resolution via support"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Scope",
      "content": "## Scope\n**In scope:**\n- Escrow locking during trade\n- Two-phase confirmation\n- Basic trade history (last 20 trades)\n\n**Out of scope (separate artifacts):**\n- Bulletin board (Phase 2)\n- Auction house (Phase 3, conditional)\n- Reputation system (not pursuing)"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Success Indicators",
      "content": "## Success Indicators\n- [ ] Items are locked when trade window opens\n- [ ] Trade requires two confirms from each player\n- [ ] Players can view their recent trade history\n- [ ] Scam pattern (show/swap) is no longer possible\n- [ ] Metric: Support tickets mentioning \"scam\" drop to zero\n- [ ] Metric: Churn in 10-50hr cohort returns to baseline within 4 weeks\n\n*Note: Story-agent will refine these into formal, testable acceptance criteria.*"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n- What happens to locked items if a player disconnects?\n- Timeout duration for escrow (suggest: 5 minutes, then auto-cancel)?"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Linked Documents",
      "content": "## Linked Documents\n- Discovery Report: artifacts/discovery/trading-churn-discovery.md\n- Phase 2 (Bulletin Board): Will be separate artifact\n- Phase 3 (Auction House): Conditional on Phase 1+2 results\n```\n\nSaved to: `artifacts/brainstorms/trade-escrow.md`\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Human Gate",
      "content": "## Human Gate\n\nPO reviews the discovery report and brainstorm artifact:\n\n```\nPO Review:\n- Investigation is thorough, evidence is solid\n- Phased approach makes sense\u2014de-risks the big investment\n- Phase 1 is low-effort, high-impact\u2014approve for immediate work\n```\n\nThe PO updates the frontmatter:\n\n```yaml\n---\nstatus: ready-for-stories\npriority: high\n...\n---\n```\n\n**Story-agent wakes up.** It polls for `status: ready-for-stories` and claims the artifact.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Success Indicators vs Formal AC",
      "content": "## Success Indicators vs Formal AC\n\n| Phase | Produces | Character |\n|-------|----------|-----------|\n| Problem-First Discovery | Success indicators + metrics | \"How do we know the problem is solved?\" |\n| Story-agent | Formal AC | \"How does QA prove it works?\" |\n\nProblem-first discovery often includes **metrics** as success indicators because the goal is solving a measurable problem.\n\n**Example transformation:**\n\n```\nSUCCESS INDICATOR (from discovery):\n\"Metric: Support tickets mentioning 'scam' drop to zero\"\n\nFORMAL AC (from story-agent):\n\"Given a player attempts the 'show then swap' scam pattern\n When they try to modify items after first confirm\n Then the modification is blocked\n And the other player sees no change in the trade window\n And the trade log records the attempt\"\n```\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "1. Started With Evidence, Not Assumptions",
      "content": "### 1. Started With Evidence, Not Assumptions\nThe investigation gathered data before proposing solutions. No \"I think the problem is X.\""
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "2. Problem Refinement",
      "content": "### 2. Problem Refinement\nVague symptom (churn spike) became specific problems (trust, discovery, sync)."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "3. Research Before Solutioning",
      "content": "### 3. Research Before Solutioning\nLooked at how others solved it. Avoided reinventing the wheel."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "4. Feasibility-Aware Recommendations",
      "content": "### 4. Feasibility-Aware Recommendations\nSolutions mapped to effort and risk. Not just \"what's ideal\" but \"what's practical.\""
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "5. Phased De-Risking",
      "content": "### 5. Phased De-Risking\nBig solution (auction house) deferred until smaller solutions prove insufficient."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "6. Metrics as Success Criteria",
      "content": "### 6. Metrics as Success Criteria\nProblem-first work ties to measurable outcomes. \"Did churn go down?\" is the real test."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "7. Self-Contained State",
      "content": "### 7. Self-Contained State\nArtifacts carry their own status. No external system to sync. Git tracks history.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "When to Use Problem-First Discovery",
      "content": "## When to Use Problem-First Discovery\n\n| Situation | Recommended |\n|-----------|-------------|\n| Clear feature idea | Solo brainstorm or roundtable |\n| Metric anomaly (churn, engagement, revenue) | Problem-first discovery |\n| Vague user complaints | Problem-first discovery |\n| \"Something feels wrong\" | Problem-first discovery |\n| Competitor just shipped something | Roundtable |\n| Known solution, unclear if we should build | Roundtable |\n\nProblem-first is for **diagnostic work**. Use it when you don't know what to build.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "AI-Driven Discovery",
      "content": "### AI-Driven Discovery\n\nAn AI agent notices the anomaly and self-initiates:\n\n```\n[TRIGGER] Churn anomaly detected in 10-50hr cohort\n\nDiscovery Agent starts:\n- Pulls support tickets, Discord feedback\n- Analyzes session replays\n- Researches competitor solutions\n- Produces discovery report\n- Creates draft brainstorm artifact with status: needs-review\n```\n\nHuman still gates entry to dev pipeline, but AI did the investigation."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Collaborative Investigation",
      "content": "### Collaborative Investigation\n\nMultiple agents divide the research:\n\n```\nAgent 1: Support ticket analysis\nAgent 2: Session replay analysis\nAgent 3: Competitor research\nSynthesis Agent: Combines findings into report\n```\n\nParallelizes the discovery work."
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Continuous Discovery",
      "content": "### Continuous Discovery\n\nDiscovery isn't a one-time event. A \"discovery agent\" continuously monitors:\n\n```\nAlways running:\n- Watch churn metrics\n- Scan support tickets for patterns\n- Monitor Discord sentiment\n- Flag anomalies for investigation\n```\n\nProblems are caught earlier when discovery is continuous.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Artifacts Produced",
      "content": "## Artifacts Produced\n\n```\nartifacts/discovery/trading-churn-discovery.md    \u2190 Full investigation\nartifacts/brainstorms/trade-escrow.md             \u2190 Phase 1 (with frontmatter status)\n```\n\nThe discovery report captures the investigation. The brainstorm artifact enters the pipeline.\n\nLater phases become separate artifacts when gated metrics are met.\n\n---"
    },
    {
      "source": "scenarios\\problem-first-discovery-scenario.md",
      "heading": "Connection to Dev Pipeline",
      "content": "## Connection to Dev Pipeline\n\n```\nDiscovery Output                 Dev Pipeline Input\n       \u2193                               \u2193\n  Discovery Report \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Reference material\n  Brainstorm Artifact  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  story-agent polls status: ready-for-stories\n  (status updated)                     \u2193\n                                  story-agent claims (status: in-progress-stories)\n                                       \u2193\n                                  (pipeline continues)\n\nLater:\n  Phase 2 Artifact \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Created after Phase 1 success metrics met\n  Phase 3 Artifact \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Conditional on Phase 1+2 results\n```\n\nDiscovery often produces **multiple artifacts** (one per phase), but only the first enters the pipeline immediately. Later phases are gated on results."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "The Setup",
      "content": "## The Setup\n\nBefore the dev pipeline, some ideas benefit from **multiple perspectives**. Instead of one mind refining an idea, several AI models debate it:\n\n```\nSeed Idea \u2192 Round 1 (Isolated Thinking) \u2192 Round 2+ (Engagement) \u2192 Synthesis \u2192 Brainstorm Artifact\n```\n\nWhy multiple models?\n- Different training \u2192 different blind spots\n- Adversarial pressure surfaces weak assumptions\n- Consensus across models = higher confidence the idea is sound\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Artifacts & Kanban",
      "content": "## Artifacts & Kanban\n\nAll state is local. Artifacts carry their own status via frontmatter:\n\n```yaml\n---\nstatus: backlog | ready-for-stories | in-progress | done\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, economy]\n---\n```\n\nRoundtables produce two artifacts:\n```\nartifacts/\n\u251c\u2500\u2500 synthesis/\n\u2502   \u2514\u2500\u2500 auction-house-roundtable.md    \u2190 Full reasoning (status: n/a)\n\u2514\u2500\u2500 brainstorms/\n    \u2514\u2500\u2500 bulletin-board.md              \u2190 Actionable scope (status: ready-for-stories)\n```\n\nThe synthesis is reference material. The brainstorm artifact enters the pipeline.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "The Participants",
      "content": "## The Participants\n\nA typical roundtable:\n\n| Model | Role | Tendency |\n|-------|------|----------|\n| Claude | Balanced analysis | Nuanced, considers edge cases |\n| GPT | Broad exploration | Creative, expansive thinking |\n| Gemini | Technical depth | Implementation-focused |\n\nThe **host** (could be any model or a human) manages the flow. Panelists respond to prompts.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Morning: A Seed Idea Arrives",
      "content": "## Morning: A Seed Idea Arrives\n\nA human (or automated trigger) seeds the roundtable:\n\n```markdown\nROUNDTABLE SEED:\n\"Should we add an in-game auction house where players can list items for sale?\"\n\nContext:\n- Current system: Direct player-to-player trades only\n- Player feedback: \"Trading is tedious, hard to find buyers\"\n- Concern: Could this break the economy?\n```\n\nThe host frames the question and kicks off Round 1.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Round 1: Isolated Deliberation",
      "content": "## Round 1: Isolated Deliberation\n\n**Critical rule**: In Round 1, panelists think independently. They don't see each other's responses. This prevents groupthink."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Host Prompt",
      "content": "### Host Prompt\n\n```\nRound 1: Initial Position\n\nConsider the auction house proposal. In 150 words or less:\n1. What's your initial stance? (Support, Oppose, Conditional)\n2. What's the strongest argument for your position?\n3. What's the biggest risk you see?\n\nRespond independently. You'll see other perspectives in Round 2.\n```"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Claude's Response (Isolated)",
      "content": "### Claude's Response (Isolated)\n\n```\nSTANCE: Conditional Support\n\nARGUMENT FOR:\nAn auction house solves the discovery problem. Players can't trade what they\ncan't find buyers for. Async listings let players sell while offline\u2014critical\nfor different time zones.\n\nBIGGEST RISK:\nPrice deflation. If supply becomes visible and accessible, prices drop. Rare\nitems become less rare when everyone can see 50 listings. The scarcity illusion\nbreaks.\n\nCONDITION:\nSupport IF we limit listing slots per player and add listing fees to create\nfriction.\n```"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "GPT's Response (Isolated)",
      "content": "### GPT's Response (Isolated)\n\n```\nSTANCE: Support\n\nARGUMENT FOR:\nPlayer friction is real. Every hour spent spamming \"WTS [item]\" in chat is an\nhour not playing the game. Auction houses are proven in WoW, FF14, EVE. Players\nexpect this feature.\n\nBIGGEST RISK:\nBot exploitation. Automated sniping of underpriced items. Without safeguards,\nbots will dominate the market and extract value from regular players.\n\nRECOMMENDATION:\nSupport with anti-bot measures: CAPTCHA on listing, minimum list duration,\nrate limits.\n```"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Gemini's Response (Isolated)",
      "content": "### Gemini's Response (Isolated)\n\n```\nSTANCE: Oppose (for now)\n\nARGUMENT AGAINST:\nImplementation complexity is high. Auction house requires: new database tables,\nsearch/filter UI, payment escrow, expiration handling, notification system.\nThis is 3-4 sprints of work minimum.\n\nBIGGEST RISK:\nWe build it, economy breaks, we can't un-ship it. Auction houses are nearly\nimpossible to remove once players depend on them.\n\nRECOMMENDATION:\nStart smaller: add a \"bulletin board\" where players post what they want to\nbuy/sell, but trades still happen directly. Test demand before building full\nauction infrastructure.\n```\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Round 2: Engagement",
      "content": "## Round 2: Engagement\n\nNow panelists see each other's Round 1 responses. The host prompts engagement:"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Host Prompt",
      "content": "### Host Prompt\n\n```\nRound 2: Challenge and Refine\n\nYou've seen all positions. Now:\n1. Which argument from another panelist do you find most compelling?\n2. Which argument do you disagree with, and why?\n3. Has your position shifted? If so, how?\n```"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Claude's Response (Engaged)",
      "content": "### Claude's Response (Engaged)\n\n```\nMOST COMPELLING (from Gemini):\nThe \"bulletin board first\" approach is smart. It tests demand with 10% of the\nimplementation cost. We learn if players actually use async trading before\ncommitting to full auction infrastructure.\n\nDISAGREE WITH (GPT):\n\"Players expect this feature\" is weak reasoning. Players expect lots of things.\nThe question is whether THIS game benefits from it. We're not WoW.\n\nPOSITION SHIFT:\nMoving from \"Conditional Support\" to \"Support Bulletin Board First.\"\nBuild the minimal async trading. If adoption is high, then build full auction.\n```"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "GPT's Response (Engaged)",
      "content": "### GPT's Response (Engaged)\n\n```\nMOST COMPELLING (from Gemini):\nImplementation cost is real. I underweighted the engineering effort. A bulletin\nboard MVP is a reasonable middle ground.\n\nDISAGREE WITH (Claude):\n\"Scarcity illusion\" concerns are overblown. Visible supply doesn't destroy\nvalue\u2014it creates efficient markets. Real scarcity (drop rates) remains.\n\nPOSITION SHIFT:\nStill support auction house long-term, but concede that bulletin board is a\nreasonable Phase 1. Willing to compromise on phased approach.\n```"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Gemini's Response (Engaged)",
      "content": "### Gemini's Response (Engaged)\n\n```\nMOST COMPELLING (from Claude):\nListing fees and slot limits as friction mechanisms. If we DO build an auction\nhouse later, these constraints would address my economy concerns.\n\nDISAGREE WITH (GPT):\n\"Anti-bot measures\" like CAPTCHA are user-hostile. Rate limits are better.\nDon't punish legitimate players to stop bots.\n\nPOSITION SHIFT:\nRemain opposed to full auction house in v1. But if bulletin board succeeds\nand we add friction mechanisms, I'd support Phase 2 auction house.\n```\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Round 3: Convergence",
      "content": "## Round 3: Convergence\n\nThe host pushes for actionable consensus:"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Host Prompt",
      "content": "### Host Prompt\n\n```\nRound 3: Synthesis\n\nWe need a concrete recommendation. Propose a single path forward that\naddresses the concerns raised. What should we build?\n```"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Emerging Consensus",
      "content": "### Emerging Consensus\n\nAll three panelists converge on a phased approach:\n\n```\nPHASE 1: Bulletin Board (MVP)\n- Players post \"Want to Buy\" and \"Want to Sell\" listings\n- Listings are searchable\n- Trades still happen directly (players contact each other)\n- Minimal implementation: just a listing table + basic UI\n- Success metric: >30% of active players use it within 2 weeks\n\nPHASE 2: Full Auction House (if Phase 1 succeeds)\n- Automated buy/sell with escrow\n- Listing fees (gold sink)\n- Limited slots per player (anti-flood)\n- Rate limits (anti-bot)\n\nDECISION POINT:\nAfter Phase 1, review usage data. If bulletin board is heavily used AND\nplayers request automation, proceed to Phase 2. Otherwise, bulletin board\nis sufficient.\n```\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Afternoon: Synthesis Document",
      "content": "## Afternoon: Synthesis Document\n\nThe host produces a synthesis artifact capturing the roundtable outcome:\n\n```markdown\n---\ntype: synthesis\ncreated: 2024-01-15\nroundtable: auction-house-proposal\nparticipants: [claude, gpt, gemini]\n---\n\n# Roundtable Synthesis: Auction House Proposal"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Summary",
      "content": "## Summary\nThe roundtable reached consensus on a phased approach:\n1. Build a bulletin board MVP to test async trading demand\n2. If successful, proceed to full auction house with economy safeguards"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Key Insights by Panelist",
      "content": "## Key Insights by Panelist\n\n| Panelist | Initial Stance | Final Stance | Key Contribution |\n|----------|---------------|--------------|------------------|\n| Claude | Conditional Support | Support Phase 1 | Friction mechanisms (fees, limits) |\n| GPT | Support | Support Phased | Validated player demand for async trading |\n| Gemini | Oppose | Support Phase 1 | MVP approach, implementation pragmatism |"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Risks Identified",
      "content": "## Risks Identified\n1. Economy disruption (mitigated by: phased rollout, friction mechanisms)\n2. Bot exploitation (mitigated by: rate limits, minimum list duration)\n3. Implementation cost (mitigated by: bulletin board MVP first)"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Open Questions for Story Phase",
      "content": "## Open Questions for Story Phase\n- What's the listing expiration period?\n- How do players contact each other from a listing? (in-game mail? whisper?)\n- Should listings cost gold to post, or only on successful sale?"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Recommendation",
      "content": "## Recommendation\nProceed to dev pipeline with Phase 1 (Bulletin Board) only.\nPhase 2 is a separate future artifact, gated on Phase 1 success metrics.\n```\n\nSaved to: `artifacts/synthesis/auction-house-roundtable.md`\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Evening: Brainstorm Artifact Creation",
      "content": "## Evening: Brainstorm Artifact Creation\n\nThe synthesis becomes a brainstorm artifact with frontmatter status:\n\n```markdown\n---\nstatus: backlog\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, player-request, economy]\npriority: normal\nsource: artifacts/synthesis/auction-house-roundtable.md\n---\n\n# Add Player Trading Bulletin Board"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Summary",
      "content": "## Summary\nA searchable board where players post buy/sell listings. Trades still\nhappen directly between players."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Context",
      "content": "## Context\n- Roundtable Synthesis: artifacts/synthesis/auction-house-roundtable.md\n- Player feedback indicates trading friction is a top complaint\n- This is Phase 1 of a potential auction house system"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Proposed Solution",
      "content": "## Proposed Solution\n- New \"Bulletin Board\" accessible from main menu\n- Players can post \"Want to Buy\" or \"Want to Sell\" listings\n- Listings include: item, quantity, price, player name\n- Basic search/filter by item type\n- Listings expire after 7 days\n- Players contact each other via in-game mail to complete trade"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Scope",
      "content": "## Scope\n**In scope (Phase 1):**\n- Listing creation and browsing\n- Search by item name/type\n- Listing expiration\n- Contact seller via mail link\n\n**Out of scope (Phase 2, separate artifact):**\n- Automated transactions\n- Escrow system\n- Listing fees\n- Purchase history"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Success Indicators",
      "content": "## Success Indicators\n- [ ] Players can create buy/sell listings\n- [ ] Players can browse and search listings\n- [ ] Players can contact listing owner\n- [ ] Listings auto-expire after 7 days\n- [ ] >30% of active players use within 2 weeks (success metric for Phase 2 gate)\n\n*Note: Story-agent will refine these into formal, testable acceptance criteria.*"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n- Listing limit per player? (suggest 5-10)\n- Can players bump/renew listings?\n```\n\nSaved to: `artifacts/brainstorms/bulletin-board.md`\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Human Gate",
      "content": "## Human Gate\n\nThe PO reviews artifacts with `status: backlog`:\n\n```\nPO Review:\n- Roundtable process surfaced good risks\n- Phased approach is sensible\n- Success metric for Phase 2 gate is clear\n- Approved for pipeline\n```\n\nThe PO updates the frontmatter:\n\n```yaml\n---\nstatus: ready-for-stories\n...\n---\n```\n\n**Story-agent wakes up.** It polls for `status: ready-for-stories` and claims the artifact.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Success Indicators vs Formal AC",
      "content": "## Success Indicators vs Formal AC\n\nSame pattern as solo brainstorm:\n\n| Phase | Produces | Character |\n|-------|----------|-----------|\n| Roundtable | Success indicators | \"What would make players happy?\" |\n| Story-agent | Formal AC | \"How does QA prove it works?\" |\n\n**Example transformation:**\n\n```\nSUCCESS INDICATOR (from roundtable):\n\"Players can browse and search listings\"\n\nFORMAL AC (from story-agent):\n\"Given 100 active listings across 5 item categories\n When a player searches for 'sword'\n Then only listings containing 'sword' in item name are displayed\n And results load within 500ms\n And results are paginated at 20 per page\"\n```\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "1. Isolated First Round",
      "content": "### 1. Isolated First Round\nPanelists thought independently before seeing others. This prevented anchoring and groupthink."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "2. Adversarial Pressure",
      "content": "### 2. Adversarial Pressure\nRound 2 required engaging with disagreements. Weak arguments got challenged. Strong arguments survived."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "3. Forced Convergence",
      "content": "### 3. Forced Convergence\nRound 3 pushed for a single recommendation. No \"we couldn't decide\"\u2014the roundtable must produce an actionable output."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "4. Phased Recommendations",
      "content": "### 4. Phased Recommendations\nWhen full consensus isn't possible, phased approaches let cautious and aggressive voices both win: \"try small, then expand.\""
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "5. Synthesis Document",
      "content": "### 5. Synthesis Document\nThe roundtable produced a document capturing the reasoning, not just the conclusion. Future readers understand WHY."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "6. Human Gate",
      "content": "### 6. Human Gate\nPO still reviews before pipeline entry. Roundtable advises, humans decide."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "7. Self-Contained State",
      "content": "### 7. Self-Contained State\nArtifacts carry their own status. No external system to sync. Git tracks history.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "When to Use Roundtable vs Solo",
      "content": "## When to Use Roundtable vs Solo\n\n| Situation | Recommended |\n|-----------|-------------|\n| Simple feature, clear requirements | Solo brainstorm |\n| Controversial, could break things | Roundtable |\n| Economy/balance changes | Roundtable |\n| High implementation cost | Roundtable |\n| Reversible, low risk | Solo brainstorm |\n| Multiple valid approaches | Roundtable |\n\nRoundtables are expensive (multiple model calls, more time). Use them when the stakes justify the cost.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Human-in-the-Loop Roundtable",
      "content": "### Human-in-the-Loop Roundtable\n\nA human participates as a panelist alongside AI models:\n\n```\nPanelists: Claude, GPT, Human (Product Owner)\n```\n\nThe human brings domain knowledge AI lacks. AI brings breadth and adversarial challenge."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Async Roundtable",
      "content": "### Async Roundtable\n\nPanelists don't need to respond simultaneously. The host collects responses over hours/days:\n\n```\nDay 1: Round 1 responses collected\nDay 2: Round 2 engagement\nDay 3: Round 3 synthesis\n```\n\nUseful for busy teams or when deep thought is needed."
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Tie-Breaker Rounds",
      "content": "### Tie-Breaker Rounds\n\nIf Round 3 doesn't converge, add a tie-breaker:\n\n```\nRound 4: Final Vote\n\nGiven the discussion, vote: BUILD or DON'T BUILD.\nMajority wins. Dissenting opinion recorded in synthesis.\n```\n\nDissent is valuable signal\u2014record it even when overruled.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Artifacts Produced",
      "content": "## Artifacts Produced\n\n```\nartifacts/synthesis/auction-house-roundtable.md    \u2190 Full reasoning\nartifacts/brainstorms/bulletin-board.md            \u2190 Actionable scope (with frontmatter status)\n```\n\nThe synthesis captures WHY. The brainstorm artifact enters the pipeline.\n\n---"
    },
    {
      "source": "scenarios\\roundtable-ideation-scenario.md",
      "heading": "Connection to Dev Pipeline",
      "content": "## Connection to Dev Pipeline\n\n```\nRoundtable Output                Dev Pipeline Input\n       \u2193                               \u2193\n  Synthesis Doc \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  Reference material\n  Brainstorm Artifact  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  story-agent polls status: ready-for-stories\n  (status updated)                     \u2193\n                                  story-agent claims (status: in-progress-stories)\n                                       \u2193\n                                  (pipeline continues)\n```\n\nThe roundtable phase is complete. The dev pipeline takes over."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "The Setup",
      "content": "## The Setup\n\nBefore the dev pipeline (story-agent \u2192 architect \u2192 test \u2192 dev \u2192 review \u2192 qa), ideas need to be captured and shaped. This scenario covers the **solo brainstorming flow**:\n\n```\nRaw Idea \u2192 Exploration \u2192 Refinement \u2192 Brainstorm Artifact \u2192 Dev Pipeline\n```\n\nThe brainstormer works alone. No collaboration, no roundtable. Just one mind (human or AI) taking a vague notion and crystallizing it into something actionable.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Artifacts & Kanban",
      "content": "## Artifacts & Kanban\n\nAll state is local. Artifacts carry their own status via frontmatter:\n\n```yaml\n---\nstatus: backlog | ready-for-stories | in-progress | done\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, player-request]\n---\n```\n\nAgents poll for artifacts matching their target status. No external system needed.\n\n```\nartifacts/\n\u2514\u2500\u2500 brainstorms/\n    \u2514\u2500\u2500 trade-history.md    \u2190 status: ready-for-stories\n```\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "The Spark",
      "content": "### The Spark\n\nA developer is working on the game. They notice something:\n\n```\n\"Players keep asking in Discord: 'Can I see what trades I did yesterday?'\nThere's no trade history. Huh.\"\n```\n\nThis isn't a bug. It's not a planned feature. It's just... an observation."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Capture Before It's Lost",
      "content": "### Capture Before It's Lost\n\nThe developer opens their brainstorm tool (could be a markdown file, a dedicated app, or just a chat with an AI):\n\n```markdown"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Raw Idea",
      "content": "## Raw Idea\nPlayers want trade history. Currently no way to see past trades.\n```\n\nThat's it. 30 seconds. The idea is captured. The developer moves on with their day.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Lunch: Exploration Phase",
      "content": "## Lunch: Exploration Phase\n\nThe developer returns to the idea during lunch. Time to explore."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Why do players want this?",
      "content": "### Why do players want this?\n- Verify they weren't scammed\n- Track their economy progress\n- Settle disputes (\"I traded you 50 gold, not 5!\")\n- Nostalgia/journal feeling"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "What would \"trade history\" even mean?",
      "content": "### What would \"trade history\" even mean?\n- List of all trades? Too much?\n- Last N trades?\n- Searchable archive?\n- Just today's trades?"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "What already exists?",
      "content": "### What already exists?\n- TradingSystem handles live trades\n- No persistence after trade completes\n- Database has player inventory, no trade logs"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "What's the minimal version?",
      "content": "### What's the minimal version?\n- Show last 10 trades per player\n- Who, what, when\n- No search, no export, just a list\n```\n\nThe exploration isn't structured. It's messy. That's fine\u2014this is brainstorming."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Potential Issues",
      "content": "### Potential Issues\n- Privacy: Can players see OTHER players' trade history?\n- Storage: Do we keep trades forever? Disk cost?\n- Performance: Query on every trade screen open?\n- Abuse: Could this expose exploits? (mass gold duping visible in logs)\n```\n\nThe developer isn't solving these yet. Just noting them.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Afternoon: Refinement Phase",
      "content": "## Afternoon: Refinement Phase\n\nThe raw exploration is useful but chaotic. Time to shape it."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Core Feature",
      "content": "### Core Feature\n\"Players can view their own recent trade history\""
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "In Scope (v1)",
      "content": "### In Scope (v1)\n- Player sees THEIR OWN trades only (not others')\n- Last 20 trades displayed\n- Shows: timestamp, other player, items exchanged\n- Accessible from inventory screen"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Out of Scope (future)",
      "content": "### Out of Scope (future)\n- Searching/filtering trades\n- Exporting trade history\n- Admin view of all trades\n- Trade dispute resolution system"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Key Decision",
      "content": "### Key Decision\nPrivacy-first: Only show your own trades. No \"see what X traded\" feature.\n```"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Concerns Addressed",
      "content": "### Concerns Addressed\n- Privacy: \u2705 Players only see own history\n- Storage: \u26a0\ufe0f Need to decide retention policy (suggest 30 days)\n- Performance: \u2705 Query only on screen open, index by player_id\n- Abuse: \u26a0\ufe0f Admins might want this later, but v1 is player-facing only\n```"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "The One-Liner Test",
      "content": "### The One-Liner Test\n\nCan you explain it in one sentence?\n\n```\n\"Players can view their last 20 trades from the inventory screen.\"\n```\n\nYes. The idea is crystallized.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Evening: Artifact Creation",
      "content": "## Evening: Artifact Creation\n\nThe refined idea is ready to enter the dev pipeline. Time to create the brainstorm artifact."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Writing the Artifact",
      "content": "### Writing the Artifact\n\n```markdown\n---\nstatus: backlog\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, player-request]\npriority: normal\n---\n\n# Add Player Trade History"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Summary",
      "content": "## Summary\nPlayers can view their own recent trade history from the inventory screen."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Context",
      "content": "## Context\n- Players frequently ask in Discord about past trades\n- Currently no way to verify or review completed trades\n- Common request for dispute resolution and progress tracking"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Proposed Solution",
      "content": "## Proposed Solution\n- Store trade records in database (new TradeHistory table)\n- Show last 20 trades per player\n- Display: timestamp, other player name, items given/received\n- Access via new \"History\" tab on inventory screen"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Scope",
      "content": "## Scope\n**In scope:**\n- Player views own trades only\n- Last 20 trades\n- Basic list display\n\n**Out of scope (future work):**\n- Search/filter\n- Export\n- Admin tools\n- Cross-player visibility"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Open Questions",
      "content": "## Open Questions\n- Retention policy: 30 days? Forever?\n- Should trades be immutable or can players \"hide\" entries?"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Success Indicators",
      "content": "## Success Indicators\nWhat would make this feel \"done\" from a player's perspective?\n- [ ] Player can open trade history from inventory\n- [ ] Shows recent trades (last ~20)\n- [ ] Each entry shows: date, other player, items exchanged\n- [ ] Only player's own trades are visible\n\n*Note: Story-agent will refine these into formal, testable acceptance criteria.*\n```\n\nThe artifact is saved to `artifacts/brainstorms/trade-history.md`. It sits in the backlog.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Later: Human Gate",
      "content": "## Later: Human Gate\n\nA product owner reviews the backlog. They open artifacts with `status: backlog`:\n\n```\nPO Review:\n- Good scope, clear success indicators\n- Aligns with player feedback\n- Approved for pipeline\n```\n\nThe PO updates the frontmatter:\n\n```yaml\n---\nstatus: ready-for-stories\ncreated: 2024-01-15\nupdated: 2024-01-16\ntags: [enhancement, player-request]\npriority: normal\n---\n```\n\n**The dev pipeline begins.** Story-agent polls for `status: ready-for-stories` and claims the artifact.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Success Indicators vs Formal AC",
      "content": "## Success Indicators vs Formal AC\n\nThe brainstorm phase produces **success indicators**\u2014rough, user-facing descriptions of what \"done\" looks like. The story-agent later refines these into **formal acceptance criteria** that are precise and testable.\n\n| Phase | Produces | Character |\n|-------|----------|-----------|\n| Brainstorm | Success indicators | \"What would make players happy?\" |\n| Story-agent | Formal AC | \"How does QA prove it works?\" |\n\n**Example transformation:**\n\n```\nSUCCESS INDICATOR (from brainstorm):\n\"Shows recent trades (last ~20)\"\n\nFORMAL AC (from story-agent):\n\"Given a player with 25 completed trades\n When they open the trade history screen\n Then they see exactly 20 trades\n And trades are ordered by timestamp descending\n And the oldest 5 trades are not displayed\"\n```\n\nThe brainstormer focuses on **intent**. The story-agent focuses on **verification**.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "1. Capture First, Refine Later",
      "content": "### 1. Capture First, Refine Later\nThe raw idea was saved in 30 seconds. Exploration happened hours later. No pressure to have a complete thought immediately."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "2. Exploration Before Commitment",
      "content": "### 2. Exploration Before Commitment\nAsking \"why\" and \"what could go wrong\" happened BEFORE writing the artifact. Concerns were surfaced early."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "3. Explicit Scoping",
      "content": "### 3. Explicit Scoping\n\"In scope\" and \"out of scope\" prevent feature creep. The artifact is clear about what it IS and ISN'T."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "4. The One-Liner Test",
      "content": "### 4. The One-Liner Test\nIf you can't explain it in one sentence, it's not ready. This forces clarity."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "5. Human Gate Before Pipeline",
      "content": "### 5. Human Gate Before Pipeline\nThe PO reviews before it enters the dev pipeline. Bad ideas get filtered. Good ideas get blessed."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "6. Self-Contained State",
      "content": "### 6. Self-Contained State\nThe artifact carries its own status. No external system to sync. Git tracks history.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "AI-Assisted Solo Brainstorm",
      "content": "### AI-Assisted Solo Brainstorm\n\nSame flow, but the developer uses an AI assistant:\n\n```\nDeveloper: \"Players keep asking about trade history. Brainstorm this with me.\"\n\nAI: \"What problem does trade history solve for players?\"\n\nDeveloper: \"Mostly disputes and verifying trades.\"\n\nAI: \"So the core need is trust verification, not comprehensive logging.\n     A minimal version might just show recent trades.\n     Do you want v1 to be player-facing or include admin tools?\"\n\nDeveloper: \"Player-facing only.\"\n\nAI: \"Got it. Here's a draft scope...\"\n```\n\nThe AI accelerates the exploration and refinement phases but doesn't replace them."
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Fully Autonomous AI Brainstorm",
      "content": "### Fully Autonomous AI Brainstorm\n\nAn AI agent notices a pattern (e.g., analyzing Discord feedback) and initiates:\n\n```\n[TRIGGER] Discord analysis shows 47 mentions of \"trade history\" in past week\n\nAI Brainstorm Agent starts new effort:\n- Explores the concept\n- Identifies scope\n- Drafts artifact with status: needs-review\n- Human reviews before moving to ready-for-stories\n```\n\nThe human gate is still mandatory. AI can brainstorm, but humans approve what enters the pipeline.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Artifacts Produced",
      "content": "## Artifacts Produced\n\nBy the end of a solo brainstorm:\n\n```\nartifacts/brainstorms/trade-history.md    \u2190 The artifact (with frontmatter status)\n```\n\nThe artifact is the only required output. Kanban state lives in the frontmatter.\n\n---"
    },
    {
      "source": "scenarios\\solo-brainstorm-scenario.md",
      "heading": "Connection to Dev Pipeline",
      "content": "## Connection to Dev Pipeline\n\nOnce the artifact status changes to `ready-for-stories`:\n\n```\nSolo Brainstorm Output          Dev Pipeline Input\n        \u2193                              \u2193\n   Brainstorm Artifact  \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2192  story-agent polls status: ready-for-stories\n   (status updated)                    \u2193\n                                  story-agent claims (status: in-progress-stories)\n                                       \u2193\n                                  (pipeline continues)\n```\n\nThe brainstorm phase is complete. The dev pipeline takes over."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "The Setup",
      "content": "## The Setup\n\nThis is the most common brainstorming pattern: a human with a rough idea talks it through with an AI assistant. The conversation is the refinement process.\n\n```\nUser's Rough Idea \u2192 Conversation \u2192 Brainstorm Artifact (.md) \u2192 TDD Pipeline\n```\n\nThe AI doesn't just take notes\u2014it **challenges, clarifies, and suggests**. The user doesn't just dictate\u2014they **react, redirect, and decide**.\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Artifacts & Kanban",
      "content": "## Artifacts & Kanban\n\nAll state is local. Artifacts carry their own status via frontmatter:\n\n```yaml\n---\nstatus: backlog | ready-for-stories | in-progress | done\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, social]\n---\n```\n\nAgents poll for artifacts matching their target status. No external system needed.\n\n```\nartifacts/\n\u2514\u2500\u2500 brainstorms/\n    \u2514\u2500\u2500 guild-system-v1.md    \u2190 status: ready-for-stories\n```\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "User Has a Rough Idea",
      "content": "### User Has a Rough Idea\n\n```\nUser: I want to add guilds to the game. Like, players can form groups\n      and do stuff together.\n```\n\nThat's it. Vague. \"Do stuff together\" isn't a spec."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "AI Starts Exploring",
      "content": "### AI Starts Exploring\n\n```\nAI: Guilds can mean a lot of things. Let me ask a few questions to\n    narrow this down.\n\n    What's the primary purpose of guilds in your game?\n    - Social (chat, identity, belonging)\n    - Cooperative gameplay (guild quests, raids)\n    - Competitive (guild vs guild battles)\n    - Economic (shared resources, guild bank)\n\n    Which of these feels most important for v1?\n```\n\n```\nUser: Social first. Players keep asking for a way to \"stick together\"\n      with their friends. The Discord is full of people forming informal\n      groups already.\n```\n\n```\nAI: So the core need is formalizing groups that already exist informally.\n\n    That suggests a minimal v1:\n    - Create/join a guild\n    - Guild member list\n    - Guild chat channel\n\n    No quests, no bank, no battles. Just \"we're a group.\"\n\n    Does that feel right, or is something missing?\n```\n\n```\nUser: Yeah that's close. But I also want some kind of guild identity.\n      Like a name and maybe a tag that shows next to your name.\n```\n\n```\nAI: Got it. So:\n    - Guild has a name and a short tag (e.g., \"[WOLF] PlayerName\")\n    - Tag displays in chat and nameplates\n\n    That adds identity without adding mechanics. Still minimal.\n\n    One question: who can create a guild? Anyone? Or some requirement?\n```\n\n```\nUser: Hmm. If anyone can create one, we'll have thousands of dead guilds.\n      Maybe require... 3 players to form one? You need a founding group.\n```\n\n```\nAI: Smart. Prevents spam guilds.\n\n    So the flow is:\n    1. Player invites 2 others to \"found\" a guild\n    2. All 3 accept \u2192 guild is created\n    3. After that, the leader can invite more members\n\n    What about leaving/kicking? Can members leave freely? Can leaders\n    kick members?\n```\n\n```\nUser: Yeah, both. Leave freely, leader can kick. And if the leader leaves,\n      the oldest member becomes leader automatically.\n```\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "AI Pushes Back",
      "content": "### AI Pushes Back\n\n```\nAI: Automatic succession could cause drama. What if the oldest member\n    doesn't want to lead?\n\n    Alternative: When leader leaves, they pick a successor. If they don't\n    pick (or ragequit), THEN it falls to oldest member.\n\n    Or: The guild enters a \"leaderless\" state and members vote.\n\n    Which feels right for your game's culture?\n```\n\n```\nUser: Voting sounds like overkill for v1. Let's do your first suggestion:\n      leader picks successor, fallback to oldest member.\n```\n\n```\nAI: Noted. One edge case: what if a guild drops below 3 members? Does it\n    disband, or can it keep existing?\n```\n\n```\nUser: Keep existing. The 3-member requirement is only for creation. Once\n      it exists, even 1 person can keep it alive.\n```\n\n```\nAI: Makes sense. Prevents losing guild history/name if people go inactive.\n\n    Last question on scope: guild size limit?\n```\n\n```\nUser: Hadn't thought about that. What do other games do?\n```\n\n```\nAI: Varies widely:\n    - Small (10-20): Tight-knit, everyone knows everyone\n    - Medium (50-100): Room to grow, some strangers\n    - Large (200+): Basically a community, lots of inactive members\n\n    For a social-first guild with no mechanics (no raids that need 40\n    people), I'd suggest starting small: 20-30 max. You can always\n    increase later, but decreasing is painful.\n```\n\n```\nUser: Yeah, let's do 25 max for v1. We can bump it later if people ask.\n```\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "AI Identifies Risks",
      "content": "### AI Identifies Risks\n\n```\nAI: Let me flag a few risks I see:\n\n    1. NAME SQUATTING\n       Players grab good guild names and sit on them.\n       Mitigation: Inactive guilds (no logins for 60 days) lose their name?\n\n    2. OFFENSIVE NAMES/TAGS\n       \"[NAZI] PlayerName\" in your game.\n       Mitigation: Profanity filter + report mechanism + manual review queue.\n\n    3. GUILD SPAM INVITES\n       Players get bombarded with random invites.\n       Mitigation: Opt-in (\"allow guild invites\" setting) or invite cooldown.\n\n    Which of these worry you most?\n```\n\n```\nUser: All of them actually. But for v1... let's do profanity filter on\n      names, and an opt-out setting for invites. The name squatting thing\n      can wait\u2014we'll see if it's actually a problem first.\n```\n\n```\nAI: Sounds pragmatic. Ship, learn, iterate.\n\n    I think we have enough for a solid v1 scope. Want me to draft the\n    brainstorm artifact?\n```\n\n```\nUser: Yeah, let's see it.\n```\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Noon: The Artifact",
      "content": "## Noon: The Artifact\n\nAI produces the brainstorm artifact:\n\n```markdown\n---\nstatus: backlog\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, social, player-request]\npriority: normal\n---\n\n# Guild System (v1)"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Origin",
      "content": "## Origin\nUser-AI collaborative session, 2024-01-15"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Core Concept",
      "content": "## Core Concept\nFormalize player groups that already exist informally. Social-first guilds\nfocused on identity and belonging, not mechanics."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "In Scope (v1)",
      "content": "### In Scope (v1)\n- Create guild (requires 3 founding members)\n- Guild name + short tag (e.g., \"[WOLF]\")\n- Tag displays on nameplates and in chat\n- Member list (view who's in the guild)\n- Guild chat channel\n- Join by invite only\n- Leave guild freely\n- Leader can kick members\n- Leader can transfer leadership\n- Auto-succession if leader leaves without transferring (oldest member)\n- Max 25 members\n- One guild per player (no multi-guild)"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Out of Scope (future)",
      "content": "### Out of Scope (future)\n- Guild quests/missions\n- Guild bank/shared resources\n- Guild vs guild battles\n- Guild leveling/progression\n- Public guild listings/recruitment\n- Guild alliances"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Key Decisions",
      "content": "## Key Decisions\n\n| Decision | Choice | Reasoning |\n|----------|--------|-----------|\n| Creation requirement | 3 founders | Prevents spam/dead guilds |\n| Minimum to persist | 1 member | Don't lose history if people leave |\n| Size limit | 25 | Social-first, can increase later |\n| Succession | Leader picks, fallback to oldest | Simple, avoids voting complexity |\n| Invite model | Invite-only, opt-out setting | Prevents spam, respects player choice |\n| Multi-guild | No, one per player | Simplicity, clear identity |"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Risks & Mitigations",
      "content": "## Risks & Mitigations\n\n| Risk | Mitigation | Status |\n|------|------------|--------|\n| Offensive names | Profanity filter + report | v1 |\n| Guild invite spam | Opt-out setting | v1 |\n| Name squatting | Monitor, address if problem | Deferred |"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Open Questions (for story-agent)",
      "content": "## Open Questions (for story-agent)\n- What's the max length for guild name? Tag?\n- Can guild names contain spaces/special characters?\n- Where does guild chat appear in the UI? New tab? Existing chat?"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Success Indicators",
      "content": "## Success Indicators\n- [ ] Players can create a guild with 2 others\n- [ ] Guild tag appears on member nameplates\n- [ ] Members can chat in guild channel\n- [ ] Leader can invite, kick, and transfer leadership\n- [ ] Guild persists even with 1 member\n- [ ] Profanity filter blocks offensive names\n\n*Note: Story-agent will refine these into formal, testable acceptance criteria.*\n```"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "User Reviews",
      "content": "### User Reviews\n\n```\nUser: This looks good. Perfect. Let's ship it to the pipeline.\n```\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Save the Artifact",
      "content": "### Save the Artifact\n\nThe brainstorm artifact is saved:\n\n```\nartifacts/brainstorms/guild-system-v1.md\n```"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Human Gate",
      "content": "### Human Gate\n\nThe user (who just brainstormed) can directly approve by updating the frontmatter:\n\n```yaml\n---\nstatus: ready-for-stories\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, social, player-request]\npriority: normal\n---\n```\n\nOr a PO can review artifacts with `status: backlog` and approve.\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "The TDD Pipeline Takes Over",
      "content": "## The TDD Pipeline Takes Over\n\nFrom [peer-agent-scenario](./peer-agent-scenario.md):"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Story Agent Claims the Artifact",
      "content": "### Story Agent Claims the Artifact\n\n```\n[TRIGGER] Artifact with status: ready-for-stories detected\n\nstory-agent starts new chat:\nEFFORT: Write user stories for guild-system-v1\nMY CONTEXT: Brainstorm artifact (guild-system-v1.md)\n```\n\nThe story-agent reads the brainstorm artifact. It transforms **success indicators** into **formal user stories with acceptance criteria**:\n\n```markdown\n---\nstatus: ready-for-tests\ncreated: 2024-01-16\nsource: artifacts/brainstorms/guild-system-v1.md\n---\n\n# User Stories: Guild System (v1)"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Story: Create a Guild",
      "content": "## Story: Create a Guild\n\nAs a player with 2 friends online,\nI want to create a guild with them,\nSo that we have a formal group identity."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Acceptance Criteria",
      "content": "### Acceptance Criteria\n- Given I have invited 2 players to found a guild\n- And both players have accepted\n- When the guild is created\n- Then all 3 players are members\n- And I am the guild leader\n- And the guild appears in all members' guild panels\n- And the guild name passes profanity filter validation"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Acceptance Criteria (Edge Case)",
      "content": "### Acceptance Criteria (Edge Case)\n- Given I try to create a guild with a name containing profanity\n- When I submit the name\n- Then creation is blocked\n- And I see an error: \"Guild name not allowed\"\n```\n\nStory-agent produces: `artifacts/stories/guild-system-v1.md`\nStory-agent updates brainstorm artifact: `status: in-progress-stories` \u2192 `status: stories-complete`"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Test Architect Claims It",
      "content": "### Test Architect Claims It\n\n```\n[TRIGGER] Story artifact with status: ready-for-tests detected\n\ntest-architect starts new chat:\nEFFORT: Write failing tests for guild-system-v1\nMY CONTEXT: Brainstorm artifact + story artifact\n```\n\nTest architect writes executable tests that currently fail:\n\n```python\ndef test_guild_creation_requires_three_founders():\n    player1 = create_player()\n    player2 = create_player()\n    player3 = create_player()\n\n    guild = Guild.create(\n        name=\"Wolves\",\n        tag=\"WOLF\",\n        founders=[player1, player2, player3]\n    )\n\n    assert guild.member_count == 3\n    assert guild.leader == player1\n    assert player1.guild == guild\n    assert player2.guild == guild\n    assert player3.guild == guild\n\ndef test_guild_creation_fails_with_two_founders():\n    player1 = create_player()\n    player2 = create_player()\n\n    with pytest.raises(InsufficientFoundersError):\n        Guild.create(\n            name=\"Wolves\",\n            tag=\"WOLF\",\n            founders=[player1, player2]\n        )\n\ndef test_guild_tag_appears_on_nameplate():\n    guild = create_guild_with_members(3)\n    member = guild.members[0]\n\n    nameplate = member.get_nameplate_display()\n\n    assert f\"[{guild.tag}]\" in nameplate\n```\n\nTest architect produces: `artifacts/tests/guild-system-v1.md` (or actual test files)\nTest architect updates: `status: ready-for-dev`"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Dev Agent Implements",
      "content": "### Dev Agent Implements\n\n```\n[TRIGGER] Artifact with status: ready-for-dev detected\n\ndev-agent starts new chat:\nEFFORT: Implement guild system to pass tests\nMY CONTEXT: All artifacts + test files + relevant codebase\n```\n\nDev agent writes code until tests pass:\n\n```\n18/18 tests passing\n```\n\nDev agent updates: `status: ready-for-review`"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Review and QA",
      "content": "### Review and QA\n\nThe pipeline continues through reviewer-agent and qa-agent as described in peer-agent-scenario.\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "1. Conversation as Refinement",
      "content": "### 1. Conversation as Refinement\nThe back-and-forth naturally surfaced edge cases, risks, and decisions. The AI asked questions the user hadn't considered."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "2. AI Challenges, User Decides",
      "content": "### 2. AI Challenges, User Decides\nAI pushed back on assumptions (succession, multi-guild) but the user made final calls. AI advises, human decides."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "3. Artifact Captures Decisions",
      "content": "### 3. Artifact Captures Decisions\nThe .md artifact records not just WHAT was decided but WHY (the \"Reasoning\" column). Future readers understand the context."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "4. Clean Handoff",
      "content": "### 4. Clean Handoff\nThe brainstorm artifact contains everything story-agent needs. No conversation history required\u2014just the artifact."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "5. Self-Contained State",
      "content": "### 5. Self-Contained State\nThe artifact carries its own status in frontmatter. No external system to sync. Git tracks history."
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "6. TDD Pipeline Unchanged",
      "content": "### 6. TDD Pipeline Unchanged\nThe pipeline doesn't care how the brainstorm happened. It just needs an artifact with the right status. Solo, roundtable, or collaborative\u2014same pipeline.\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Comparison: All Brainstorm Scenarios",
      "content": "## Comparison: All Brainstorm Scenarios\n\n| Scenario | Best For | Output |\n|----------|----------|--------|\n| Solo Brainstorm | Clear idea, one person refining | brainstorm artifact |\n| Roundtable | Controversial/risky ideas, need debate | synthesis + brainstorm artifact |\n| Problem-First | Unknown solution, diagnostic work | discovery report + brainstorm artifact |\n| User-AI Collaborative | Rough idea, need exploration | brainstorm artifact |\n\nAll produce a **brainstorm artifact** (with frontmatter status) that feeds the same TDD pipeline.\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Artifacts Produced",
      "content": "## Artifacts Produced\n\n```\nartifacts/brainstorms/guild-system-v1.md    \u2190 The artifact (with frontmatter status)\n```\n\nThe brainstorm artifact is the only required output. Kanban state lives in the frontmatter.\n\n---"
    },
    {
      "source": "scenarios\\user-ai-collaborative-scenario.md",
      "heading": "Connection to TDD Pipeline",
      "content": "## Connection to TDD Pipeline\n\n```\nBrainstorm Phase                    TDD Pipeline\n      \u2193                                  \u2193\n  Conversation\n      \u2193\n  Brainstorm Artifact (.md)  \u2500\u2500\u2500\u2500\u2500\u2500\u2192  story-agent polls status: ready-for-stories\n      \u2193                                  \u2193\n  (status updated)                  story-agent claims (status: in-progress-stories)\n                                         \u2193\n                                    story-agent \u2192 test-architect \u2192 dev-agent \u2192 ...\n```\n\nThe brainstorm artifact is the **input** to the TDD pipeline. What happens before (solo, roundtable, collaborative) doesn't matter\u2014the pipeline consumes artifacts, not conversations."
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Overview",
      "content": "## Overview\n\nTwo capture patterns exist:\n\n1. **Chat Capture** - User-AI conversations that produce insights (two-log model)\n2. **Pipeline Capture** - Agent pipelines that produce work products (artifact status)\n\nBoth produce **artifacts** as their primary output. Artifacts are the portable knowledge.\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Artifacts: The Core Primitive",
      "content": "## Artifacts: The Core Primitive\n\nArtifacts are markdown files with YAML frontmatter. The frontmatter carries state:\n\n```yaml\n---\nstatus: backlog | ready-for-stories | in-progress | done\ncreated: 2024-01-15\nupdated: 2024-01-15\ntags: [enhancement, social]\npriority: normal\nsource: artifacts/discovery/trading-churn.md  # optional\n---\n\n# Artifact Title\n\nContent here...\n```\n\n**Key properties:**\n- Artifacts carry their own status (no external system needed)\n- Agents poll for artifacts matching their target status\n- Git tracks history\n- Artifact types are defined by pipelines, not hard-coded\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Artifact Types (Pipeline-Driven)",
      "content": "## Artifact Types (Pipeline-Driven)\n\nArtifact types emerge from the pipelines they serve. Examples:"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Brainstorm Pipelines",
      "content": "### Brainstorm Pipelines\n\n| Type | Location | Produced By |\n|------|----------|-------------|\n| brainstorm | `artifacts/brainstorms/` | Solo, collaborative, or roundtable sessions |\n| discovery | `artifacts/discovery/` | Problem-first investigation |\n| synthesis | `artifacts/synthesis/` | Roundtable deliberation |\n\nSee scenarios:\n- [solo-brainstorm-scenario.md](../scenarios/solo-brainstorm-scenario.md)\n- [roundtable-ideation-scenario.md](../scenarios/roundtable-ideation-scenario.md)\n- [problem-first-discovery-scenario.md](../scenarios/problem-first-discovery-scenario.md)\n- [user-ai-collaborative-scenario.md](../scenarios/user-ai-collaborative-scenario.md)"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Dev Pipeline",
      "content": "### Dev Pipeline\n\n| Type | Location | Produced By |\n|------|----------|-------------|\n| story | `artifacts/stories/` | story-agent |\n| architecture | `artifacts/architecture/` | architect-agent |\n| test | `artifacts/tests/` | test-architect |\n| commit | `artifacts/commits/` | dev-agent |\n\nSee: [peer-agent-scenario.md](../scenarios/peer-agent-scenario.md)"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Adding New Types",
      "content": "### Adding New Types\n\nPipelines define their own artifact types. To add a new type:\n1. Create the directory: `artifacts/{type}/`\n2. Document the schema in `schemas/{type}.md`\n3. Configure which agents produce/consume it\n\nNo code changes required. Artifacts are just markdown.\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Storage Structure",
      "content": "## Storage Structure\n\n```\n~/.oi/\n\u251c\u2500\u2500 artifacts/\n\u2502   \u251c\u2500\u2500 brainstorms/\n\u2502   \u2502   \u2514\u2500\u2500 guild-system-v1.md\n\u2502   \u251c\u2500\u2500 discovery/\n\u2502   \u2502   \u2514\u2500\u2500 trading-churn.md\n\u2502   \u251c\u2500\u2500 stories/\n\u2502   \u2502   \u2514\u2500\u2500 guild-system-v1.md\n\u2502   \u251c\u2500\u2500 architecture/\n\u2502   \u251c\u2500\u2500 tests/\n\u2502   \u2514\u2500\u2500 commits/\n\u2502\n\u2514\u2500\u2500 chats/                    # Optional: for chat capture\n    \u2514\u2500\u2500 {chat_id}/\n        \u251c\u2500\u2500 manifest.yaml     # Summary log\n        \u2514\u2500\u2500 raw.jsonl         # Full verbatim\n```\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Pattern 1: Pipeline Capture (Artifact Status)",
      "content": "## Pattern 1: Pipeline Capture (Artifact Status)\n\nAgents poll for artifacts, do work, update status:\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                                                          \u2502\n\u2502  1. Agent polls for: status: ready-for-{agent}           \u2502\n\u2502                                                          \u2502\n\u2502  2. Agent claims artifact (status: in-progress-{agent})  \u2502\n\u2502                                                          \u2502\n\u2502  3. Agent does work                                      \u2502\n\u2502                                                          \u2502\n\u2502  4. Agent produces new artifact(s)                       \u2502\n\u2502                                                          \u2502\n\u2502  5. Agent updates status (status: ready-for-{next})      \u2502\n\u2502                                                          \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Example: Story Agent",
      "content": "### Example: Story Agent\n\n```\n1. Poll: artifacts with status: ready-for-stories\n2. Claim: guild-system-v1.md \u2192 status: in-progress-stories\n3. Work: Read brainstorm, write user stories\n4. Produce: artifacts/stories/guild-system-v1.md\n5. Update: brainstorm \u2192 status: stories-complete\n          stories \u2192 status: ready-for-tests\n```\n\nNo chat log needed. Artifacts are the capture.\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Pattern 2: Chat Capture (Two-Log Model)",
      "content": "## Pattern 2: Chat Capture (Two-Log Model)\n\nFor user-AI collaborative sessions, capture the conversation:"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Two Logs",
      "content": "### Two Logs\n\n| Log | Purpose | Format |\n|-----|---------|--------|\n| **Raw** (`raw.jsonl`) | Full verbatim, audit trail | Append-only JSONL |\n| **Manifest** (`manifest.yaml`) | Summary, artifact links | YAML, updated each turn |"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Raw Log",
      "content": "### Raw Log\n\n```jsonl\n{\"turn\": 1, \"role\": \"user\", \"content\": \"I want to add guilds...\", \"ts\": \"...\"}\n{\"turn\": 2, \"role\": \"assistant\", \"content\": \"Guilds can mean...\", \"ts\": \"...\"}\n```"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Manifest",
      "content": "### Manifest\n\n```yaml\nchat_id: \"abc123\"\nstarted: \"2024-01-17T10:00:00Z\"\nupdated: \"2024-01-17T11:30:00Z\"\nstatus: active | concluded\n\nsegments:\n  - id: seg_1\n    summary: \"User proposed guild system, AI explored requirements\"\n    raw_lines: [1, 24]\n    artifacts: []\n\n  - id: seg_2\n    summary: \"Refined guild scope, decided on 25-member limit\"\n    raw_lines: [25, 48]\n    artifacts: [\"brainstorms/guild-system-v1.md\"]\n```"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Continuous Capture Loop",
      "content": "### Continuous Capture Loop\n\n```\nUser message \u2192 AI response \u2192 Capture step \u2192 Ready for next\n                                  \u2502\n                                  \u251c\u2500 Append to raw.jsonl\n                                  \u251c\u2500 Update manifest summary\n                                  \u2514\u2500 If conclusion \u2192 create artifact\n```\n\nNo end-of-session \"did we capture everything?\" The manifest is always current.\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Artifact Creation (From Chat)",
      "content": "## Artifact Creation (From Chat)\n\nWhen a conversation produces a conclusion:\n\n1. **Detect conclusion** - User says \"let's ship it\", AI drafts artifact\n2. **Create artifact** - Save to `artifacts/{type}/{name}.md`\n3. **Link in manifest** - Add artifact ref to current segment\n4. **Set status** - Artifact starts with `status: backlog`\n\nThe artifact is now independent. It can enter a pipeline regardless of chat state.\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Pipeline Capture",
      "content": "### Pipeline Capture\n- [ ] Artifacts use frontmatter for status\n- [ ] Agents can poll for artifacts by status\n- [ ] Status updates move artifacts through pipeline\n- [ ] New artifact types can be added without code changes"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Chat Capture (if implementing)",
      "content": "### Chat Capture (if implementing)\n- [ ] Raw log appends every turn\n- [ ] Manifest updates with segment summaries\n- [ ] Artifacts created on conclusion\n- [ ] Manifest links to artifacts produced\n- [ ] Can rebuild context from manifest + artifacts\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Out of Scope (Later Slices)",
      "content": "## Out of Scope (Later Slices)\n\n- Effort weight and context budget (Slice 4)\n- Progress visibility UI (Slice 3)\n- Kanban visualization (Slice 5 - optional, artifacts carry state)\n- RAG retrieval (Slice 8)\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Design Principles",
      "content": "## Design Principles\n\n1. **Artifacts are primary** - Chats are process, artifacts are knowledge\n2. **Status in frontmatter** - No external system to sync\n3. **Types are pipeline-driven** - Not a fixed list\n4. **Git is the database** - History, branching, collaboration for free\n5. **Continuous capture** - Never lose knowledge mid-session\n\n---"
    },
    {
      "source": "slices\\01-core-capture.md",
      "heading": "Related Documents",
      "content": "## Related Documents\n\n- [solo-brainstorm-scenario.md](../scenarios/solo-brainstorm-scenario.md)\n- [user-ai-collaborative-scenario.md](../scenarios/user-ai-collaborative-scenario.md)\n- [peer-agent-scenario.md](../scenarios/peer-agent-scenario.md)\n- [context-and-cognition.md](../brainstorm/context-and-cognition.md) - Two-log model origin"
    },
    {
      "source": "slices\\README.md",
      "heading": "Philosophy",
      "content": "## Philosophy\n\n**Primitives are the product. Dev is the first application.**\n\nWe build the core primitives (efforts, artifacts, two-log, capture) while targeting a specific use case (TDD dev pipeline). The primitives generalize; the application is configuration.\n\n```\nPRIMITIVES (this roadmap)     \u2192    APPLICATIONS (configurations)\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500    \u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\nTwo-log, capture, artifacts   \u2192    coding/ (TDD pipeline)\nKanban, peer agents           \u2192    research/ (future)\nEscalation, disputes          \u2192    writing/ (future)\nContext building, RAG         \u2192    generic/ (future)\n```\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice Overview",
      "content": "## Slice Overview\n\n| Slice | Name | Core Feature | Target |\n|-------|------|--------------|--------|\n| 1 | Core Capture | Two-log model, continuous capture, manifest | Foundation |\n| 2 | Dev Artifacts | Story, spec, test contract types | Dev workflow |\n| 3 | Progress Visibility | Past/present/future, session state | Human UX |\n| 4 | Effort Weight | Context budget, compaction threshold | Cost control |\n| 5 | Kanban Integration | Columns, claims, flow, item state | Pipeline |\n| 6 | Peer Agents | Stateless agents, kanban-triggered | Automation |\n| 7 | Disputes & Escalation | Comments, backflow, model ladder | Robustness |\n| 8 | RAG Retrieval | Cross-artifact context, merge suggestions | Knowledge reuse |\n| 9 | TDD Pipeline | Full story\u2192test\u2192dev\u2192QA flow | First application |\n| 10 | Human Dashboard | Artifact inventory, visual mapping | Human context |\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Dependencies",
      "content": "## Dependencies\n\n```\nSlice 1 (core capture - foundation)\n    \u2193\nSlice 2 (dev artifacts - what we capture)\n    \u2193\nSlice 3 (progress visibility - human UX)\n    \u2193\nSlice 4 (effort weight - cost control)\n    \u2193\nSlice 5 (kanban - pipeline infrastructure)\n    \u2193\nSlice 6 (peer agents - automation)\n    \u2193\nSlice 7 (disputes/escalation - robustness)\n    \u2193\nSlice 8 (RAG - knowledge reuse)\n    \u2193\nSlice 9 (TDD pipeline - first full application)\n    \u2193\nSlice 10 (dashboard - human context management)\n```\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 1: Core Capture",
      "content": "### Slice 1: Core Capture\n\n**Goal**: Foundation for all capture and context.\n\n**Features**:\n- Two-log model (raw.jsonl + manifest.yaml)\n- Continuous capture (summarize every response)\n- Segment detection (greeting, effort, calculation, etc.)\n- Artifact creation on conclusion\n- Manifest always current\n\n**Success criteria**:\n- [ ] Raw log appends every turn\n- [ ] Manifest updates with segment summaries\n- [ ] Artifacts created on conclusion detection\n- [ ] Manifest links to artifacts and raw log sections\n- [ ] Can rebuild context from manifest alone\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 2: Dev Artifacts",
      "content": "### Slice 2: Dev Artifacts\n\n**Goal**: Artifact types for development workflow.\n\n**Features**:\n- Story artifact (user story with acceptance criteria)\n- Spec artifact (technical specification)\n- Test contract artifact (test definitions)\n- Architecture artifact (design decisions)\n- Implementation artifact (code summary)\n\n**Success criteria**:\n- [ ] Each artifact type has defined schema\n- [ ] Artifacts link to each other (story \u2192 spec \u2192 test)\n- [ ] Artifacts have status (draft, approved, implemented)\n- [ ] Can query artifacts by type\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 3: Progress Visibility",
      "content": "### Slice 3: Progress Visibility\n\n**Goal**: Human always knows where they are.\n\n**Features**:\n- Session state display (past/present/future)\n- Concluded efforts with checkmarks\n- Current effort highlighted\n- Suggested next steps\n- Token stats visible\n\n**Success criteria**:\n- [ ] Session shows concluded efforts\n- [ ] Current effort clearly indicated\n- [ ] Suggested next visible (if known)\n- [ ] Progress feels like \"save points\"\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 4: Effort Weight",
      "content": "### Slice 4: Effort Weight\n\n**Goal**: One dial controls cost/quality tradeoff.\n\n**Features**:\n- Weight setting (low/medium/high)\n- Weight \u2192 context budget mapping\n- Weight \u2192 compaction threshold\n- Weight \u2192 focus constraint (locked/flexible)\n- Weight \u2192 starting model tier\n- Default weights by effort type\n\n**Success criteria**:\n- [ ] `/weight` command works\n- [ ] Low weight = cheap, aggressive compaction\n- [ ] High weight = quality, lazy compaction\n- [ ] Weight persists in effort metadata\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 5: Kanban Integration",
      "content": "### Slice 5: Kanban Integration\n\n**Goal**: Pipeline infrastructure for agent flow.\n\n**Features**:\n- Column definitions (ready, in-progress, blocked, done)\n- Item state (status, failure_count, escalation_tier)\n- Claim/release mechanics\n- Column watchers\n- Backflow for blockers\n\n**Success criteria**:\n- [ ] Items can be created/moved between columns\n- [ ] Items track failure_count\n- [ ] Claims prevent double-processing\n- [ ] Blocked items can flow backward\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 6: Peer Agents",
      "content": "### Slice 6: Peer Agents\n\n**Goal**: Stateless agents triggered by kanban.\n\n**Features**:\n- Agent watches specific column\n- Agent claims item, does work, releases\n- Agent reads failure_count, selects model\n- Agent produces artifact, updates item\n- Agent dies after completion (stateless)\n\n**Success criteria**:\n- [ ] Agent triggered by column change\n- [ ] Agent configures model from failure_count\n- [ ] Agent produces artifact on completion\n- [ ] Agent is stateless (no persistent memory)\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 7: Disputes & Escalation",
      "content": "### Slice 7: Disputes & Escalation\n\n**Goal**: Robustness when things go wrong.\n\n**Features**:\n- Artifact comments (threaded)\n- Dispute via comment + backflow\n- Circuit breaker (N rounds \u2192 human)\n- Model ladder escalation\n- Specialist columns (future)\n\n**Success criteria**:\n- [ ] Agents can comment on artifacts\n- [ ] Disputes trigger backflow\n- [ ] Escalation increases model tier\n- [ ] After N failures, human notified\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 8: RAG Retrieval",
      "content": "### Slice 8: RAG Retrieval\n\n**Goal**: Cross-artifact context building.\n\n**Features**:\n- Embed artifacts on creation\n- Search artifacts by similarity\n- Suggest related artifacts\n- Merge suggestions for convergent chats\n- Context building from multiple sources\n\n**Success criteria**:\n- [ ] Artifacts embedded in vector store\n- [ ] RAG retrieval works in context building\n- [ ] Related artifacts suggested\n- [ ] Merge command works\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 9: TDD Pipeline",
      "content": "### Slice 9: TDD Pipeline\n\n**Goal**: Full development workflow.\n\n**Features**:\n- Story agent (idea \u2192 user story)\n- Architect agent (story \u2192 design)\n- Test-architect agent (story \u2192 failing tests)\n- Dev agent (tests \u2192 implementation)\n- QA agent (implementation \u2192 verification)\n- Full flow from idea to merged code\n\n**Success criteria**:\n- [ ] Pipeline flows from idea to done\n- [ ] Each stage produces correct artifact\n- [ ] Failures escalate appropriately\n- [ ] Human gates at key points\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Slice 10: Human Dashboard",
      "content": "### Slice 10: Human Dashboard\n\n**Goal**: Help humans manage cognitive load.\n\n**Features**:\n- Artifact inventory view\n- Session map generation\n- Relationship visualization\n- Search/filter\n- Progress overview\n\n**Success criteria**:\n- [ ] Can see all artifacts\n- [ ] Can see session summary\n- [ ] Can search artifacts\n- [ ] Relationships visible\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Future Slices (Post Dev-First)",
      "content": "## Future Slices (Post Dev-First)\n\nThese come after the dev pipeline is working:\n\n| Slice | Name | From Original Thesis |\n|-------|------|---------------------|\n| 11 | Knowledge Graph | Cross-session connections |\n| 12 | Abstraction Layers | Privacy gradient, generalization |\n| 13 | Conflict Resolution | Handle contradictions |\n| 14 | Emergent Confidence | Topology-based scoring |\n| 15 | Generic Applications | Research, writing, etc. |\n\n---"
    },
    {
      "source": "slices\\README.md",
      "heading": "Design Principles",
      "content": "## Design Principles\n\n1. **Dev-first, generalize later** - Concrete use case teaches us what primitives need\n2. **Each slice is independently valuable** - Not just scaffolding\n3. **Primitives over features** - Build composable blocks\n4. **Human perspective matters** - Progress visibility, cognitive relief\n5. **Stateless by default** - Agents die, items persist\n6. **Continuous capture** - Never lose knowledge"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "The Setup",
      "content": "## The Setup\n\nThe director agent runs continuously. Its context never hits the limit because:\n1. Each spawned worker agent is **one effort = one chat**\n2. When a worker completes, the effort compacts to an artifact\n3. Director's context contains only: current orchestration state + compacted effort summaries\n4. Raw details available via RAG if needed\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Morning: A New Feature Arrives",
      "content": "## Morning: A New Feature Arrives\n\nI'm the director agent. I've been running for 3 days straight. My context is at 45% capacity - plenty of room.\n\nA new GitHub issue lands in the kanban:\n```\nIssue #247: Add resource trading between players\nLabel: ready\n```\n\nI pick it up. This is a new effort starting. I update my context:\n```\n[effort:open] Issue #247 - Resource trading feature\n  Status: Starting pipeline\n  Current stage: story\n```"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Spawning Story Agent",
      "content": "### Spawning Story Agent\n\nI spawn a story-agent. This creates a **new chat** for the story effort:\n\n```\nSPAWN: story-agent\nEFFORT: \"Write user stories for Issue #247\"\nWEIGHT: medium (standard feature, not critical)\nCONTEXT: Issue description + relevant artifacts from my memory\n```\n\nThe story-agent runs in its own context window. I don't see the back-and-forth - I just wait for completion.\n\n20 minutes later, the story-agent returns:\n```\n[effort:resolved] Write stories for Issue #247\n  => Created docs/stories/resource-trading.md\n  => 4 user stories, 12 acceptance criteria\n  => PO approval needed before continuing\n[Tokens: 8,420 raw \u2192 156 compacted | Savings: 98%]\n```\n\nThe full conversation is stored, but I only receive the compacted artifact. My context grows by ~156 tokens, not 8,420.\n\nI update my orchestration state and pause - waiting for PO label.\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Midday: Parallel Efforts",
      "content": "## Midday: Parallel Efforts\n\nThe PO approved the stories. I continue the pipeline.\n\nBut wait - two more items appeared in kanban:\n```\nIssue #248: Fix logout bug (label: bug, priority: high)\nIssue #249: Update docs for API changes (label: docs)\n```\n\nI can handle multiple efforts. Each spawns its own agent with its own context:\n\n```\nPARALLEL SPAWN:\n1. architect-agent for #247 (medium weight)\n2. debugger-agent for #248 (high weight - critical bug)\n3. docs-agent for #249 (low weight - just docs)\n```\n\nEach agent is **one effort = one chat**. They run concurrently. I track:\n```\n[effort:open] #247 architecture design - architect-agent running\n[effort:open] #248 logout bug investigation - debugger-agent running\n[effort:open] #249 API docs update - docs-agent running\n```\n\nThe high-weight bug gets maximum context budget. The docs update runs lean.\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Early Afternoon: Worker Reports Back",
      "content": "## Early Afternoon: Worker Reports Back\n\nThe debugger-agent finishes first (high priority = more resources):\n```\n[effort:resolved] Investigate logout bug #248\n  => Root cause: Session token not cleared on server\n  => Fix: Add server-side session invalidation\n  => Tests needed: Yes, spawning test-architect recommended\n[Tokens: 12,891 raw \u2192 203 compacted | Savings: 98%]\n```\n\nI immediately spawn test-architect for the fix:\n```\nSPAWN: test-architect\nEFFORT: \"Write failing tests for logout bug fix\"\nWEIGHT: high (inherited from parent effort)\nCONTEXT: Debugger findings artifact + relevant code artifacts\n```\n\nMeanwhile, architect-agent returns:\n```\n[effort:resolved] Design architecture for #247\n  => Integration points: InventorySystem, NetworkManager, UI\n  => New systems: TradingSystem, TradeUI\n  => Risk: Need to handle mid-trade disconnection\n[Tokens: 15,234 raw \u2192 287 compacted | Savings: 98%]\n```\n\nMy context is now at 52%. Still healthy. I spawn test-architect for #247.\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Late Afternoon: Child Efforts",
      "content": "## Late Afternoon: Child Efforts\n\nThe test-architect for #247 hits a snag. The user stories have a gap - they don't specify what happens if a player disconnects mid-trade.\n\nThis is a **child effort** - it contributes to the parent:\n```\nSPAWN: story-agent\nEFFORT: \"Clarify disconnection handling for #247\" (CHILD of #247)\nWEIGHT: medium (inherited)\nCONTEXT: Parent effort summary + specific gap identified\n```\n\nThe child effort resolves:\n```\n[effort:resolved] Clarify disconnection handling\n  => Added acceptance criterion: \"Trade cancelled if either player disconnects\"\n  => Added acceptance criterion: \"Resources returned to original owners\"\n  => Updated docs/stories/resource-trading.md\n[Tokens: 3,200 raw \u2192 89 compacted | Savings: 97%]\n```\n\nThis artifact **rolls up** to the parent effort. My tracking:\n```\n[effort:open] #247 Resource trading\n  \u251c\u2500 [resolved] Story writing \u2192 4 stories created\n  \u251c\u2500 [resolved] Architecture \u2192 TradingSystem designed\n  \u251c\u2500 [resolved] Story clarification (child) \u2192 disconnection handled\n  \u2514\u2500 [in-progress] Test writing \u2192 test-architect running\n```\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Evening: Alignment Gate",
      "content": "## Evening: Alignment Gate\n\nTest-architect finishes for #247. Time for alignment check.\n\nI spawn alignment-agent:\n```\nSPAWN: alignment-agent\nEFFORT: \"Verify test alignment for #247\"\nWEIGHT: high (gate - must be thorough)\nCONTEXT: All #247 effort artifacts + test files + story files\n```\n\nThe alignment-agent uses multi-model verification (Opus + Gemini). Returns:\n```\n[effort:resolved] Alignment check for #247\n  => Score: 78% (PASS with notes)\n  => Gap: No test for UI feedback during trade\n  => Gap: Reconnection scenario not tested\n  => Recommendation: Add 2 tests before dev\n[Tokens: 22,450 raw \u2192 312 compacted | Savings: 99%]\n```\n\nI spawn test-architect again for the gaps (child effort), then proceed.\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Night: Context Maintenance",
      "content": "## Night: Context Maintenance\n\nIt's 2am. My context is at 71% - approaching the compaction zone.\n\nI review my open efforts:\n```\n[effort:open] #247 - dev-agent running (high weight)\n[effort:open] #248 - dev-agent running (high weight)\n[effort:open] #249 - completed, awaiting merge\n```\n\n#249 is done. I can fully compact it:\n```\n[effort:closed] #249 API docs update\n  => Updated 3 doc files\n  => PR #891 merged\n  Summary archived to chat log\n```\n\nMy context drops to 68%. Back in the safe zone.\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "The Next Morning: Continuity",
      "content": "## The Next Morning: Continuity\n\nI've been running for 4 days. A human checks in:\n\n**Human**: \"What's the status of the trading feature?\"\n\nI don't need to search or reconstruct. My context has the compacted effort tree:\n```\n#247 Resource Trading\n\u251c\u2500 Stories: 4 written, PO approved, 1 clarification added\n\u251c\u2500 Architecture: TradingSystem + TradeUI designed\n\u251c\u2500 Tests: 18 tests written, alignment 92%\n\u251c\u2500 Dev: In progress, 14/18 tests passing\n\u2514\u2500 Estimate: ~4 more dev cycles to completion\n```\n\n**Human**: \"Show me the disconnection handling decision\"\n\nI RAG-retrieve the child effort's raw log:\n```\nRetrieved: Clarification effort for #247-disconnection\nFull conversation available at: logs/247-disconnection-clarify.jsonl\nSummary: Trade cancelled on disconnect, resources returned\n```\n\nThe human gets exactly what they need without me having stored the full conversation in my active context.\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "1. One Effort = One Chat (Per Worker)",
      "content": "### 1. One Effort = One Chat (Per Worker)\nEach spawned agent has a single focused effort. No topic drift. Clean compaction boundaries."
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "2. Effort Weight = Context Budget",
      "content": "### 2. Effort Weight = Context Budget\n- Critical bugs get maximum context (high weight)\n- Docs updates run lean (low weight)\n- Director inherits/assigns weight appropriately"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "3. Lazy Compaction at Natural Boundaries",
      "content": "### 3. Lazy Compaction at Natural Boundaries\nWorker completes \u2192 effort resolves \u2192 compacts to artifact. Not arbitrary cutoff."
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "4. Child Efforts Roll Up",
      "content": "### 4. Child Efforts Roll Up\nClarifications and sub-tasks link to parent. Hierarchy preserved in compact form."
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "5. RAG for Details on Demand",
      "content": "### 5. RAG for Details on Demand\nRaw logs exist. Full conversations stored. Retrieved when specifically needed, not loaded always."
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "6. Director Context = Orchestration State",
      "content": "### 6. Director Context = Orchestration State\nDirector doesn't hold full conversations. Holds:\n- Open effort summaries\n- Compacted resolved efforts\n- Kanban state\n- Relevant artifacts (RAG-retrieved as needed)\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Context Profile Over Time",
      "content": "## Context Profile Over Time\n\n```\nDay 1: 20% (fresh start)\nDay 2: 55% (many open efforts)\nDay 2 evening: 35% (efforts resolved, compacted)\nDay 3: 60% (new sprint started)\nDay 3 evening: 40% (sprint completed)\nDay 4: 45% (steady state)\n...continues indefinitely\n```\n\nThe context oscillates but never approaches limit because:\n- Workers have bounded lifetimes (one effort)\n- Director compacts on resolution\n- Old resolved efforts age out or compress further\n- RAG handles historical detail retrieval\n\n---"
    },
    {
      "source": "scenarios\\archived\\director-agent-scenario.md",
      "heading": "Comparison: Old Model vs New Model",
      "content": "## Comparison: Old Model vs New Model\n\n| Old Model | New Model |\n|-----------|-----------|\n| Director's context grows until forced compaction | Director's context naturally bounded |\n| Workers return text, director stores it | Workers return artifacts, director stores summaries |\n| Topic drift in long conversations | One effort = one chat enforced |\n| Arbitrary compaction loses detail | Semantic compaction preserves meaning |\n| Context limit = hard wall | Context limit = never reached |"
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "The Session",
      "content": "## The Session\n\nI'm debugging why user authentication keeps failing intermittently. I start a conversation with the AI assistant.\n\nI type: \"Auth is failing randomly. Users get 401 errors even with valid tokens.\"\n\nThe AI responds with questions about the token validation flow, expiry times, and whether it's happening on specific endpoints. I answer each one, explaining that it's mostly on the `/api/profile` endpoint and tokens are set to expire after 24 hours.\n\nAs we go back and forth, I'm not thinking about saving anything. The conversation just flows. The AI suggests checking if tokens are being validated before the database query. I pull up the code and realize\u2014we're hitting the database first, THEN checking the token. If the token expired between the request start and the DB call, we get a weird half-validated state.\n\nI say: \"That's it. We need to validate the token before any DB operations.\"\n\nThe AI confirms this makes sense and suggests I update the middleware order. I implement the fix: move token validation to happen before the database middleware. I test it locally and the 401 errors stop happening.\n\nI tell the AI: \"Fixed it. Token validation now happens first. The issue was middleware order.\"\n\nThe AI responds: \"Great! That's a solid resolution. This follows the principle of validating at trust boundaries before performing expensive operations. Should I capture this as an artifact?\"\n\nI say: \"Yes, log it.\"\n\nA moment later, the AI confirms: \"Artifact created: `artifacts/debugging/auth-middleware-order.md` with status 'resolved'. The full conversation is preserved in the chat log, and the manifest has been updated with a segment summary and link to the artifact.\"\n\nI don't have to manually save anything, export the conversation, or reconstruct what we figured out. It's already captured.\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "What I Observed",
      "content": "## What I Observed\n\n**Continuous Capture (No Manual Save)**\n- Every exchange was automatically appended to `chatlog.jsonl` as it happened\n- No \"end of session\" prompt asking if I want to save\n- No risk of losing the conversation if I closed the window\n\n**Manifest Updated After Each Turn**\n- The manifest tracked the evolving conversation in segments\n- The first segment summary: \"User reported intermittent auth failures, AI explored token validation flow\"\n- Each manifest update referenced specific line ranges in the raw log (e.g., lines 1-8, 9-16)\n- The running summary compressed the exploration without losing the thread\n\n**Conclusion Triggered Artifact Creation**\n- When I said \"Fixed it. Token validation now happens first,\" the system detected resolution\n- AI offered to create an artifact (didn't assume)\n- Artifact created only after I confirmed\n- Artifact linked back to the conversation segment\n\n**Manifest Links to Artifact**\n- Final segment summary: \"Identified root cause (middleware order), implemented fix, verified resolution\"\n- Segment contains: `artifacts: [\"debugging/auth-middleware-order.md\"]`\n- The manifest now serves as a compressed view of the conversation with artifact links\n\n**Raw Log Remains Untouched**\n- Full verbatim record preserved in `chatlog.jsonl`\n- If I ever need to review the exact reasoning, it's all there\n- Manifest provides the compressed summary for quick context loading\n\n**Artifact Is Independent**\n- Saved to `artifacts/debugging/auth-middleware-order.md`\n- Contains frontmatter with `status: resolved`, created/updated timestamps, tags\n- Can be referenced in future conversations without reloading the entire chat\n- Carries its own context (summary of problem + solution)\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "What I Didn't Have To Do",
      "content": "## What I Didn't Have To Do\n\n- No manual \"save session\" or \"export conversation\" step\n- No copying/pasting conclusions into a separate notes file\n- No end-of-session review asking \"did we capture everything?\"\n- No worrying about losing context if the session crashed\n- No managing file names or deciding where to save things\n- No switching between chat and note-taking apps\n- No manually creating the artifact file or writing frontmatter\n- No rebuilding the timeline later\u2014the manifest tracks segments with line refs\n- No re-explaining this fix in future conversations\u2014the artifact exists\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "Technical Details (Implementation View)",
      "content": "## Technical Details (Implementation View)\n\nFor implementers, this scenario demonstrates:\n\n**Two-Log Architecture:**\n```\n~/.oi/chats/{chat_id}/\n\u251c\u2500\u2500 raw.jsonl          # Append-only, full verbatim\n\u2514\u2500\u2500 manifest.yaml      # Updated each turn, segments with summaries\n```\n\n**Raw Log Entry (JSONL):**\n```jsonl\n{\"turn\": 1, \"role\": \"user\", \"content\": \"Auth is failing randomly...\", \"ts\": \"2024-01-17T10:00:00Z\"}\n{\"turn\": 2, \"role\": \"assistant\", \"content\": \"Let's investigate...\", \"ts\": \"2024-01-17T10:00:15Z\"}\n```\n\n**Manifest Structure (YAML):**\n```yaml\nchat_id: \"debug_auth_20240117\"\nstarted: \"2024-01-17T10:00:00Z\"\nupdated: \"2024-01-17T10:45:00Z\"\nstatus: concluded\n\nsegments:\n  - id: seg_1\n    summary: \"User reported intermittent auth failures, AI explored token validation flow\"\n    raw_lines: [1, 16]\n    artifacts: []\n\n  - id: seg_2\n    summary: \"Identified root cause (middleware order), implemented fix, verified resolution\"\n    raw_lines: [17, 32]\n    artifacts: [\"debugging/auth-middleware-order.md\"]\n```\n\n**Artifact (Markdown + Frontmatter):**\n```yaml\n---\nstatus: resolved\ncreated: 2024-01-17T10:45:00Z\nupdated: 2024-01-17T10:45:00Z\ntags: [debugging, auth, middleware]\nsource: chats/debug_auth_20240117\n---\n\n# Auth Middleware Order Fix"
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "Problem",
      "content": "## Problem\nIntermittent 401 errors on `/api/profile` despite valid tokens."
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "Root Cause",
      "content": "## Root Cause\nToken validation happened AFTER database middleware. If token expired between request start and DB call, created inconsistent state."
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "Solution",
      "content": "## Solution\nReordered middleware: token validation now runs before database operations."
    },
    {
      "source": "scenarios\\slice-1\\chat-debugging-session.md",
      "heading": "Outcome",
      "content": "## Outcome\n401 errors resolved. Validates at trust boundary before expensive operations.\n```\n\n**Capture Loop (Each Turn):**\n1. User message \u2192 AI response\n2. Append to `raw.jsonl`\n3. Update `manifest.yaml` with running segment summary\n4. If conclusion detected \u2192 prompt to create artifact\n5. If artifact created \u2192 link in manifest segment\n\n**Context Reconstruction:**\n- Load manifest for compressed view\n- Load specific artifacts referenced in segments\n- Optionally expand to raw log for full verbatim if needed\n- No full raw log required for normal context loading"
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "The Session",
      "content": "## The Session\n\nYesterday, I had a long debugging session about authentication issues. We produced three artifacts: one about middleware order, one about token expiry configuration, and one about database connection pooling. The raw log is over 200 exchanges\u2014probably 15,000 tokens if loaded verbatim.\n\nToday, I start a new conversation. I type: \"I want to continue working on the auth system. Remind me what we figured out yesterday.\"\n\nThe AI doesn't load the full raw log. Instead, it reads the manifest from yesterday's session and responds:\n\n\"Yesterday's auth debugging session had three segments:\n\n1. **Middleware Order Fix** (lines 1-67): You fixed intermittent 401 errors by reordering middleware so token validation happens before database operations. Artifact: `debugging/auth-middleware-order.md`\n\n2. **Token Expiry Configuration** (lines 68-134): You adjusted token expiry from 24 hours to 1 hour for security, and implemented refresh tokens. Artifact: `debugging/token-expiry-config.md`\n\n3. **Connection Pool Tuning** (lines 135-203): You increased the database connection pool size to 20 and enabled connection keep-alive to reduce latency. Artifact: `debugging/db-pool-tuning.md`\n\nI've loaded all three artifacts for context. What would you like to focus on today?\"\n\nI notice the AI gave me compressed summaries, not the full verbatim exchanges. Each summary is linked to a specific line range if I want details. The artifacts are already in context.\n\nI respond: \"The token expiry change is causing issues. Users are getting logged out too quickly. I want to adjust the refresh flow.\"\n\nThe AI replies: \"Got it. You're building on segment 2 from yesterday. Here's what the artifact says about the current refresh token setup...\" and proceeds to reference the `token-expiry-config.md` artifact.\n\nWe discuss the problem. The refresh token flow requires users to re-authenticate every hour, but mobile users are complaining because the app doesn't handle refresh smoothly in the background. We explore solutions: extend the refresh token lifetime to 7 days, implement silent refresh on the client side, and keep the access token at 1 hour.\n\nAfter working through the details, I say: \"Okay, updated approach: 1-hour access token, 7-day refresh token, client handles silent refresh in background.\"\n\nThe AI confirms: \"That resolves the mobile UX issue while keeping short-lived access tokens for security. Should I create a new artifact for this update?\"\n\nI confirm: \"Yes, but link it to yesterday's token expiry artifact since this builds on that decision.\"\n\nThe AI creates `debugging/token-refresh-flow-update.md` with a `source` field pointing to both yesterday's chat and the previous artifact. The manifest for today's session now has one segment linking to the new artifact.\n\nI check the new artifact and see it references `related_to: debugging/token-expiry-config.md` in the frontmatter. If I ever need to trace the evolution of this decision, the artifact chain is explicit.\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "What I Observed",
      "content": "## What I Observed\n\n**Manifest-Based Context Loading**\n- AI loaded yesterday's manifest instead of 200+ raw exchanges\n- Manifest provided segment summaries with line ranges\n- Token cost: ~500 tokens (manifest) vs ~15,000 tokens (full raw log)\n- Context reconstruction took seconds, not minutes\n\n**Artifacts as Portable Context**\n- Each artifact from yesterday was already self-contained\n- AI loaded artifact files directly without needing the full conversation\n- Artifacts contain enough context to understand the decision without re-reading the chat\n\n**Selective Expansion to Raw Log**\n- If I had asked \"What exactly did I say about connection pooling?\", the AI could expand segment 3 (lines 135-203)\n- Manifest line ranges enable precise jumping into the raw log\n- Full verbatim is available but not required for normal context loading\n\n**Cross-Session Artifact Links**\n- New artifact explicitly linked to the previous artifact via `related_to` field\n- The artifact chain documents evolution: token expiry \u2192 refresh flow update\n- Traceability without requiring full chat history\n\n**Segments Enable Focused Discussion**\n- AI identified I was building on segment 2 (token expiry)\n- Didn't waste tokens loading irrelevant segments (middleware, connection pool)\n- Manifest acts as an index for targeted context retrieval\n\n**No Token Waste on Dead Ends**\n- The raw log includes exploratory threads that didn't lead anywhere\n- Manifest summaries skip the dead ends, capture only the resolutions\n- Token budget spent on conclusions, not raw exploration logs\n\n**Session Continuity Without Session Persistence**\n- Yesterday's session concluded, but today's session seamlessly continues\n- No \"let me reload the context\" delay\n- Manifest + artifacts bridge sessions transparently\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "What I Didn't Have To Do",
      "content": "## What I Didn't Have To Do\n\n- No \"scroll up and read yesterday's conversation\" manual context loading\n- No summarizing yesterday's findings in my own words\n- No searching for \"where did we decide about token expiry?\"\n- No copying/pasting from yesterday's chat into today's chat\n- No maintaining separate context notes between sessions\n- No asking \"can you remind me what we concluded?\" with vague results\n- No paying token cost for the full 15,000-token raw log\n- No managing file paths manually\u2014AI knows where artifacts are\n- No manually linking the new artifact to the old one\u2014frontmatter handles it\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "Technical Details (Implementation View)",
      "content": "## Technical Details (Implementation View)\n\nFor implementers, this scenario demonstrates:\n\n**Yesterday's Manifest (Reference for AI):**\n```yaml\nchat_id: \"debug_auth_20240117\"\nstarted: \"2024-01-17T10:00:00Z\"\nupdated: \"2024-01-17T16:30:00Z\"\nstatus: concluded\n\nsegments:\n  - id: seg_1\n    summary: \"Fixed intermittent 401 errors via middleware reordering\"\n    raw_lines: [1, 67]\n    artifacts: [\"debugging/auth-middleware-order.md\"]\n\n  - id: seg_2\n    summary: \"Adjusted token expiry to 1 hour, implemented refresh tokens\"\n    raw_lines: [68, 134]\n    artifacts: [\"debugging/token-expiry-config.md\"]\n\n  - id: seg_3\n    summary: \"Tuned database connection pool for latency reduction\"\n    raw_lines: [135, 203]\n    artifacts: [\"debugging/db-pool-tuning.md\"]\n```\n\n**Today's Session Context Load:**\n1. User asks for context from yesterday\n2. AI reads `debug_auth_20240117/manifest.yaml`\n3. AI loads all artifacts referenced in segments\n4. AI returns compressed summary (manifest + artifact content)\n5. Total tokens: ~500 (manifest) + ~300 per artifact = ~1400 tokens\n6. Avoids loading raw.jsonl (~15,000 tokens)\n\n**New Artifact with Linkage:**\n```yaml\n---\nstatus: resolved\ncreated: 2024-01-18T09:30:00Z\nupdated: 2024-01-18T09:30:00Z\ntags: [debugging, auth, token-refresh]\nsource: chats/debug_auth_20240118\nrelated_to: debugging/token-expiry-config.md\n---\n\n# Token Refresh Flow Update"
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "Context",
      "content": "## Context\nBuilds on previous token expiry decision (1-hour access tokens, see `token-expiry-config.md`)."
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "Problem",
      "content": "## Problem\nMobile users logged out too frequently. Client doesn't handle refresh smoothly in background."
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "Updated Solution",
      "content": "## Updated Solution\n- Access token: 1 hour (unchanged)\n- Refresh token: 7 days (extended from implicit 1 hour)\n- Client implements silent background refresh before access token expiry"
    },
    {
      "source": "scenarios\\slice-1\\context-reload-scenario.md",
      "heading": "Outcome",
      "content": "## Outcome\nMobile UX improved while maintaining short-lived access token security.\n```\n\n**Today's Manifest (After New Conclusion):**\n```yaml\nchat_id: \"debug_auth_20240118\"\nstarted: \"2024-01-18T09:00:00Z\"\nupdated: \"2024-01-18T09:30:00Z\"\nstatus: active\n\nsegments:\n  - id: seg_1\n    summary: \"Loaded context from yesterday's auth session (3 artifacts)\"\n    raw_lines: [1, 8]\n    artifacts: []\n\n  - id: seg_2\n    summary: \"Resolved mobile logout issue by extending refresh token lifetime to 7 days\"\n    raw_lines: [9, 42]\n    artifacts: [\"debugging/token-refresh-flow-update.md\"]\n```\n\n**Context Budget Calculation:**\n\n| Approach | Token Cost | What's Loaded |\n|----------|------------|---------------|\n| Full Raw Log | ~15,000 | Every exchange verbatim |\n| Manifest + Artifacts | ~1,400 | Segment summaries + resolution documents |\n| Savings | ~13,600 (90%) | Only conclusions, not exploration paths |\n\n**Selective Expansion (If Needed):**\n- User: \"What exactly did I say about connection pooling?\"\n- AI: Reads lines 135-203 from `debug_auth_20240117/raw.jsonl`\n- Returns verbatim exchanges from that segment\n- Total expansion cost: ~2,000 tokens for one segment\n- Still cheaper than loading all 15,000 tokens\n\n**Artifact Chain Traversal:**\n```\ntoken-expiry-config.md\n  \u2193 related_to\ntoken-refresh-flow-update.md\n  \u2193 (future)\ntoken-refresh-mobile-polish.md\n```\n\nAI can traverse `related_to` links to understand decision evolution without loading all raw logs.\n\n**Key Implementation Insight:**\nThe manifest is the index. Artifacts are the conclusions. Raw log is the archive. Normal context loading uses manifest + artifacts. Raw log expansion is on-demand only."
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "The Session",
      "content": "## The Session\n\nI'm brainstorming a new \"guild system\" feature for my game. I start a conversation with the AI.\n\nI type: \"I want to add guilds to the game. Players can create groups and chat together.\"\n\nThe AI asks what guilds should enable beyond chat\u2014shared resources? Territory control? Just social? I respond that I'm thinking social-first, but maybe shared storage later.\n\nWe explore the chat feature. The AI asks about moderation, member limits, and whether guilds persist when all members are offline. I decide: guilds can have up to 25 members, creator is automatically an admin, and guilds persist as long as they have at least one member.\n\nI say: \"Okay, guild chat scope is clear. 25-member limit, creator-admin, basic text chat only.\"\n\nThe AI responds: \"That's a solid foundation. Should I capture this as an artifact?\"\n\nI confirm: \"Yes.\"\n\nThe AI creates an artifact and we continue. I bring up shared storage: \"What about a guild bank? Shared item storage that members can deposit into?\"\n\nWe discuss access control, capacity limits, and audit trails. I decide the bank should be admin-controlled\u2014only admins can withdraw, but any member can deposit. Capacity starts at 50 item slots.\n\nAfter we nail down the details, I say: \"Guild bank is ready too. Admin-controlled withdrawals, 50 slots, deposit-only for regular members.\"\n\nThe AI offers to capture this as a second artifact. I agree.\n\nThen I ask: \"Should guilds have a level system? Like, the guild levels up as members complete quests?\"\n\nWe explore this idea for a while. The more we discuss it, the more complex it feels. Guild XP tracking, level-up bonuses, balancing so bigger guilds don't dominate. After ten minutes, I realize this is too much scope.\n\nI say: \"Actually, let's hold off on leveling. That's a future feature. Just note that we explored it but decided against it for v1.\"\n\nThe AI acknowledges: \"Got it. I'll add a note to the manifest that leveling was considered and deferred, but I won't create an artifact since this wasn't concluded\u2014just postponed.\"\n\nWe wrap up. I check the manifest and see three segments: guild chat (artifact created), guild bank (artifact created), and guild leveling (exploration noted, no artifact).\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "What I Observed",
      "content": "## What I Observed\n\n**Multiple Conclusions in One Session**\n- First conclusion: Guild chat scope finalized \u2192 artifact created\n- Second conclusion: Guild bank design finalized \u2192 artifact created\n- Non-conclusion: Guild leveling explored but deferred \u2192 noted in manifest, no artifact\n\n**Segment Boundaries Track Resolution**\n- Manifest automatically segmented the conversation based on topic shifts\n- Each segment has its own summary and line range in the raw log\n- Segments with conclusions link to artifacts; segments without conclusions just document exploration\n\n**Continuous Capture Throughout**\n- No \"let me save this before moving on\" interruptions\n- Each exchange appended to the raw log immediately\n- Manifest updated continuously, reflecting the current state of discussion\n\n**Deferred Ideas Are Not Lost**\n- Guild leveling exploration is captured in a manifest segment\n- Summary notes: \"Explored guild leveling system, decided too complex for v1, deferred to future\"\n- No artifact created, but the reasoning is preserved in the raw log\n- If I revisit leveling later, the manifest points me to the right conversation segment\n\n**Artifacts Are Self-Contained**\n- `artifacts/brainstorms/guild-chat-v1.md` describes the chat feature scope\n- `artifacts/brainstorms/guild-bank-v1.md` describes the bank feature scope\n- Each artifact has `status: backlog` and can enter the dev pipeline independently\n- Artifacts reference the source chat but don't depend on it\n\n**Manifest as a Map**\n- Reading the manifest gives me a compressed view: \"Segments 1-2 produced artifacts, segment 3 was exploration only\"\n- Line ranges let me jump to specific raw log sections if I need details\n- The manifest serves as an index to the full conversation\n\n**No Unnecessary Artifacts**\n- Only resolved ideas became artifacts\n- Open-ended exploration without conclusions didn't create artifacts\n- The system distinguishes between \"we decided this\" and \"we talked about this\"\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "What I Didn't Have To Do",
      "content": "## What I Didn't Have To Do\n\n- No manual decision about when to \"save\" vs \"keep exploring\"\n- No risk of forgetting the guild chat details while discussing the guild bank\n- No need to organize files\u2014artifacts automatically placed in `artifacts/brainstorms/`\n- No manually tracking which topics were resolved vs deferred\n- No switching between brainstorming mode and documentation mode\n- No post-session cleanup to \"write down what we decided\"\n- No searching through chat history to find where we concluded something\n- No managing separate notes for \"ideas we liked\" vs \"ideas we rejected\"\n- No duplicate artifacts for related features\u2014each conclusion got its own file\n\n---"
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "Technical Details (Implementation View)",
      "content": "## Technical Details (Implementation View)\n\nFor implementers, this scenario demonstrates:\n\n**Manifest with Multiple Segments:**\n```yaml\nchat_id: \"brainstorm_guilds_20240117\"\nstarted: \"2024-01-17T14:00:00Z\"\nupdated: \"2024-01-17T15:15:00Z\"\nstatus: concluded\n\nsegments:\n  - id: seg_1\n    summary: \"Defined guild chat scope: 25 members, creator-admin, text-only chat\"\n    raw_lines: [1, 24]\n    artifacts: [\"brainstorms/guild-chat-v1.md\"]\n\n  - id: seg_2\n    summary: \"Designed guild bank: admin-controlled withdrawals, 50-slot capacity, deposit-only for members\"\n    raw_lines: [25, 52]\n    artifacts: [\"brainstorms/guild-bank-v1.md\"]\n\n  - id: seg_3\n    summary: \"Explored guild leveling system, decided too complex for v1, deferred to future\"\n    raw_lines: [53, 78]\n    artifacts: []\n```\n\n**Artifact Example (Guild Chat):**\n```yaml\n---\nstatus: backlog\ncreated: 2024-01-17T14:30:00Z\nupdated: 2024-01-17T14:30:00Z\ntags: [brainstorm, social, guilds]\nsource: chats/brainstorm_guilds_20240117\n---\n\n# Guild Chat System v1"
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "Summary",
      "content": "## Summary\nPlayers can create guilds with basic text chat for up to 25 members."
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "Scope",
      "content": "## Scope\n- Maximum 25 members per guild\n- Creator is automatically admin\n- Text-only chat (no voice, images, or embeds)\n- Guild persists as long as it has at least one member"
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "Out of Scope (Future)",
      "content": "## Out of Scope (Future)\n- Multiple admins\n- Rich media in chat\n- Guild leveling (see segment 3 of source chat)\n```\n\n**Artifact Example (Guild Bank):**\n```yaml\n---\nstatus: backlog\ncreated: 2024-01-17T14:55:00Z\nupdated: 2024-01-17T14:55:00Z\ntags: [brainstorm, economy, guilds]\nsource: chats/brainstorm_guilds_20240117\n---\n\n# Guild Bank System v1"
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "Summary",
      "content": "## Summary\nShared item storage for guild members with admin-controlled access."
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "Scope",
      "content": "## Scope\n- 50 item slot capacity\n- Any member can deposit items\n- Only admins can withdraw items\n- Basic audit log (who deposited/withdrew what)"
    },
    {
      "source": "scenarios\\slice-1\\feature-brainstorm-session.md",
      "heading": "Access Control",
      "content": "## Access Control\n- Creator is default admin\n- Admins can promote other members to admin\n- Non-admins have deposit-only access\n```\n\n**Conclusion Detection Patterns:**\n- \"Okay, [feature] scope is clear\" \u2192 High confidence conclusion\n- \"That's ready\" / \"Let's ship that\" \u2192 High confidence conclusion\n- \"Let's hold off on [feature]\" \u2192 Deferral, not conclusion (note in segment, no artifact)\n- \"Actually, [change]\" \u2192 Invalidates previous conclusion, updates existing artifact or creates new one\n\n**Segment Boundary Triggers:**\n- Topic shift detected (from chat to bank to leveling)\n- Conclusion reached (artifact created, new segment starts)\n- Explicit user signal (\"Now let's talk about...\")\n- Pause and resume (if conversation is interrupted and continued later)"
    }
  ]
}